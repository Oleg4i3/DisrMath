<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AES-–ø–æ–¥—ñ–±–Ω–∏–π —Å–∏–º—É–ª—è—Ç–æ—Ä —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
            background-color: #f5f5f5;
            color: #333;
        }
        
        h1, h2, h3 {
            color: #2c3e50;
            text-align: center;
        }
        
        h3 {
            text-align: left;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
            margin-top: 5px;
        }
        
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 5px;
            display: flex;
            flex-direction: column;
        }
        
        .matrices-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .matrix-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px;
        }
        
        .matrix {
            display: inline-block;
            border: 2px solid #3498db;
            border-radius: 5px;
            margin: 10px;
            padding: 10px;
            background-color: #ecf0f1;
        }
        
        .matrix-row {
            display: flex;
        }
        
        .matrix-cell {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #3498db;
            margin: 5px;
            font-weight: bold;
            font-size: 18px;
            background-color: white;
            transition: all 0.5s ease;
        }
        
        .highlight {
            background-color: #f39c12 !important;
            transform: scale(1.1);
        }

        .sbox-highlight {
            background-color: #e74c3c !important;
            color: white;
            box-shadow: 0 0 10px #e74c3c;
        }
        
        .key-cell {
            background-color: #e74c3c;
            color: white;
        }
        
        .operation {
            margin: 15px 0;
            padding: 10px;
            border-left: 4px solid #3498db;
            background-color: #ecf0f1;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        button {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        
        .arrow {
            font-size: 24px;
            margin: 0 10px;
            color: #e74c3c;
        }
        
        .explanation {
            background-color: #d5edff;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
        }
        
        .binary {
            font-family: monospace;
            font-size: 14px;
            color: #2c3e50;
        }
        
        .step-indicator {
            text-align: center;
            font-weight: bold;
            margin: 10px 0;
            color: #3498db;
        }
        
        .animation-area {
            min-height: 150px;
            border: 1px dashed #3498db;
            border-radius: 5px;
            padding: 10px;
            margin: 15px 0;
            position: relative;
        }
        
        .key-expansion-steps {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
        }
        
        .expansion-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 5px;
        }
        
        .step-label {
            font-size: 12px;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .mix-columns-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .mix-column {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ–≥–æ –±–ª–æ–∫—É */
        .container ul {
            padding-left: 20px;
        }
        .container li {
            margin-bottom: 10px;
        }
        .container p {
            line-height: 1.6;
            text-align: left;
        }
    </style>
</head>
<body>
    <h3>AES-–ø–æ–¥—ñ–±–Ω–∏–π —Å–∏–º—É–ª—è—Ç–æ—Ä —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</h3>
    
    <div class="container">
        <div class="matrices-container">
            <div class="matrix-wrapper">
                 <h4>–ú–∞—Ç—Ä–∏—Ü—è —Å—Ç–∞–Ω—É - –±–ª–æ–∫ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —â–æ —à–∏—Ñ—Ä—É—î—Ç—å—Å—è</h4>
				<p>	(2x2 –ø–æ 4 –±—ñ—Ç–∏, –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É AES 4—Ö4 –ø–æ –±–∞–π—Ç—É)</p>
                <div class="matrix" id="state-matrix">
                    <div class="matrix-row">
                        <div class="matrix-cell" id="cell-00">0000</div>
                        <div class="matrix-cell" id="cell-01">0000</div>
                    </div>
                    <div class="matrix-row">
                        <div class="matrix-cell" id="cell-10">0000</div>
                        <div class="matrix-cell" id="cell-11">0000</div>
                    </div>
                </div>
            </div>
            
            <div class="matrix-wrapper">
                <h2>–ö–ª—é—á (2x2)</h2>
                <div class="matrix" id="key-matrix">
                    <div class="matrix-row">
                        <div class="matrix-cell key-cell" id="key-00">0000</div>
                        <div class="matrix-cell key-cell" id="key-01">0000</div>
                    </div>
                    <div class="matrix-row">
                        <div class="matrix-cell key-cell" id="key-10">0000</div>
                        <div class="matrix-cell key-cell" id="key-11">0000</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <button id="reset-btn">–ü–æ—á–∞—Ç–∏ –∑–∞–Ω–æ–≤–æ</button>
            <button id="prev-step" disabled>‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫—Ä–æ–∫</button>
            <button id="next-step">–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Üí</button>
        </div>
        
        <div class="step-indicator" id="step-indicator">–ö—Ä–æ–∫ 0: –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω</div>
        
        <div class="animation-area" id="animation-area">
            </div>
        
        <div class="explanation" id="explanation">
            <p>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ —Å–∏–º—É–ª—è—Ç–æ—Ä–∞ AES-–ø–æ–¥—ñ–±–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!</p>
            <p>–ú–∏ –ø—Ä–∞—Ü—é—î–º–æ –∑ –º–∞—Ç—Ä–∏—Ü–µ—é 2x2, –¥–µ –∫–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç - 4-–±—ñ—Ç–Ω–µ —Å–ª–æ–≤–æ (–≤—ñ–¥ 0000 –¥–æ 1111).</p>
            <p>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫", —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ–∫—Ä–æ–∫–æ–≤–æ.</p>
        </div>
    </div>

    <div class="container">
        <h2>–¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ</h2>
        
        <h3>üß© –°–∏–º–µ—Ç—Ä–∏—á–Ω–µ —Ç–∞ –ê—Å–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <p>–£ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—ó —ñ—Å–Ω—É—î –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø—ñ–¥—Ö–æ–¥–∏:</p>
        <ul>
            <li><strong>–°–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (Symmetric):</strong> –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î <strong>–æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ –∫–ª—é—á</strong> –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è. –¶–µ —Ç–æ–π —Ç–∏–ø, —è–∫–∏–π –≤–∏ –±–∞—á–∏—Ç–µ –≤ —Ü—å–æ–º—É —Å–∏–º—É–ª—è—Ç–æ—Ä—ñ (AES - —Ü–µ —Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º). –í–æ–Ω–∏ –Ω–∞–¥–∑–≤–∏—á–∞–π–Ω–æ <strong>—à–≤–∏–¥–∫—ñ</strong>, –∞–ª–µ –º–∞—é—Ç—å –ø—Ä–æ–±–ª–µ–º—É: —è–∫ –±–µ–∑–ø–µ—á–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ —Å–ø—ñ–ª—å–Ω–∏–π –∫–ª—é—á —Å–ø—ñ–≤—Ä–æ–∑–º–æ–≤–Ω–∏–∫—É?</li>
            <li><strong>–ê—Å–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (Asymmetric):</strong> –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î <strong>–ø–∞—Ä—É –∫–ª—é—á—ñ–≤</strong>: <strong>–ø—É–±–ª—ñ—á–Ω–∏–π</strong> (—è–∫–∏–º –º–æ–∂–Ω–∞ –¥—ñ–ª–∏—Ç–∏—Å—è –∑ —É—Å—ñ–º–∞) —Ç–∞ <strong>–ø—Ä–∏–≤–∞—Ç–Ω–∏–π</strong> (—è–∫–∏–π –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ —Ç–∞—î–º–Ω–∏—Ü—ñ). –¢–µ, —â–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø—É–±–ª—ñ—á–Ω–∏–º –∫–ª—é—á–µ–º, –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ª–∏—à–µ –ø—Ä–∏–≤–∞—Ç–Ω–∏–º. –¶–µ –≤–∏—Ä—ñ—à—É—î –ø—Ä–æ–±–ª–µ–º—É –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏, –∞–ª–µ —Ü—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, RSA) <strong>–Ω–∞–±–∞–≥–∞—Ç–æ –ø–æ–≤—ñ–ª—å–Ω—ñ—à—ñ</strong>.</li>
        </ul>
        <p>–í —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–≤—ñ—Ç—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É HTTPS) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å <strong>–≥—ñ–±—Ä–∏–¥–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥</strong>: –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –æ–±–º—ñ–Ω—É —Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–º –∫–ª—é—á–µ–º, –∞ –ø–æ—Ç—ñ–º –≤—Å—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —à–≤–∏–¥–∫–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.</p>

        <h3>ü§ù –ü—Ä–æ–±–ª–µ–º–∞ –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏: –î—ñ—Ñ—Ñ—ñ-–ì–µ–ª–ª–º–∞–Ω (DH)</h3>
        <p>–©–æ–± –¥–≤—ñ —Å—Ç–æ—Ä–æ–Ω–∏, —è–∫—ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑—É—Å—Ç—Ä—ñ—á–∞–ª–∏—Å—è, –º–æ–≥–ª–∏ –¥–æ–º–æ–≤–∏—Ç–∏—Å—è –ø—Ä–æ —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á (–¥–ª—è —Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è) —á–µ—Ä–µ–∑ –Ω–µ–∑–∞—Ö–∏—â–µ–Ω–∏–π –∫–∞–Ω–∞–ª (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è <strong>–ø—Ä–æ—Ç–æ–∫–æ–ª –î—ñ—Ñ—Ñ—ñ-–ì–µ–ª–ª–º–∞–Ω–∞ (DH)</strong>. –¶–µ "–º–∞–≥—ñ—á–Ω–∏–π" –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π —Ç—Ä—é–∫, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –ê–ª—ñ—Å—ñ —Ç–∞ –ë–æ–±—É, –æ–±–º—ñ–Ω—é—é—á–∏—Å—å –ª–∏—à–µ –ø—É–±–ª—ñ—á–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é, –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á, —è–∫–∏–π –Ω–µ–º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏.</p>
        <p><strong>–í–∞–∂–ª–∏–≤–æ:</strong> DH —Å–∞–º –ø–æ —Å–æ–±—ñ –Ω–µ –∑–∞—Ö–∏—â–∞—î –≤—ñ–¥ "–ª—é–¥–∏–Ω–∏ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ" (man-in-the-middle). –î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ <strong>–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è</strong> (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤–∏ –≥–æ–≤–æ—Ä–∏—Ç–µ —Å–∞–º–µ –∑ –ë–æ–±–æ–º, –∞ –Ω–µ –∑ —à–∞—Ö—Ä–∞—î–º), —è–∫–∞ –∑–∞–∑–≤–∏—á–∞–π –∑–∞–±–µ–∑–ø–µ—á—É—î—Ç—å—Å—è —Ü–∏—Ñ—Ä–æ–≤–∏–º–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞–º–∏.</p>

        <h3>üå™Ô∏è –ü—Ä–∏–Ω—Ü–∏–ø–∏ AES: –ü–ª—É—Ç–∞–Ω–∏–Ω–∞ —Ç–∞ –î–∏—Ñ—É–∑—ñ—è</h3>
        <p>AES, —è–∫ —ñ –±–∞–≥–∞—Ç–æ —Å—É—á–∞—Å–Ω–∏—Ö –±–ª–æ–∫–æ–≤–∏—Ö —à–∏—Ñ—Ä—ñ–≤, –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö "–ø–ª—É—Ç–∞–Ω–∏–Ω–∏" —Ç–∞ "–¥–∏—Ñ—É–∑—ñ—ó", —Å—Ñ–æ—Ä–º—É–ª—å–æ–≤–∞–Ω–∏—Ö –ö–ª–æ–¥–æ–º –®–µ–Ω–Ω–æ–Ω–æ–º:</p>
        <ul>
            <li><strong>–ü–ª—É—Ç–∞–Ω–∏–Ω–∞ (Confusion):</strong> –¶–µ —Ä–æ–±–∏—Ç—å –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –∫–ª—é—á–µ–º —Ç–∞ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–º —è–∫–æ–º–æ–≥–∞ —Å–∫–ª–∞–¥–Ω—ñ—à–∏–º. –í AES –∑–∞ —Ü–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –µ—Ç–∞–ø <strong>SubBytes (S-–±–ª–æ–∫)</strong>. –¶–µ —î–¥–∏–Ω–∞ <strong>–Ω–µ–ª—ñ–Ω—ñ–π–Ω–∞</strong> –æ–ø–µ—Ä–∞—Ü—ñ—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ, —è–∫–∞ —É–Ω–µ–º–æ–∂–ª–∏–≤–ª—é—î –ø—Ä–æ—Å—Ç—ñ –∞–ª–≥–µ–±—Ä–∞—ó—á–Ω—ñ –∞—Ç–∞–∫–∏.</li>
            <li><strong>–î–∏—Ñ—É–∑—ñ—è (Diffusion):</strong> –¶–µ —Ä–æ–±–∏—Ç—å –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º —Ç–µ–∫—Å—Ç–æ–º —Ç–∞ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–º —Å–∫–ª–∞–¥–Ω–∏–º. –í–æ–Ω–∞ "—Ä–æ–∑—Å—ñ—é—î" –≤–ø–ª–∏–≤ –æ–¥–Ω–æ–≥–æ –±—ñ—Ç–∞ –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç—É –Ω–∞ –±–∞–≥–∞—Ç–æ –±—ñ—Ç—ñ–≤ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç—É. –í AES –∑–∞ —Ü–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –µ—Ç–∞–ø–∏ <strong>ShiftRows</strong> —Ç–∞ <strong>MixColumns</strong>.</li>
        </ul>
        <p>–ü–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è —Ü–∏—Ö –µ—Ç–∞–ø—ñ–≤ —É –±–∞–≥–∞—Ç—å–æ—Ö —Ä–∞—É–Ω–¥–∞—Ö (10-14 –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É AES) —Å—Ç–≤–æ—Ä—é—î "–ª–∞–≤–∏–Ω–Ω–∏–π –µ—Ñ–µ–∫—Ç", –¥–µ –∑–º—ñ–Ω–∞ –æ–¥–Ω–æ–≥–æ –±—ñ—Ç–∞ –Ω–∞ –≤—Ö–æ–¥—ñ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–æ–≤–Ω–æ—ó –∑–º—ñ–Ω–∏ ~50% –±—ñ—Ç—ñ–≤ –Ω–∞ –≤–∏—Ö–æ–¥—ñ.</p>

        <h3>‚ùì –Ø–∫ —Ñ–æ—Ä–º—É—é—Ç—å—Å—è S-–±–ª–æ–∫–∏?</h3>
        <p>–¢–∞–±–ª–∏—Ü—è S-–±–ª–æ–∫—É (SubBytes) ‚Äî —Ü–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –Ω–∞–±—ñ—Ä —á–∏—Å–µ–ª. –í–æ–Ω–∞ –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∑–∞ —Å—É–≤–æ—Ä–∏–º –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —É –ü–æ–ª—ñ –ì–∞–ª—É–∞ GF(2^8). –°–ø–æ—á–∞—Ç–∫—É –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –±–∞–π—Ç–∞ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –π–æ–≥–æ <strong>–º—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω–∏–π –æ–±–µ—Ä–Ω–µ–Ω–∏–π</strong> (—Ü–µ —Å–∫–ª–∞–¥–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è), –∞ –ø–æ—Ç—ñ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–ø—É—Å–∫–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ <strong>–∞—Ñ—ñ–Ω–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è</strong> (XOR –∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏). –¶–µ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ S-–±–ª–æ–∫ –º–∞—î —á—É–¥–æ–≤—ñ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —Ç–∞ —Å—Ç—ñ–π–∫—ñ—Å—Ç—å –¥–æ –ª—ñ–Ω—ñ–π–Ω–æ–≥–æ —Ç–∞ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–∞–ª—å–Ω–æ–≥–æ –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª—ñ–∑—É.</p>

        <h3>üåä –°—É—á–∞—Å–Ω—ñ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏: –ü–æ—Ç–æ–∫–æ–≤—ñ –®–∏—Ñ—Ä–∏</h3>
        <p>AES ‚Äî —Ü–µ <strong>–±–ª–æ–∫–æ–≤–∏–π —à–∏—Ñ—Ä</strong> (–≤—ñ–Ω —à–∏—Ñ—Ä—É—î –¥–∞–Ω—ñ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–º–∏ –±–ª–æ–∫–∞–º–∏ –ø–æ 128 –±—ñ—Ç). –Ü—Å–Ω—É—é—Ç—å —Ç–∞–∫–æ–∂ <strong>–ø–æ—Ç–æ–∫–æ–≤—ñ —à–∏—Ñ—Ä–∏</strong>, —è–∫—ñ –≥–µ–Ω–µ—Ä—É—é—Ç—å –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∏–π "–ø–æ—Ç—ñ–∫" –ø—Å–µ–≤–¥–æ–≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –±–∞–π—Ç—ñ–≤ (–Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–ª—é—á–∞) —ñ –ø—Ä–æ—Å—Ç–æ XOR-—è—Ç—å –π–æ–≥–æ –∑ –≤–∞—à–∏–º–∏ –¥–∞–Ω–∏–º–∏. –¶–µ —á–∞—Å—Ç–æ —à–≤–∏–¥—à–µ, –æ—Å–æ–±–ª–∏–≤–æ –≤ –ø—Ä–æ–≥—Ä–∞–º–Ω—ñ–π —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó.</p>
        <p>–ù–∞–π–≤—ñ–¥–æ–º—ñ—à—ñ —Å—É—á–∞—Å–Ω—ñ –ø–æ—Ç–æ–∫–æ–≤—ñ —à–∏—Ñ—Ä–∏ ‚Äî —Ü–µ <strong>Salsa20</strong> —Ç–∞ –π–æ–≥–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–∫ <strong>ChaCha20</strong> (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ TLS 1.3, WireGuard VPN, Google). –í–æ–Ω–∏ –≤–≤–∞–∂–∞—é—Ç—å—Å—è –¥—É–∂–µ –±–µ–∑–ø–µ—á–Ω–∏–º–∏ —Ç–∞ —à–≤–∏–¥–∫–∏–º–∏.</p>

        <h3>üåê –î–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è AES?</h3>
        <p>–°–∫—Ä—ñ–∑—å! AES ‚Äî —Ü–µ —Å–≤—ñ—Ç–æ–≤–∏–π "–∑–æ–ª–æ—Ç–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç" —Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è. –í–∏ —Å—Ç–∏–∫–∞—î—Ç–µ—Å—è –∑ –Ω–∏–º —â–æ–¥–Ω—è:</p>
        <ul>
            <li><strong>Wi-Fi:</strong> –í–∞—à WPA2/WPA3 –ø–∞—Ä–æ–ª—å –∑–∞—Ö–∏—â–∞—î —Ç—Ä–∞—Ñ—ñ–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é AES.</li>
            <li><strong>–í–µ–±—Å–∞–π—Ç–∏ (HTTPS):</strong> –ö–æ–ª–∏ –≤–∏ –±–∞—á–∏—Ç–µ "–∑–∞–º–æ—á–æ–∫" –≤ –±—Ä–∞—É–∑–µ—Ä—ñ (TLS/SSL), –¥–∞–Ω—ñ —Å–µ—Å—ñ—ó, —Å–∫–æ—Ä—ñ—à –∑–∞ –≤—Å–µ, —à–∏—Ñ—Ä—É—é—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é AES.</li>
            <li><strong>VPN:</strong> –ü—Ä–æ—Ç–æ–∫–æ–ª–∏ —è–∫ OpenVPN –∞–±–æ WireGuard (–∑ ChaCha20) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å AES –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –≤–∞—à–æ–≥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ç—Ä–∞—Ñ—ñ–∫—É.</li>
            <li><strong>–§–∞–π–ª–∏ —Ç–∞ –î–∏—Å–∫–∏:</strong> –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–∏—Å–∫–∞ (BitLocker, FileVault) —Ç–∞ –∞—Ä—Ö—ñ–≤–∏ (7-Zip, WinRAR) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å AES.</li>
            <li><strong>–ú–µ—Å–µ–Ω–¥–∂–µ—Ä–∏:</strong> –ë–∞–≥–∞—Ç–æ –¥–æ–¥–∞—Ç–∫—ñ–≤ –∑ end-to-end —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å AES —è–∫ —á–∞—Å—Ç–∏–Ω—É —Å–≤–æ–≥–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É.</li>
        </ul>
    </div>
    <script>
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –¥–ª—è —Å–∏–º—É–ª—è—Ç–æ—Ä–∞
        const STEPS = [
            "–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω",
            "–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞ - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 1",
            "–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞ - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 2",
            "–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ (AddRoundKey) - –†–∞—É–Ω–¥ 0",
            "–ó–∞–º—ñ–Ω–∞ –±–∞–π—Ç—ñ–≤ (SubBytes) - –†–∞—É–Ω–¥ 1",
            "–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—è–¥–∫—ñ–≤ (ShiftRows) - –†–∞—É–Ω–¥ 1",
            "–ó–º—ñ—à—É–≤–∞–Ω–Ω—è —Å—Ç–æ–≤–ø—Ü—ñ–≤ (MixColumns) - –†–∞—É–Ω–¥ 1",
            "–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 1 (AddRoundKey) - –†–∞—É–Ω–¥ 1",
            "–ó–∞–º—ñ–Ω–∞ –±–∞–π—Ç—ñ–≤ (SubBytes) - –†–∞—É–Ω–¥ 2 (–§—ñ–Ω–∞–ª—å–Ω–∏–π)",
            "–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—è–¥–∫—ñ–≤ (ShiftRows) - –†–∞—É–Ω–¥ 2",
            "–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 2 (AddRoundKey) - –§—ñ–Ω–∞–ª—å–Ω–∏–π",
            "–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
        ];

        // S-–±–ª–æ–∫ –¥–ª—è –∑–∞–º—ñ–Ω–∏ –±–∞–π—Ç—ñ–≤
        const sBox = {
            "0000": "1111", "0001": "0100", "0010": "1101", "0011": "0001",
            "0100": "0010", "0101": "1111", "0110": "1011", "0111": "1000",
            "1000": "0010", "1001": "1010", "1010": "0110", "1011": "1100",
            "1100": "0101", "1101": "1001", "1110": "0000", "1111": "0111"
        };

        // --- –ì–õ–û–ë–ê–õ–¨–ù–ò–ô –°–¢–ê–ù ---
        let currentStep = 0;
        let stateMatrix = [["", ""], ["", ""]];
        let originalKey = [["", ""], ["", ""]];
        let keyMatrix = [["", ""], ["", ""]];
        let roundKeys = [
            [["", ""], ["", ""]], // –ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∫–ª—é—á (–†–∞—É–Ω–¥ 0)
            [["", ""], ["", ""]], // –†–æ–∑—à–∏—Ä–µ–Ω–∏–π –∫–ª—é—á 1 (–†–∞—É–Ω–¥ 1)
            [["", ""], ["", ""]]  // –†–æ–∑—à–∏—Ä–µ–Ω–∏–π –∫–ª—é—á 2 (–†–∞—É–Ω–¥ 2)
        ];
        // –ù–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ –¥–ª—è —ñ—Å—Ç–æ—Ä—ñ—ó —Å—Ç–∞–Ω—ñ–≤
        let history = []; 
        // ------------------------

        // –ï–ª–µ–º–µ–Ω—Ç–∏ DOM
        const stateCells = {
            "00": document.getElementById("cell-00"),
            "01": document.getElementById("cell-01"),
            "10": document.getElementById("cell-10"),
            "11": document.getElementById("cell-11")
        };
        
        const keyCells = {
            "00": document.getElementById("key-00"),
            "01": document.getElementById("key-01"),
            "10": document.getElementById("key-10"),
            "11": document.getElementById("key-11")
        };
        
        const stepIndicator = document.getElementById("step-indicator");
        const explanation = document.getElementById("explanation");
        const animationArea = document.getElementById("animation-area");
        const prevStepBtn = document.getElementById("prev-step");
        const nextStepBtn = document.getElementById("next-step");
        const resetBtn = document.getElementById("reset-btn");

        // --- –§–£–ù–ö–¶–Ü–á –î–õ–Ø –£–ü–†–ê–í–õ–Ü–ù–ù–Ø –Ü–°–¢–û–†–Ü–Ñ–Æ ---

        function saveState() {
            // –ì–ª–∏–±–æ–∫–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö
            const stateCopy = stateMatrix.map(row => row.slice());
            const keyCopy = keyMatrix.map(row => row.slice());
            const roundKeysCopy = roundKeys.map(keyRound => keyRound.map(row => row.slice()));

            history.push({
                step: currentStep,
                state: stateCopy,
                key: keyCopy,
                roundKeys: roundKeysCopy
            });
        }

        function restoreState(prevState) {
            currentStep = prevState.step;
            stateMatrix = prevState.state;
            keyMatrix = prevState.key;
            roundKeys = prevState.roundKeys;
            // updateStep –≤–∏–∫–ª–∏—á–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è DOM
            updateStep(); 
        }

        // --- –ó–ê–ì–ê–õ–¨–ù–Ü –î–û–ü–û–ú–Ü–ñ–ù–Ü –§–£–ù–ö–¶–Ü–á ---

        function generateRandom4Bit() {
            return Math.floor(Math.random() * 16).toString(2).padStart(4, '0');
        }

        function generateRandomMatrix() {
            return [
                [generateRandom4Bit(), generateRandom4Bit()],
                [generateRandom4Bit(), generateRandom4Bit()]
            ];
        }

        function updateMatrixDisplay() {
            for (let i = 0; i < 2; i++) {
                for (let j = 0; j < 2; j++) {
                    const key = `${i}${j}`;
                    stateCells[key].textContent = stateMatrix[i][j];
                    keyCells[key].textContent = keyMatrix[i][j];
                    stateCells[key].classList.remove('sbox-highlight');
                    stateCells[key].style.backgroundColor = 'white'; // –°–∫–∏–¥–∞—î–º–æ —Ç–∏–º—á–∞—Å–æ–≤–µ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è
                }
            }
        }

        function addBits(a, b) {
            let result = "";
            for (let i = 0; i < 4; i++) {
                result += (parseInt(a[i]) ^ parseInt(b[i])).toString();
            }
            return result;
        }

        function subBytes(value) {
            return sBox[value];
        }

        function shiftRows() {
            const temp = stateMatrix[1][0];
            stateMatrix[1][0] = stateMatrix[1][1];
            stateMatrix[1][1] = temp;
        }

        function RotL(bits, n) {
            const val = parseInt(bits, 2);
            const n_mod = n % 4;
            const shifted = (val << n_mod) | (val >> (4 - n_mod));
            const result = shifted & 0b1111;
            return result.toString(2).padStart(4, '0');
        }

        function mixColumns() {
            const newState = [[], []];
            
            for (let col = 0; col < 2; col++) {
                const s0 = stateMatrix[0][col];
                const s1 = stateMatrix[1][col];
                
                // s0' = s0 ‚äï RotL(s1, 1)
                const s0_prime = addBits(s0, RotL(s1, 1));
                
                // s1' = s1 ‚äï RotL(s0', 2)
                const s1_prime = addBits(s1, RotL(s0_prime, 2));
                
                newState[0][col] = s0_prime;
                newState[1][col] = s1_prime;
            }
            
            stateMatrix = newState;
        }

        function expandKey(round) {
            const rcon = round === 1 ? "0001" : "0010";
            const prevKey = roundKeys[round - 1];

            const lastRow = [prevKey[1][0], prevKey[1][1]];
            const subLastRow = [subBytes(lastRow[0]), subBytes(lastRow[1])];
            const afterRcon = [addBits(subLastRow[0], rcon), subLastRow[1]];
            
            const firstRow = [
                addBits(prevKey[0][0], afterRcon[0]),
                addBits(prevKey[0][1], afterRcon[1])
            ];
            
            const secondRow = [
                addBits(prevKey[1][0], firstRow[0]),
                addBits(prevKey[1][1], firstRow[1])
            ];
            
            return [firstRow, secondRow];
        }

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // --- –ê–ù–Ü–ú–ê–¶–Ü–ô–ù–Ü –§–£–ù–ö–¶–Ü–á ---

        // –ê–Ω—ñ–º–∞—Ü—ñ—è S-Box: –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —Ç–∞–±–ª–∏—Ü—é S-–±–ª–æ–∫—É —Ç–∞ –ø—ñ–¥—Å–≤—ñ—á—É—î –≤—Ö—ñ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
        function animateSBoxTable(matrixName, matrix) {
            animationArea.innerHTML = "";
            
            const container = document.createElement("div");
            container.style.textAlign = "center";
            
            const title = document.createElement("div");
            title.textContent = `–ó–∞–º—ñ–Ω–∞ –±–∞–π—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é S-–±–ª–æ–∫—É –¥–ª—è ${matrixName}:`;
            title.style.marginBottom = "15px";
            title.style.fontWeight = "bold";
            
            container.appendChild(title);
            
            const sBoxTable = document.createElement("div");
            sBoxTable.style.display = "grid";
            sBoxTable.style.gridTemplateColumns = "repeat(4, 1fr)";
            sBoxTable.style.gap = "5px";
            sBoxTable.style.margin = "0 auto";
            sBoxTable.style.maxWidth = "300px";
            
            const inputValues = Object.values(matrix).flat();

            for (let i = 0; i < 16; i++) {
                const key = i.toString(2).padStart(4, '0');
                const value = sBox[key];
                
                const cell = document.createElement("div");
                cell.className = "matrix-cell";
                cell.style.fontSize = "12px";
                cell.style.padding = "5px";
                cell.style.width = "unset";
                cell.style.height = "unset";
                cell.textContent = `${key}‚Üí${value}`;
                
                // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –≤—Å—ñ S-–±–ª–æ–∫–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è
                if (inputValues.includes(key)) {
                    cell.classList.add('highlight');
                }
                
                sBoxTable.appendChild(cell);
            }
            
            container.appendChild(sBoxTable);
            animationArea.appendChild(container);
        }

        // –ù–û–í–ê –ê–Ω—ñ–º–∞—Ü—ñ—è SubBytes: –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–∞ –∑–∞–º—ñ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω—ñ–π –º–∞—Ç—Ä–∏—Ü—ñ
        async function animateSubBytesSubstitution(oldState, newState) {
            nextStepBtn.disabled = true;
            prevStepBtn.disabled = true;

            const order = [[0, 0], [0, 1], [1, 0], [1, 1]]; // –ü–æ—Ä—è–¥–æ–∫ –∑–∞–º—ñ–Ω–∏
            const cellElements = [stateCells["00"], stateCells["01"], stateCells["10"], stateCells["11"]];
            
            for (let k = 0; k < 4; k++) {
                const i = order[k][0];
                const j = order[k][1];
                const cell = cellElements[k];
                
                const inputVal = oldState[i][j];
                const outputVal = newState[i][j];
                
                // *** –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø –ë–ê–ì–£: –ü–æ—à—É–∫ S-Box –µ–ª–µ–º–µ–Ω—Ç–∞ –±–µ–∑ :contains() ***
                const sBoxCells = document.querySelectorAll('#animation-area .matrix-cell.highlight');
                let sBoxCell = null;
                sBoxCells.forEach(boxCell => {
                    // –®—É–∫–∞—î–º–æ –∫–æ–º—ñ—Ä–∫—É S-–±–ª–æ–∫—É, —Ç–µ–∫—Å—Ç —è–∫–æ—ó –º—ñ—Å—Ç–∏—Ç—å –≤—Ö—ñ–¥–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
                    if (boxCell.textContent.includes(`${inputVal}‚Üí`)) {
                        sBoxCell = boxCell;
                    }
                });
                // *************************************************************

                // 1. –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –≤—Ö—ñ–¥–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –º–∞—Ç—Ä–∏—Ü—ñ
                cell.classList.add('sbox-highlight');
                cell.style.backgroundColor = '#e74c3c';
                
                // 2. –î–æ–¥–∞—Ç–∫–æ–≤–æ –ø—ñ–¥—Å–≤—ñ—á—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –ø–∞—Ä—É –≤ S-–±–ª–æ—Ü—ñ
                if (sBoxCell) sBoxCell.classList.add('sbox-highlight'); 

                await delay(500);

                // 3. –î–µ–º–æ–Ω—Å—Ç—Ä—É—î–º–æ –∑–∞–º—ñ–Ω—É
                cell.textContent = `${inputVal} ‚Üí ${outputVal}`;

                await delay(1000);

                // 4. –§—ñ–∫—Å—É—î–º–æ –Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –∑–Ω—ñ–º–∞—î–º–æ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è
                cell.textContent = outputVal;
                cell.classList.remove('sbox-highlight');

                if (sBoxCell) sBoxCell.classList.remove('sbox-highlight');
                
                // 5. –í–∏–º–∏–∫–∞—î–º–æ –∑–∞–≥–∞–ª—å–Ω–µ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è highlight, —è–∫–µ –±—É–ª–æ —É–≤—ñ–º–∫–Ω–µ–Ω–µ –≤ animateSBoxTable
                if (sBoxCell) sBoxCell.classList.remove('highlight');


                await delay(500);

                // 6. –û—á–∏—â–∞—î–º–æ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –∫–æ–º—ñ—Ä–∫–∏, –∑–∞–ª–∏—à–∞—é—á–∏ –ª–∏—à–µ —Ñ–æ–Ω 'white'
                cell.style.backgroundColor = 'white';
            }

            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –º–∏ –Ω–µ –Ω–∞ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É –∫—Ä–æ—Ü—ñ, —ñ –≤—ñ–¥–Ω–æ–≤–ª—é—î–º–æ –∫–Ω–æ–ø–∫–∏
            if (currentStep < STEPS.length - 1) nextStepBtn.disabled = false;
            if (history.length > 0) prevStepBtn.disabled = false;
        }

        // --- –û–°–ù–û–í–ù–ê –õ–û–ì–Ü–ö–ê –ö–†–û–ö–Ü–í ---

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫—Ä–æ–∫—É
        async function nextStep() {
            if (currentStep >= STEPS.length - 1 || nextStepBtn.disabled) return;
            
            // 1. –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω –î–û –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó
            saveState(); 
            
            currentStep++;

            // 2. –í–∏–∫–æ–Ω—É—î–º–æ –æ–ø–µ—Ä–∞—Ü—ñ—é –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫—Ä–æ–∫—É
            await updateStep();
        }

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫—Ä–æ–∫—É
        function prevStep() {
            if (currentStep <= 0 || history.length <= 1) return; // history.length –º–∞—î –±—É—Ç–∏ > 1, —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞–∑–∞–¥ –∑ –∫—Ä–æ–∫ 1 –Ω–∞ –∫—Ä–æ–∫ 0
            
            // 1. –í–∏–¥–∞–ª—è—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω (—è–∫–∏–π –º–∏ —Ö–æ—á–µ–º–æ –ø–æ–∫–∏–Ω—É—Ç–∏)
            history.pop();
            
            // 2. –í–∏—Ç—è–≥—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Å—Ç–∞–Ω –∑ —ñ—Å—Ç–æ—Ä—ñ—ó
            const prevState = history[history.length - 1];
            
            // 3. –í—ñ–¥–Ω–æ–≤–ª—é—î–º–æ –≤—Å—ñ –≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
            restoreState(prevState); 
        }

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫—Ä–æ–∫—É
        async function updateStep() {
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—Ä–æ–∫—É —Ç–∞ –∫–Ω–æ–ø–∫–∏
            stepIndicator.textContent = `–ö—Ä–æ–∫ ${currentStep}: ${STEPS[currentStep]}`;
            prevStepBtn.disabled = history.length <= 1;
            nextStepBtn.disabled = currentStep === STEPS.length - 1;
            animationArea.innerHTML = "";
            
            // –¢–∏–º—á–∞—Å–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å—Ç–∞–Ω—É
            let newStateMatrix = stateMatrix.map(row => row.slice());

            // –í–∏–∫–æ–Ω—É—î–º–æ –¥—ñ—ó –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫—Ä–æ–∫—É
            switch (currentStep) {
                case 0: // –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω
                    explanation.innerHTML = `
                        <p><strong>–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω –º–∞—Ç—Ä–∏—Ü—ñ –¥–∞–Ω–∏—Ö —Ç–∞ –∫–ª—é—á–∞.</strong></p>
                        <p>–ö–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç –º–∞—Ç—Ä–∏—Ü—ñ - —Ü–µ 4-–±—ñ—Ç–Ω–µ —Å–ª–æ–≤–æ (–≤—ñ–¥ 0000 –¥–æ 1111).</p>
                        <p>–ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∫–ª—é—á –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤ –¥–ª—è –≤—Å—ñ—Ö —Ä–∞—É–Ω–¥—ñ–≤ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.</p>
                        <p>–ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –±—É–¥–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á–∞ –ø–µ—Ä—à–æ–≥–æ —Ä–∞—É–Ω–¥—É.</p>
                    `;
                    break;
                    
                case 1: // –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞ - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 1
                    roundKeys[1] = expandKey(1);
                    keyMatrix = roundKeys[1];
                    explanation.innerHTML = `
                        <p><strong>–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á–∞ –ø–µ—Ä—à–æ–≥–æ —Ä–∞—É–Ω–¥—É.</strong></p>
                        <p>–ü—Ä–æ—Ü–µ—Å –≤–∫–ª—é—á–∞—î –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è <strong>S-–±–ª–æ–∫—É (–Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å)</strong>, –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç —Ä–∞—É–Ω–¥—É (–∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é XOR) —Ç–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó XOR.</p>
                    `;
                    animateKeyExpansion(1);
                    break;
                    
                case 2: // –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞ - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 2
                    roundKeys[2] = expandKey(2);
                    keyMatrix = roundKeys[0]; // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∫–ª—é—á –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
                    explanation.innerHTML = `
                        <p><strong>–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á–∞ –¥—Ä—É–≥–æ–≥–æ —Ä–∞—É–Ω–¥—É.</strong></p>
                        <p>–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Ä–∞—É–Ω–¥—É –¥–ª—è –¥—Ä—É–≥–æ–≥–æ —Ä–∞—É–Ω–¥—É –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è (${"0010"} –∑–∞–º—ñ—Å—Ç—å ${"0001"}).</p>
                    `;
                    animateKeyExpansion(2);
                    break;
                    
                case 3: // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ (AddRoundKey)
                    keyMatrix = roundKeys[0];
                    for (let i = 0; i < 2; i++) {
                        for (let j = 0; j < 2; j++) {
                            stateMatrix[i][j] = addBits(stateMatrix[i][j], keyMatrix[i][j]);
                        }
                    }
                    explanation.innerHTML = `
                        <p><strong>–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ (AddRoundKey).</strong> –í–∏–∫–æ–Ω—É—î–º–æ –æ–ø–µ—Ä–∞—Ü—ñ—é XOR –º—ñ–∂ –º–∞—Ç—Ä–∏—Ü–µ—é —Å—Ç–∞–Ω—É —Ç–∞ –∫–ª—é—á–µ–º —Ä–∞—É–Ω–¥—É.</p>
                    `;
                    // –ê–Ω—ñ–º—É—î–º–æ XOR –¥–ª—è –ø–µ—Ä—à–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞
                    animateXOR(stateMatrix[0][0], keyMatrix[0][0], stateMatrix[0][0], "–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞: –∫–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç —Å—Ç–∞–Ω—É XOR –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º –µ–ª–µ–º–µ–Ω—Ç–æ–º –∫–ª—é—á–∞");
                    break;
                    
                case 4: // –ó–∞–º—ñ–Ω–∞ –±–∞–π—Ç—ñ–≤ (SubBytes) - –†–∞—É–Ω–¥ 1
                    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Å—Ç–∞—Ä–∏–π —Å—Ç–∞–Ω –î–û –∑–∞–º—ñ–Ω–∏ –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó –∞–Ω—ñ–º–∞—Ü—ñ—ó
                    const oldStateCase4 = stateMatrix.map(row => row.slice());
                    
                    // –û–±—á–∏—Å–ª—é—î–º–æ –Ω–æ–≤–∏–π —Å—Ç–∞–Ω (–Ω–µ –∫–æ–º—ñ—Ç—É—î–º–æ –≤ stateMatrix –ø–æ–∫–∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –∞–Ω—ñ–º–∞—Ü—ñ—è)
                    for (let i = 0; i < 2; i++) {
                        for (let j = 0; j < 2; j++) {
                            newStateMatrix[i][j] = subBytes(oldStateCase4[i][j]);
                        }
                    }
                    
                    animateSBoxTable("–º–∞—Ç—Ä–∏—Ü—ñ —Å—Ç–∞–Ω—É", oldStateCase4);
                    
                    // –¢—É—Ç –∫–æ–º—ñ—Ç—É—î–º–æ –∑–º—ñ–Ω—É –≤ –≥–ª–æ–±–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω
                    stateMatrix = newStateMatrix;
                    
                    // –ó–∞–ø—É—Å–∫–∞—î–º–æ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—É –∞–Ω—ñ–º–∞—Ü—ñ—é –≤ –æ—Å–Ω–æ–≤–Ω—ñ–π –º–∞—Ç—Ä–∏—Ü—ñ
                    await animateSubBytesSubstitution(oldStateCase4, newStateMatrix);
                    
                    explanation.innerHTML = `
                        <p><strong>–ó–∞–º—ñ–Ω–∞ –±–∞–π—Ç—ñ–≤ (SubBytes) - –ü—Ä–∏–Ω—Ü–∏–ø "–ü–ª—É—Ç–∞–Ω–∏–Ω–∏".</strong></p>
                        <p>–¶–µ –Ω–µ–ª—ñ–Ω—ñ–π–Ω–∞ –∑–∞–º—ñ–Ω–∞ –∫–æ–∂–Ω–æ–≥–æ –±–∞–π—Ç–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é S-–±–ª–æ–∫—É, —â–æ –¥–æ–¥–∞—î <strong>–ø–ª—É—Ç–∞–Ω–∏–Ω—É</strong>.</p>
                    `;
                    break;
                    
                case 5: // –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—è–¥–∫—ñ–≤ (ShiftRows)
                    explanation.innerHTML = `
                        <p><strong>–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—è–¥–∫—ñ–≤ (ShiftRows) - –ü—Ä–∏–Ω—Ü–∏–ø "–î–∏—Ñ—É–∑—ñ—ó".</strong></p>
                        <p>–î—Ä—É–≥–∏–π —Ä—è–¥–æ–∫ —Ü–∏–∫–ª—ñ—á–Ω–æ –∑—Å—É–≤–∞—î—Ç—å—Å—è –Ω–∞ –æ–¥–Ω—É –ø–æ–∑–∏—Ü—ñ—é –≤–ª—ñ–≤–æ. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î <strong>—Ä–æ–∑—Å—ñ—è—Ç–∏</strong> –≤–ø–ª–∏–≤ –±–∞–π—Ç—ñ–≤ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ.</p>
                    `;
                    animateShiftRows();
                    shiftRows();
                    break;
                    
                case 6: // –ó–º—ñ—à—É–≤–∞–Ω–Ω—è —Å—Ç–æ–≤–ø—Ü—ñ–≤ (MixColumns)
                    // –í–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –≤–∂–µ –æ–Ω–æ–≤–ª—é—î stateMatrix
                    explanation.innerHTML = `
                        <p><strong>–ó–º—ñ—à—É–≤–∞–Ω–Ω—è —Å—Ç–æ–≤–ø—Ü—ñ–≤ (MixColumns) - –ü—Ä–∏–Ω—Ü–∏–ø "–î–∏—Ñ—É–∑—ñ—ó".</strong></p>
                        <p>–¶–µ <strong>—Å—É—Ä–æ–≥–∞—Ç–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è (RotL + XOR)</strong>, —è–∫–∞ —î –æ–±–æ—Ä–æ—Ç–Ω–æ—é —ñ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø—Ä–∏–Ω—Ü–∏–ø –¥–∏—Ñ—É–∑—ñ—ó.</p>
                        <p><strong>–í —Ä–µ–∞–ª—å–Ω–æ–º—É AES</strong> —Ç—É—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ –º–∞—Ç—Ä–∏—Ü—é –≤ <strong>–ü–æ–ª—ñ –ì–∞–ª—É–∞</strong>.</p>
                    `;
                    
                    animateMixColumns();
                    mixColumns();
                    break;
                    
                case 7: // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 1 (AddRoundKey)
                    keyMatrix = roundKeys[1];
                    for (let i = 0; i < 2; i++) {
                        for (let j = 0; j < 2; j++) {
                            stateMatrix[i][j] = addBits(stateMatrix[i][j], keyMatrix[i][j]);
                        }
                    }
                    explanation.innerHTML = `
                        <p><strong>–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 1 (AddRoundKey).</strong> –í–∏–∫–æ–Ω—É—î–º–æ XOR –º—ñ–∂ –º–∞—Ç—Ä–∏—Ü–µ—é —Å—Ç–∞–Ω—É —Ç–∞ –∫–ª—é—á–µ–º –ø–µ—Ä—à–æ–≥–æ —Ä–∞—É–Ω–¥—É.</p>
                    `;
                    // –ê–Ω—ñ–º—É—î–º–æ XOR –¥–ª—è –ø–µ—Ä—à–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞
                    animateXOR(stateMatrix[0][0], keyMatrix[0][0], stateMatrix[0][0], "–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 1: XOR —Å—Ç–∞–Ω—É –∑ –∫–ª—é—á–µ–º —Ä–∞—É–Ω–¥—É");
                    break;
                    
                case 8: // –ó–∞–º—ñ–Ω–∞ –±–∞–π—Ç—ñ–≤ (SubBytes) - –†–∞—É–Ω–¥ 2
                    const oldStateCase8 = stateMatrix.map(row => row.slice());
                    
                    for (let i = 0; i < 2; i++) {
                        for (let j = 0; j < 2; j++) {
                            newStateMatrix[i][j] = subBytes(oldStateCase8[i][j]);
                        }
                    }

                    animateSBoxTable("–º–∞—Ç—Ä–∏—Ü—ñ —Å—Ç–∞–Ω—É", oldStateCase8);

                    stateMatrix = newStateMatrix;

                    await animateSubBytesSubstitution(oldStateCase8, newStateMatrix);
                    
                    explanation.innerHTML = `
                        <p><strong>–ó–∞–º—ñ–Ω–∞ –±–∞–π—Ç—ñ–≤ (SubBytes) - –¥—Ä—É–≥–∏–π —Ä–∞—É–Ω–¥.</strong></p>
                        <p>–ü–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ–Ω—É—î–º–æ –Ω–µ–ª—ñ–Ω—ñ–π–Ω—É –∑–∞–º—ñ–Ω—É –∫–æ–∂–Ω–æ–≥–æ –±–∞–π—Ç–∞.</p>
                    `;
                    break;
                    
                case 9: // –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—è–¥–∫—ñ–≤ (ShiftRows) - –¥—Ä—É–≥–∏–π —Ä–∞—É–Ω–¥
                    explanation.innerHTML = `
                        <p><strong>–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—è–¥–∫—ñ–≤ (ShiftRows) - –¥—Ä—É–≥–∏–π —Ä–∞—É–Ω–¥.</strong></p>
                        <p>–ü–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ–Ω—É—î–º–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É —Ä—è–¥–∫—ñ–≤ –¥–ª—è –∫—Ä–∞—â–æ–≥–æ –ø–µ—Ä–µ–º—ñ—à—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö.</p>
                    `;
                    
                    animateShiftRows();
                    shiftRows();
                    break;
                    
                case 10: // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 2 (AddRoundKey) - –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä–∞—É–Ω–¥
                    keyMatrix = roundKeys[2];
                    for (let i = 0; i < 2; i++) {
                        for (let j = 0; j < 2; j++) {
                            stateMatrix[i][j] = addBits(stateMatrix[i][j], keyMatrix[i][j]);
                        }
                    }
                    explanation.innerHTML = `
                        <p><strong>–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 2 (AddRoundKey) - –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä–∞—É–Ω–¥.</strong></p>
                        <p>–§—ñ–Ω–∞–ª—å–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è XOR. –û—Ç—Ä–∏–º–∞–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è —î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–º —Ç–µ–∫—Å—Ç–æ–º.</p>
                    `;
                    
                    // –ê–Ω—ñ–º—É—î–º–æ XOR –¥–ª—è –ø–µ—Ä—à–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞
                    animateXOR(stateMatrix[0][0], keyMatrix[0][0], stateMatrix[0][0], "–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥—É 2: XOR —Å—Ç–∞–Ω—É –∑ –∫–ª—é—á–µ–º —Ä–∞—É–Ω–¥—É");
                    break;
                    
                case 11: // –ó–∞–≤–µ—Ä—à–µ–Ω–æ
                    explanation.innerHTML = `
                        <p><strong>–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</strong></p>
                        <p>–î–ª—è –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –æ–±–µ—Ä–Ω–µ–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó —É <strong>–∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É</strong>.</p>
                        <p>–ö–Ω–æ–ø–∫–∞ "–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫—Ä–æ–∫" —Ç–µ–ø–µ—Ä –¥–æ–∑–≤–æ–ª—è—î –ø–æ–∫—Ä–æ–∫–æ–≤–æ –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ —Ü–µ–π –ø—Ä–æ—Ü–µ—Å –Ω–∞–∑–∞–¥.</p>
                    `;
                    break;
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –º–∞—Ç—Ä–∏—Ü—ñ, —è–∫—â–æ –Ω–µ –±—É–ª–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—ó –∞–Ω—ñ–º–∞—Ü—ñ—ó
            if (currentStep !== 4 && currentStep !== 8) {
                updateMatrixDisplay();
            }
        }

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è —Å–∏–º—É–ª—è—Ç–æ—Ä–∞
        function resetSimulator() {
            currentStep = 0;
            history = []; // –û—á–∏—â—É—î–º–æ —ñ—Å—Ç–æ—Ä—ñ—é
            
            // –ì–µ–Ω–µ—Ä—É—î–º–æ –Ω–æ–≤—ñ –≤–∏–ø–∞–¥–∫–æ–≤—ñ –º–∞—Ç—Ä–∏—Ü—ñ
            stateMatrix = generateRandomMatrix();
            originalKey = generateRandomMatrix();
            keyMatrix = originalKey;
            
            // –ì–ª–∏–±–æ–∫–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∫–ª—é—á–∞
            roundKeys[0] = originalKey.map(row => row.slice());
            roundKeys[1] = [["0000", "0000"], ["0000", "0000"]];
            roundKeys[2] = [["0000", "0000"], ["0000", "0000"]];
            
            updateMatrixDisplay(); // –ü–æ—á–∞—Ç–∫–æ–≤–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
            updateStep();
            saveState(); // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω (–ö—Ä–æ–∫ 0)
        }
        
        // --- –†–ï–§–ê–ö–¢–û–†–ò–ù–ì: animateKeyExpansion —Ç–∞ animateXOR –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ ---

        function animateXOR(cell1, cell2, resultCell, description) {
            // (–ù–µ –∑–º—ñ–Ω—é—î–º–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ—Å–Ω—É—é—á–∏–π DOM)
            animationArea.innerHTML = "";
            
            const container = document.createElement("div");
            container.style.textAlign = "center";
            
            const desc = document.createElement("div");
            desc.textContent = description;
            desc.style.marginBottom = "15px";
            desc.style.fontWeight = "bold";
            container.appendChild(desc);
            
            const value1 = document.createElement("div");
            value1.className = "matrix-cell";
            value1.textContent = cell1;
            value1.style.display = "inline-block";
            
            const plus = document.createElement("div");
            plus.className = "arrow";
            plus.textContent = "‚äï";
            plus.style.display = "inline-block";
            plus.style.margin = "0 10px";
            
            const value2 = document.createElement("div");
            value2.className = "matrix-cell key-cell";
            value2.textContent = cell2;
            value2.style.display = "inline-block";
            
            const equals = document.createElement("div");
            equals.className = "arrow";
            equals.textContent = "=";
            equals.style.display = "inline-block";
            equals.style.margin = "0 10px";
            
            const result = document.createElement("div");
            result.className = "matrix-cell";
            result.textContent = resultCell;
            result.style.display = "inline-block";
            result.style.backgroundColor = "#f39c12";
            
            container.appendChild(value1);
            container.appendChild(plus);
            container.appendChild(value2);
            container.appendChild(equals);
            container.appendChild(result);
            
            animationArea.appendChild(container);
        }

        function animateKeyExpansion(round) {
            // (–ö–æ–¥ –¥–ª—è –∞–Ω—ñ–º–∞—Ü—ñ—ó —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞)
            animationArea.innerHTML = "";
            
            const container = document.createElement("div");
            container.style.textAlign = "center";
            
            const title = document.createElement("div");
            title.textContent = `–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞ –¥–ª—è —Ä–∞—É–Ω–¥—É ${round}:`;
            title.style.marginBottom = "15px";
            title.style.fontWeight = "bold";
            
            container.appendChild(title);
            
            const prevKey = roundKeys[round - 1]; 
            const rcon = round === 1 ? "0001" : "0010";

            const stepsContainer = document.createElement("div");
            stepsContainer.className = "key-expansion-steps";
            
            const step1 = document.createElement("div");
            step1.className = "expansion-step";
            const step1Label = document.createElement("div");
            step1Label.className = "step-label";
            step1Label.textContent = `–ö–ª—é—á —Ä–∞—É–Ω–¥—É ${round-1}:`;
            step1.appendChild(step1Label);
            const step1Matrix = document.createElement("div");
            step1Matrix.className = "matrix";
            step1Matrix.innerHTML = `
                <div class="matrix-row">
                    <div class="matrix-cell key-cell">${prevKey[0][0]}</div>
                    <div class="matrix-cell key-cell">${prevKey[0][1]}</div>
                </div>
                <div class="matrix-row">
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${prevKey[1][0]}</div>
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${prevKey[1][1]}</div>
                </div>
            `;
            step1.appendChild(step1Matrix);
            stepsContainer.appendChild(step1);
            
            const arrow1 = document.createElement("div");
            arrow1.className = "arrow";
            arrow1.textContent = "‚Üí";
            arrow1.style.display = "flex";
            arrow1.style.alignItems = "center";
            stepsContainer.appendChild(arrow1);
            
            const step3 = document.createElement("div");
            step3.className = "expansion-step";
            const step3Label = document.createElement("div");
            step3Label.className = "step-label";
            step3Label.textContent = "–ü—ñ—Å–ª—è S-–±–ª–æ–∫—É:";
            step3.appendChild(step3Label);
            const step3Matrix = document.createElement("div");
            step3Matrix.className = "matrix";
            step3Matrix.innerHTML = `
                <div class="matrix-row">
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${subBytes(prevKey[1][0])}</div>
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${subBytes(prevKey[1][1])}</div>
                </div>
            `;
            step3.appendChild(step3Matrix);
            stepsContainer.appendChild(step3);
            
            const arrow3 = document.createElement("div");
            arrow3.className = "arrow";
            arrow3.textContent = "‚Üí";
            arrow3.style.display = "flex";
            arrow3.style.alignItems = "center";
            stepsContainer.appendChild(arrow3);
            
            const step4 = document.createElement("div");
            step4.className = "expansion-step";
            const step4Label = document.createElement("div");
            step4Label.className = "step-label";
            step4Label.textContent = `–ü—ñ—Å–ª—è XOR –∑ rcon (${rcon}):`;
            step4.appendChild(step4Label);
            const step4Matrix = document.createElement("div");
            step4Matrix.className = "matrix";
            step4Matrix.innerHTML = `
                <div class="matrix-row">
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${addBits(subBytes(prevKey[1][0]), rcon)}</div>
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${subBytes(prevKey[1][1])}</div>
                </div>
            `;
            step4.appendChild(step4Matrix);
            stepsContainer.appendChild(step4);
            
            const arrow4 = document.createElement("div");
            arrow4.className = "arrow";
            arrow4.textContent = "‚Üí";
            arrow4.style.display = "flex";
            arrow4.style.alignItems = "center";
            stepsContainer.appendChild(arrow4);
            
            const step5 = document.createElement("div");
            step5.className = "expansion-step";
            const step5Label = document.createElement("div");
            step5Label.className = "step-label";
            step5Label.textContent = "–ü–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ (XOR –∑ 1–º —Ä—è–¥–∫–æ–º):";
            step5.appendChild(step5Label);
            const step5Matrix = document.createElement("div");
            step5Matrix.className = "matrix";
            step5Matrix.innerHTML = `
                <div class="matrix-row">
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${roundKeys[round][0][0]}</div>
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${roundKeys[round][0][1]}</div>
                </div>
            `;
            step5.appendChild(step5Matrix);
            stepsContainer.appendChild(step5);
            
            const arrow5 = document.createElement("div");
            arrow5.className = "arrow";
            arrow5.textContent = "‚Üí";
            arrow5.style.display = "flex";
            arrow5.style.alignItems = "center";
            stepsContainer.appendChild(arrow5);
            
            const step6 = document.createElement("div");
            step6.className = "expansion-step";
            const step6Label = document.createElement("div");
            step6Label.className = "step-label";
            step6Label.textContent = "–î—Ä—É–≥–∏–π —Ä—è–¥–æ–∫ (XOR –∑ 2–º —Ä—è–¥–∫–æ–º):";
            step6.appendChild(step6Label);
            const step6Matrix = document.createElement("div");
            step6Matrix.className = "matrix";
            step6Matrix.innerHTML = `
                <div class="matrix-row">
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${roundKeys[round][1][0]}</div>
                    <div class="matrix-cell key-cell" style="background-color: #f39c12;">${roundKeys[round][1][1]}</div>
                </div>
            `;
            step6.appendChild(step6Matrix);
            stepsContainer.appendChild(step6);
            
            container.appendChild(stepsContainer);

            const sBoxTitle = document.createElement("div");
            sBoxTitle.textContent = "S-–±–ª–æ–∫, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–º—ñ–Ω–∏ –±–∞–π—Ç—ñ–≤:";
            sBoxTitle.style.fontWeight = "bold";
            sBoxTitle.style.marginTop = "20px";
            container.appendChild(sBoxTitle);

            const sBoxTable = document.createElement("div");
            sBoxTable.style.display = "grid";
            sBoxTable.style.gridTemplateColumns = "repeat(4, 1fr)";
            sBoxTable.style.gap = "5px";
            sBoxTable.style.margin = "15px auto";
            sBoxTable.style.maxWidth = "300px";
            
            for (let i = 0; i < 16; i++) {
                const key = i.toString(2).padStart(4, '0');
                const value = sBox[key];
                
                const cell = document.createElement("div");
                cell.className = "matrix-cell";
                cell.style.fontSize = "12px";
                cell.style.padding = "5px";
                cell.style.width = "unset";
                cell.style.height = "unset";
                cell.textContent = `${key}‚Üí${value}`;
                
                if (key === prevKey[1][0] || key === prevKey[1][1]) {
                    cell.classList.add('highlight');
                }
                
                sBoxTable.appendChild(cell);
            }
            container.appendChild(sBoxTable);
            
            const processExplanation = document.createElement("div");
            processExplanation.style.marginTop = "15px";
            processExplanation.style.textAlign = "left";
            processExplanation.style.maxWidth = "600px";
            processExplanation.style.margin = "15px auto";
            
            processExplanation.innerHTML = `
                <p><strong>–ü—Ä–æ—Ü–µ—Å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∫–ª—é—á–∞:</strong></p>
                <p>1. –ë–µ—Ä–µ–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä—è–¥–æ–∫ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫–ª—é—á–∞: [${prevKey[1][0]}, ${prevKey[1][1]}]</p>
                <p>2. –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ S-–±–ª–æ–∫ –¥–æ –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞: [${subBytes(prevKey[1][0])}, ${subBytes(prevKey[1][1])}]</p>
                <p>3. –î–æ–¥–∞—î–º–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É —Ä–∞—É–Ω–¥—É (${rcon}) –¥–æ –ø–µ—Ä—à–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é XOR: ${addBits(subBytes(prevKey[1][0]), rcon)}</p>
                <p>4. –û–±—á–∏—Å–ª—é—î–º–æ –Ω–æ–≤–∏–π –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫: XOR –∑ –ø–µ—Ä—à–∏–º —Ä—è–¥–∫–æ–º –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫–ª—é—á–∞</p>
                <p>5. –û–±—á–∏—Å–ª—é—î–º–æ –Ω–æ–≤–∏–π –¥—Ä—É–≥–∏–π —Ä—è–¥–æ–∫: XOR –ø–µ—Ä—à–æ–≥–æ —Ä—è–¥–∫–∞ –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞ –∑ –¥—Ä—É–≥–∏–º —Ä—è–¥–∫–æ–º –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫–ª—é—á–∞</p>
                <p><strong>–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Ä–∞—É–Ω–¥—É:</strong> –¶–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–µ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –∫–ª—é—á—ñ —Ä–∞—É–Ω–¥—ñ–≤ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è.</p>
            `;
            
            container.appendChild(processExplanation);
            
            animationArea.appendChild(container);
        }

        function animateShiftRows() {
            // (–ù–µ –∑–º—ñ–Ω—é—î–º–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ—Å–Ω—É—é—á–∏–π DOM)
            animationArea.innerHTML = "";
            
            const container = document.createElement("div");
            container.style.textAlign = "center";
            
            const title = document.createElement("div");
            title.textContent = "–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—è–¥–∫—ñ–≤:";
            title.style.marginBottom = "15px";
            title.style.fontWeight = "bold";
            
            container.appendChild(title);
            
            const comparison = document.createElement("div");
            comparison.style.display = "flex";
            comparison.style.justifyContent = "center";

            const beforeMatrix = document.createElement("div");
            beforeMatrix.className = "matrix";
            beforeMatrix.style.display = "inline-block";
            const row1 = document.createElement("div"); row1.className = "matrix-row";
            const cell00 = document.createElement("div"); cell00.className = "matrix-cell"; cell00.textContent = stateMatrix[0][0]; row1.appendChild(cell00);
            const cell01 = document.createElement("div"); cell01.className = "matrix-cell"; cell01.textContent = stateMatrix[0][1]; row1.appendChild(cell01);
            beforeMatrix.appendChild(row1);
            const row2 = document.createElement("div"); row2.className = "matrix-row";
            const cell10 = document.createElement("div"); cell10.className = "matrix-cell"; cell10.textContent = stateMatrix[1][0]; cell10.style.backgroundColor = "#f39c12"; row2.appendChild(cell10);
            const cell11 = document.createElement("div"); cell11.className = "matrix-cell"; cell11.textContent = stateMatrix[1][1]; cell11.style.backgroundColor = "#f39c12"; row2.appendChild(cell11);
            beforeMatrix.appendChild(row2);
            comparison.appendChild(beforeMatrix);

            const arrow = document.createElement("div");
            arrow.className = "arrow";
            arrow.textContent = "‚Üí";
            arrow.style.display = "flex";
            arrow.style.alignItems = "center";
            arrow.style.fontSize = "30px";
            comparison.appendChild(arrow);
            
            const afterMatrix = document.createElement("div");
            afterMatrix.className = "matrix";
            afterMatrix.style.display = "inline-block";
            const row1After = document.createElement("div"); row1After.className = "matrix-row";
            const cell00After = document.createElement("div"); cell00After.className = "matrix-cell"; cell00After.textContent = stateMatrix[0][0]; row1After.appendChild(cell00After);
            const cell01After = document.createElement("div"); cell01After.className = "matrix-cell"; cell01After.textContent = stateMatrix[0][1]; row1After.appendChild(cell01After);
            afterMatrix.appendChild(row1After);
            const row2After = document.createElement("div"); row2After.className = "matrix-row";
            const cell10After = document.createElement("div"); cell10After.className = "matrix-cell"; cell10After.textContent = stateMatrix[1][1]; cell10After.style.backgroundColor = "#f39c12"; row2After.appendChild(cell10After);
            const cell11After = document.createElement("div"); cell11After.className = "matrix-cell"; cell11After.textContent = stateMatrix[1][0]; cell11After.style.backgroundColor = "#f39c12"; row2After.appendChild(cell11After);
            afterMatrix.appendChild(row2After);
            comparison.appendChild(afterMatrix);
            
            container.appendChild(comparison);
            animationArea.appendChild(container);
        }

        function animateMixColumns() {
            // (–ù–µ –∑–º—ñ–Ω—é—î–º–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ—Å–Ω—É—é—á–∏–π DOM)
            animationArea.innerHTML = "";
            
            const container = document.createElement("div");
            container.style.textAlign = "center";
            
            const title = document.createElement("div");
            title.textContent = "–ó–º—ñ—à—É–≤–∞–Ω–Ω—è —Å—Ç–æ–≤–ø—Ü—ñ–≤: –°—É—Ä–æ–≥–∞—Ç–Ω–∞ –¥–∏—Ñ—É–∑—ñ—è (RotL + XOR)";
            title.style.marginBottom = "15px";
            title.style.fontWeight = "bold";
            container.appendChild(title);

            const rules = document.createElement("div");
            rules.style.textAlign = "left";
            rules.style.maxWidth = "600px";
            rules.style.margin = "10px auto";
            rules.style.backgroundColor = "#f8f9fa";
            rules.style.padding = "10px";
            rules.style.borderRadius = "5px";
            rules.innerHTML = `
                <p><strong>–í–∞–∂–ª–∏–≤–∞ –ø—Ä–∏–º—ñ—Ç–∫–∞:</strong> –¶–µ –æ–ø–µ—Ä–∞—Ü—ñ—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –¥–∏—Ñ—É–∑—ñ—ó. –í–æ–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–∏–∫–ª—ñ—á–Ω—ñ –∑—Å—É–≤–∏ (RotL) —Ç–∞ XOR, —â–æ–± –∑–º—ñ—à–∞—Ç–∏ –±—ñ—Ç–∏, —ñ —î –ø–æ–≤–Ω—ñ—Å—Ç—é –æ–±–æ—Ä–æ—Ç–Ω–æ—é.</p>
                <p><strong>–í —Ä–µ–∞–ª—å–Ω–æ–º—É AES</strong> —Ç—É—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è <strong>–º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ –º–∞—Ç—Ä–∏—Ü—é –≤ –ü–æ–ª—ñ –ì–∞–ª—É–∞</strong> GF(2^8), —è–∫–∞ –∞–ø–∞—Ä–∞—Ç–Ω–æ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–∞–∫–∏—Ö —Å–∞–º–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π XOR —ñ –∑—Å—É–≤—ñ–≤.</p>
                <hr>
                <p style="text-align:center; font-weight: bold;">–ü—Ä–∞–≤–∏–ª–∞ –Ω–∞—à–æ–≥–æ —Å–∏–º—É–ª—è—Ç–æ—Ä–∞ (–¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å—Ç–æ–≤–ø—Ü—è):</p>
                <p style="text-align:center; font-family: monospace;">1. <strong>s'<sub>0</sub> = s<sub>0</sub> ‚äï RotL(s<sub>1</sub>, 1)</strong></p>
                <p style="text-align:center; font-family: monospace;">2. <strong>s'<sub>1</sub> = s<sub>1</sub> ‚äï RotL(s'<sub>0</sub>, 2)</strong></p>
            `;
            container.appendChild(rules);
            
            const columnsContainer = document.createElement("div");
            columnsContainer.className = "mix-columns-container";
            
            for (let col = 0; col < 2; col++) {
                const s0 = stateMatrix[0][col];
                const s1 = stateMatrix[1][col];

                const s1_rot1 = RotL(s1, 1);
                const s0_prime = addBits(s0, s1_rot1);
                const s0_prime_rot2 = RotL(s0_prime, 2);
                const s1_prime = addBits(s1, s0_prime_rot2);

                const columnDiv = document.createElement("div");
                columnDiv.className = "mix-column";
                
                const colTitle = document.createElement("div");
                colTitle.className = "column-title";
                colTitle.textContent = `–°—Ç–æ–≤–ø–µ—Ü—å ${col + 1}:`;
                columnDiv.appendChild(colTitle);

                const beforeMatrix = document.createElement("div");
                beforeMatrix.className = "matrix";
                beforeMatrix.innerHTML = `
                    <div class="matrix-cell">${s0}</div>
                    <div class="matrix-cell">${s1}</div>
                `;
                columnDiv.appendChild(beforeMatrix);

                const arrowDown = document.createElement("div");
                arrowDown.className = "arrow";
                arrowDown.textContent = "‚Üì";
                columnDiv.appendChild(arrowDown);

                const eqDiv = document.createElement("div");
                eqDiv.style.fontFamily = "monospace";
                eqDiv.style.margin = "10px 0";
                eqDiv.innerHTML = `
                    <p>${s0} ‚äï RotL(${s1}, 1) = ${s0} ‚äï ${s1_rot1} = <strong>${s0_prime}</strong></p>
                    <p>${s1} ‚äï RotL(${s0_prime}, 2) = ${s1} ‚äï ${s0_prime_rot2} = <strong>${s1_prime}</strong></p>
                `;
                columnDiv.appendChild(eqDiv);

                const afterMatrix = document.createElement("div");
                afterMatrix.className = "matrix";
                afterMatrix.innerHTML = `
                    <div class="matrix-cell" style="background-color: #f39c12;">${s0_prime}</div>
                    <div class="matrix-cell" style="background-color: #f39c12;">${s1_prime}</div>
                `;
                columnDiv.appendChild(afterMatrix);
                
                columnsContainer.appendChild(columnDiv);
            }
            
            container.appendChild(columnsContainer);
            animationArea.appendChild(container);
        }

        // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
        nextStepBtn.addEventListener("click", nextStep);
        prevStepBtn.addEventListener("click", prevStep);
        resetBtn.addEventListener("click", resetSimulator);

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        resetSimulator();
    </script>
</body>
</html>