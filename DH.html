<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑ –æ–±–º—ñ–Ω–æ–º –∫–ª—é—á–∞–º–∏</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.5;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 15px;
            background-color: #f5f5f5;
        }
        h1, h2, h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        .step {
            display: none;
            padding: 12px;
            border-left: 4px solid #3498db;
            margin-bottom: 12px;
            background-color: #f8f9fa;
        }
        .step.active {
            display: block;
        }
        .step-number {
            display: inline-block;
            background-color: #3498db;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            margin-right: 8px;
            font-size: 14px;
        }
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .visualization {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 15px 0;
            padding: 12px;
            background-color: #ecf0f1;
            border-radius: 6px;
        }
        .person {
            text-align: center;
        }
        .person-name {
            margin-top: 5px;
            font-weight: bold;
            font-size: 16px;
        }
        .person-keys {
            margin-top: 8px;
            font-size: 12px;
            background-color: #fff;
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .formula {
            font-family: 'Courier New', monospace;
            background-color: #f8f9fa;
            padding: 8px;
            border-radius: 4px;
            margin: 8px 0;
            border-left: 3px solid #3498db;
            font-style: italic;
            font-size: 14px;
        }
        .key-display {
            display: flex;
            justify-content: space-around;
            margin: 12px 0;
        }
        .key {
            background-color: #e8f4fc;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #3498db;
            text-align: center;
            min-width: 130px;
            font-size: 14px;
        }
        .calculation {
            background-color: #fff;
            padding: 8px;
            border-radius: 4px;
            margin: 8px 0;
            border: 1px solid #ddd;
            font-size: 14px;
        }
        .info-box {
            background-color: #e8f4fc;
            padding: 12px;
            border-radius: 4px;
            margin: 12px 0;
            border-left: 4px solid #3498db;
            font-size: 14px;
        }
        .warning-box {
            background-color: #fff3cd;
            padding: 12px;
            border-radius: 4px;
            margin: 12px 0;
            border-left: 4px solid #ffc107;
            font-size: 14px;
        }
        .spoiler {
            border: 1px solid #ccc;
            border-radius: 4px;
            margin: 12px 0;
        }
        .spoiler summary {
            padding: 8px 12px;
            background-color: #e9ecef;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
        }
        .spoiler-content {
            padding: 12px;
            border-top: 1px solid #ccc;
            font-size: 14px;
        }
        .analogy {
            background-color: #fff;
            border: 2px solid #9b59b6;
            padding: 12px;
            border-radius: 6px;
            margin: 12px 0;
        }
        .analogy-title {
            color: #9b59b6;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 16px;
        }
        .input-group {
            margin: 8px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 4px;
            font-weight: bold;
            font-size: 14px;
        }
        .input-group input {
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 3px;
            width: 90px;
            font-size: 14px;
        }
        .interactive-task {
            background-color: #e8f6ff;
            padding: 12px;
            border-radius: 6px;
            margin: 12px 0;
            border-left: 4px solid #3498db;
            font-size: 14px;
        }
        .task-button {
            background-color: #2ecc71;
            margin-top: 8px;
        }
        .task-button:hover {
            background-color: #27ae60;
        }
        .result {
            font-weight: bold;
            color: #2c3e50;
            margin-top: 8px;
            font-size: 14px;
        }
        .answer-spoiler {
            margin-top: 8px;
        }
        .correct-answer {
            color: #27ae60;
            font-weight: bold;
        }
        .shared-secret {
            background-color: #2ecc71;
            color: white;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
            margin: 12px 0;
            font-weight: bold;
            font-size: 14px;
        }
        .paint-can {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 5px;
        }
        .paint-can-visual {
            width: 70px;
            height: 85px;
            background-color: #f8f9fa;
            border: 2px solid #333;
            border-radius: 0 0 15px 15px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }
        .paint-fill {
            width: 100%;
            position: absolute;
            bottom: 0;
            transition: height 1s;
        }
        .paint-label {
            margin-top: 5px;
            text-align: center;
            font-weight: bold;
            font-size: 12px;
        }
        .paint-exchange {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px 0;
        }
        .paint-row {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 5px 0;
        }
        .exchange-arrow {
            font-size: 20px;
            margin: 0 10px;
        }
        .exchange-direction {
            display: flex;
            align-items: center;
            margin: 5px 0;
            font-weight: bold;
            font-size: 14px;
        }
        .exchange-direction .arrow {
            font-size: 20px;
            margin: 0 8px;
        }
        .color-display {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }
        .color-box {
            width: 100px;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <h3>–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–ª—è —Å–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</h3>
    <p>–¶–µ–π —Å–∏–º—É–ª—è—Ç–æ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏ —Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑ –æ–±–º—ñ–Ω–æ–º –∫–ª—é—á–∞–º–∏ –∑–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞.</p>

    <div class="analogy">
        <div class="analogy-title">üé® –ê–Ω–∞–ª–æ–≥—ñ—è –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏ –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞</div>
        
        <h4>–û–±–º—ñ–Ω –∫–ª—é—á–∞–º–∏ (–ø—Ä–æ—Ç–æ–∫–æ–ª –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞ —É —Ñ—ñ–∑–∏—á–Ω–æ–º—É —Å–≤—ñ—Ç—ñ):</h4>
        
        <div class="color-display">
            <div class="color-box" id="base-color" style="background-color: #3498db;">
                –ë–∞–∑–æ–≤–∞ —Ñ–∞—Ä–±–∞<br>(–ø—É–±–ª—ñ—á–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä)
            </div>
            <div class="color-box" id="alice-secret-color" style="background-color: #e74c3c;">
                –°–µ–∫—Ä–µ—Ç –ê–ª—ñ—Å–∏
            </div>
            <div class="color-box" id="bob-secret-color" style="background-color: #f39c12;">
                –°–µ–∫—Ä–µ—Ç –ë–æ–±–∞
            </div>
            <button onclick="generateNewColors()" style="margin-left: 10px;">üé® –ù–æ–≤—ñ –∫–æ–ª—å–æ—Ä–∏</button>
        </div>
        
        <div class="paint-exchange">
            <!-- –ü–µ—Ä—à–∏–π —Ä—è–¥–æ–∫: –ê–ª—ñ—Å–∞ –≥–æ—Ç—É—î –∫–ª—é—á -->
            <div class="paint-row">
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="alice-base" style="background-color: #3498db; height: 60%"></div>
                    </div>
                    <div class="paint-label">–ë–∞–∑–∞ (g)</div>
                </div>
                
                <div class="exchange-arrow">+</div>
                
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="alice-secret" style="background-color: #e74c3c; height: 40%"></div>
                    </div>
                    <div class="paint-label">–°–µ–∫—Ä–µ—Ç –ê–ª—ñ—Å–∏ (a)</div>
                </div>
                
                <div class="exchange-arrow">=</div>
                
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="alice-public" style="background-color: #9b59b6; height: 70%"></div>
                    </div>
                    <div class="paint-label">A = g<sup>a</sup> mod p</div>
                </div>
            </div>
            
            <div class="exchange-direction">
                <div>üëß –ê–ª—ñ—Å–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –ë–æ–±—É ‚Üí A</div>
                <div class="arrow">‚áÑ</div>
                <div>B ‚Üê –ë–æ–± –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –ê–ª—ñ—Å—ñ üë¶</div>
            </div>
            
            <!-- –î—Ä—É–≥–∏–π —Ä—è–¥–æ–∫: –ë–æ–± –≥–æ—Ç—É—î –∫–ª—é—á -->
            <div class="paint-row">
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="bob-base" style="background-color: #3498db; height: 60%"></div>
                    </div>
                    <div class="paint-label">–ë–∞–∑–∞ (g)</div>
                </div>
                
                <div class="exchange-arrow">+</div>
                
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="bob-secret" style="background-color: #f39c12; height: 40%"></div>
                    </div>
                    <div class="paint-label">–°–µ–∫—Ä–µ—Ç –ë–æ–±–∞ (b)</div>
                </div>
                
                <div class="exchange-arrow">=</div>
                
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="bob-public" style="background-color: #8e44ad; height: 70%"></div>
                    </div>
                    <div class="paint-label">B = g<sup>b</sup> mod p</div>
                </div>
            </div>
            
            <div class="exchange-direction" style="margin-top: 15px;">
                <div>–û–±–∏–¥–≤–∞ –æ–±—á–∏—Å–ª—é—é—Ç—å —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç:</div>
            </div>
            
            <!-- –¢—Ä–µ—Ç—ñ–π —Ä—è–¥–æ–∫: –ê–ª—ñ—Å–∞ –æ–±—á–∏—Å–ª—é—î —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç -->
            <div class="paint-row">
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="alice-received" style="background-color: #8e44ad; height: 70%"></div>
                    </div>
                    <div class="paint-label">–û—Ç—Ä–∏–º–∞–Ω–∞ B</div>
                </div>
                
                <div class="exchange-arrow">+</div>
                
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="alice-secret2" style="background-color: #e74c3c; height: 40%"></div>
                    </div>
                    <div class="paint-label">–°–µ–∫—Ä–µ—Ç –ê–ª—ñ—Å–∏ (a)</div>
                </div>
                
                <div class="exchange-arrow">=</div>
                
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="alice-shared" style="background-color: #2ecc71; height: 100%"></div>
                    </div>
                    <div class="paint-label">S = B<sup>a</sup> mod p</div>
                </div>
            </div>
            
            <!-- –ß–µ—Ç–≤–µ—Ä—Ç–∏–π —Ä—è–¥–æ–∫: –ë–æ–± –æ–±—á–∏—Å–ª—é—î —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç -->
            <div class="paint-row">
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="bob-received" style="background-color: #9b59b6; height: 70%"></div>
                    </div>
                    <div class="paint-label">–û—Ç—Ä–∏–º–∞–Ω–∞ A</div>
                </div>
                
                <div class="exchange-arrow">+</div>
                
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="bob-secret2" style="background-color: #f39c12; height: 40%"></div>
                    </div>
                    <div class="paint-label">–°–µ–∫—Ä–µ—Ç –ë–æ–±–∞ (b)</div>
                </div>
                
                <div class="exchange-arrow">=</div>
                
                <div class="paint-can">
                    <div class="paint-can-visual">
                        <div class="paint-fill" id="bob-shared" style="background-color: #2ecc71; height: 100%"></div>
                    </div>
                    <div class="paint-label">S = A<sup>b</sup> mod p</div>
                </div>
            </div>
        </div>
        
        <ul>
            <li><strong>–ê–ª—ñ—Å–∞ —Ç–∞ –ë–æ–± –¥–æ–º–æ–≤–ª—è—é—Ç—å—Å—è –ø—Ä–æ —Å–ø—ñ–ª—å–Ω—É –±–∞–∑–æ–≤—É —Ñ–∞—Ä–±—É</strong> (public parameters) - —Ü–µ –Ω–µ —Å–µ–∫—Ä–µ—Ç</li>
            <li><strong>–ö–æ–∂–µ–Ω –∑–º—ñ—à—É—î —Å–≤–æ—é —Å–µ–∫—Ä–µ—Ç–Ω—É —Ñ–∞—Ä–±—É</strong> (private key) –∑ –±–∞–∑–æ–≤–æ—é</li>
            <li>–í–æ–Ω–∏ –æ–±–º—ñ–Ω—é—é—Ç—å—Å—è –æ—Ç—Ä–∏–º–∞–Ω–∏–º–∏ —Å—É–º—ñ—à–∞–º–∏ - –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ö—Ç–æ—Å—å –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç—å —ó—Ö, –≤—ñ–Ω –Ω–µ –∑–º–æ–∂–µ –≤—ñ–¥–æ–∫—Ä–µ–º–∏—Ç–∏ —Å–µ–∫—Ä–µ—Ç–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏</li>
            <li><strong>–ö–æ–∂–µ–Ω –¥–æ–¥–∞—î —Å–≤–æ—é —Å–µ–∫—Ä–µ—Ç–Ω—É —Ñ–∞—Ä–±—É</strong> –¥–æ –æ—Ç—Ä–∏–º–∞–Ω–æ—ó —Å—É–º—ñ—à—ñ</li>
            <li>–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –æ–±–∏–¥–≤–∞ –æ—Ç—Ä–∏–º—É—é—Ç—å —ñ–¥–µ–Ω—Ç–∏—á–Ω—É —Ñ—ñ–Ω–∞–ª—å–Ω—É —Ñ–∞—Ä–±—É - —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á!</li>
            <li>–ü–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—á, –º–∞—é—á–∏ –≤—Å—ñ –ø—Ä–æ–º—ñ–∂–Ω—ñ —Å—É–º—ñ—à—ñ, –Ω–µ –º–æ–∂–µ –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–Ω—Ü–µ–≤–∏–π –∫–æ–ª—ñ—Ä</li>
        </ul>
    </div>

    <div class="container">
        <h2>üîê –°–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑ –æ–±–º—ñ–Ω–æ–º –∫–ª—é—á–∞–º–∏</h2>
        <p>–ê–ª—ñ—Å–∞ —Ç–∞ –ë–æ–± —Ö–æ—á—É—Ç—å —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è —Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ—Ç–æ–∫–æ–ª—É –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞.</p>
        
        <div class="visualization">
            <div class="person">
                <div>üëß</div>
                <div class="person-name">–ê–ª—ñ—Å–∞</div>
                <div class="person-keys">
                    <div>–°–µ–∫—Ä–µ—Ç–Ω–µ —á–∏—Å–ª–æ: <span id="alice-secret-value">6</span></div>
                    <div>–ü—É–±–ª—ñ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è: <span id="alice-public-value">8</span></div>
                </div>
            </div>
            
            <div class="exchange-direction">
                <div>A = <span id="display-a">8</span></div>
                <div class="arrow">‚Üí</div> <div class="arrow">‚Üê</div>
                <div>B = <span id="display-b">19</span></div>
               
            </div>
            
            <div class="person">
                <div>üë¶</div>
                <div class="person-name">–ë–æ–±</div>
                <div class="person-keys">
                    <div>–°–µ–∫—Ä–µ—Ç–Ω–µ —á–∏—Å–ª–æ: <span id="bob-secret-value">15</span></div>
                    <div>–ü—É–±–ª—ñ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è: <span id="bob-public-value">19</span></div>
                </div>
            </div>
        </div>

        <div class="step active" id="step1">
            <h3><span class="step-number">1</span> –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤</h3>
            <p>–ê–ª—ñ—Å–∞ —Ç–∞ –ë–æ–± –¥–æ–º–æ–≤–ª—è—é—Ç—å—Å—è –ø—Ä–æ —Å–ø—ñ–ª—å–Ω—ñ –ø—É–±–ª—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥–æ–º—ñ –≤—Å—ñ–º.</p>
            
            <div class="input-group">
                <label>–í–≤–µ–¥—ñ—Ç—å —Å–ø—ñ–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (–ø—Ä–æ—Å—Ç—ñ —á–∏—Å–ª–∞):</label>
                <input type="number" id="input-p" placeholder="p" value="23" min="2" max="97">
                <input type="number" id="input-g" placeholder="g" value="5" min="2" max="97">
                <button onclick="calculatePublicValues()" class="task-button">–û–±—á–∏—Å–ª–∏—Ç–∏ –ø—É–±–ª—ñ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è</button>
            </div>
            
            <div class="info-box">
                <p><strong>–ö—Ä–æ–∫–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:</strong></p>
                <ol>
                    <li>–í–∏–±–∏—Ä–∞—î–º–æ –ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ p = <span id="p-value">23</span> (–º–æ–¥—É–ª—å)</li>
                    <li>–í–∏–±–∏—Ä–∞—î–º–æ –æ—Å–Ω–æ–≤—É g = <span id="g-value">5</span> (–æ—Å–Ω–æ–≤–∞ —Å—Ç–µ–ø–µ–Ω—è)</li>
                    <li>–ê–ª—ñ—Å–∞ –æ–±–∏—Ä–∞—î —Å–µ–∫—Ä–µ—Ç–Ω–µ —á–∏—Å–ª–æ a = <span id="a-value">6</span></li>
                    <li>–ë–æ–± –æ–±–∏—Ä–∞—î —Å–µ–∫—Ä–µ—Ç–Ω–µ —á–∏—Å–ª–æ b = <span id="b-value">15</span></li>
                </ol>
            </div>
            
            <div class="interactive-task">
                <p><strong>–°–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ:</strong> –û–±—á–∏—Å–ª—ñ—Ç—å –ø—É–±–ª—ñ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ê–ª—ñ—Å–∏ A = g<sup>a</sup> mod p</p>
                <p>g = <span id="task-g">5</span>, a = <span id="task-a">6</span>, p = <span id="task-p">23</span></p>
                <div class="input-group">
                    <input type="number" id="input-public-alice" placeholder="A">
                    <button onclick="checkPublicAlice()" class="task-button">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ A</button>
                </div>
                <div id="public-alice-result" class="result"></div>
                <div class="answer-spoiler" id="public-alice-answer" style="display: none;">
                    <details>
                        <summary>–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>
                        <p class="correct-answer">A = <span id="correct-public-alice">8</span></p>
                        <p>–û–±—á–∏—Å–ª–µ–Ω–Ω—è: 5<sup>6</sup> = 15625, 15625 mod 23 = 8</p>
                    </details>
                </div>
            </div>
            
            <div class="key-display">
                <div class="key">
                    <h4>üëß –ü—É–±–ª—ñ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ê–ª—ñ—Å–∏</h4>
                    <p>A = g<sup>a</sup> mod p = <span id="public-alice">8</span></p>
                </div>
                <div class="key">
                    <h4>üë¶ –ü—É–±–ª—ñ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ë–æ–±–∞</h4>
                    <p>B = g<sup>b</sup> mod p = <span id="public-bob">19</span></p>
                </div>
            </div>
            
            <p>–ê–ª—ñ—Å–∞ —Ç–∞ –ë–æ–± –æ–±–º—ñ–Ω—é—é—Ç—å—Å—è —Å–≤–æ—ó–º–∏ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏. –ù–∞–≤—ñ—Ç—å —è–∫—â–æ —Ö—Ç–æ—Å—å –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç—å —Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –≤—ñ–Ω –Ω–µ –∑–º–æ–∂–µ –æ–±—á–∏—Å–ª–∏—Ç–∏ —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç.</p>
        </div>

        <div class="step" id="step2">
            <h3><span class="step-number">2</span> –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞</h3>
            <p>–ö–æ–∂–µ–Ω –∑ —É—á–∞—Å–Ω–∏–∫—ñ–≤ –æ–±—á–∏—Å–ª—é—î —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–≤–æ—î —Å–µ–∫—Ä–µ—Ç–Ω–µ —á–∏—Å–ª–æ —Ç–∞ –ø—É–±–ª—ñ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞.</p>
            
            <div class="interactive-task">
                <p><strong>–°–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ:</strong> –û–±—á–∏—Å–ª—ñ—Ç—å —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç S = B<sup>a</sup> mod p</p>
                <p>B = <span id="task-b-value">19</span>, a = <span id="task-a2">6</span>, p = <span id="task-p2">23</span></p>
                <div class="input-group">
                    <input type="number" id="input-shared-secret" placeholder="S">
                    <button onclick="checkSharedSecret()" class="task-button">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ S</button>
                </div>
                <div id="shared-secret-result" class="result"></div>
                <div class="answer-spoiler" id="shared-secret-answer" style="display: none;">
                    <details>
                        <summary>–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>
                        <p class="correct-answer">S = <span id="correct-shared-secret">2</span></p>
                        <p>–û–±—á–∏—Å–ª–µ–Ω–Ω—è: 19<sup>6</sup> = 47045881, 47045881 mod 23 = 2</p>
                    </details>
                </div>
            </div>
            
            <div class="calculation">
                <p><strong>–ê–ª—ñ—Å–∞ –æ–±—á–∏—Å–ª—é—î:</strong> S = B<sup>a</sup> mod p = <span id="alice-calculation">19<sup>6</sup> mod 23 = 2</span></p>
                <p><strong>–ë–æ–± –æ–±—á–∏—Å–ª—é—î:</strong> S = A<sup>b</sup> mod p = <span id="bob-calculation">8<sup>15</sup> mod 23 = 2</span></p>
            </div>
            
            <div class="shared-secret">
                –°–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á: <span id="shared-key">2</span>
            </div>
            
            <p>–û–±–∏–¥–≤–∞ –æ—Ç—Ä–∏–º–∞–ª–∏ –æ–¥–Ω–∞–∫–æ–≤–∏–π —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á, –Ω–µ —Ä–æ–∑–∫—Ä–∏–≤–∞—é—á–∏ —Å–≤–æ—ó —Å–µ–∫—Ä–µ—Ç–Ω—ñ —á–∏—Å–ª–∞!</p>
            
            <div class="info-box">
                <p>‚úÖ –¢–µ–ø–µ—Ä –ê–ª—ñ—Å–∞ —Ç–∞ –ë–æ–± –º–∞—é—Ç—å —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è —Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Å–≤–æ—ó—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.</p>
            </div>
        </div>

        <div class="controls">
            <button id="prev-btn" onclick="prevStep()" disabled>‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫—Ä–æ–∫</button>
            <button id="next-btn" onclick="nextStep()">–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Üí</button>
        </div>
    </div>

    <!-- –î–µ—Ç–∞–ª—å–Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –¥–æ–≤—ñ–¥–∫–∞ -->
    <div class="container">
        <div class="spoiler">
            <summary>üìö –î–µ—Ç–∞–ª—å–Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –¥–æ–≤—ñ–¥–∫–∞</summary>
            <div class="spoiler-content">
                <h3>–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –æ—Å–Ω–æ–≤–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—É –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞</h3>
                
                <h4>1. –©–æ —Ç–∞–∫–µ –ø—Ä–æ—Ç–æ–∫–æ–ª –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞?</h4>
                <p>–ü—Ä–æ—Ç–æ–∫–æ–ª –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞ - —Ü–µ –º–µ—Ç–æ–¥ –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –æ–±–º—ñ–Ω—É –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏ —á–µ—Ä–µ–∑ –Ω–µ–∑–∞—Ö–∏—â–µ–Ω–∏–π –∫–∞–Ω–∞–ª –∑–≤'—è–∑–∫—É. –í—ñ–Ω –±—É–≤ –æ–¥–Ω–∏–º –∑ –ø–µ—Ä—à–∏—Ö –ø—Ä–∞–∫—Ç–∏—á–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞.</p>
                
                <h4>2. –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ –æ—Å–Ω–æ–≤–∞</h4>
                <p>–ü—Ä–æ—Ç–æ–∫–æ–ª –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞ –≤ —Å–∫—ñ–Ω—á–µ–Ω–Ω–∏—Ö –ø–æ–ª—è—Ö.</p>
                <p>–î–ª—è –¥–≤–æ—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤ –ê–ª—ñ—Å–∏ —Ç–∞ –ë–æ–±–∞:</p>
                <ol>
                    <li>–í–æ–Ω–∏ –æ–±–∏—Ä–∞—é—Ç—å —Å–ø—ñ–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏: –≤–µ–ª–∏–∫–µ –ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ p —Ç–∞ –æ—Å–Ω–æ–≤—É g</li>
                    <li>–ê–ª—ñ—Å–∞ –æ–±–∏—Ä–∞—î –≤–∏–ø–∞–¥–∫–æ–≤–µ —Å–µ–∫—Ä–µ—Ç–Ω–µ —á–∏—Å–ª–æ a, –æ–±—á–∏—Å–ª—é—î A = g<sup>a</sup> mod p —ñ –Ω–∞–¥—Å–∏–ª–∞—î A –ë–æ–±—É</li>
                    <li>–ë–æ–± –æ–±–∏—Ä–∞—î –≤–∏–ø–∞–¥–∫–æ–≤–µ —Å–µ–∫—Ä–µ—Ç–Ω–µ —á–∏—Å–ª–æ b, –æ–±—á–∏—Å–ª—é—î B = g<sup>b</sup> mod p —ñ –Ω–∞–¥—Å–∏–ª–∞—î B –ê–ª—ñ—Å—ñ</li>
                    <li>–ê–ª—ñ—Å–∞ –æ–±—á–∏—Å–ª—é—î —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç S = B<sup>a</sup> mod p</li>
                    <li>–ë–æ–± –æ–±—á–∏—Å–ª—é—î —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç S = A<sup>b</sup> mod p</li>
                </ol>
                <p>–û–±–∏–¥–≤–∞ –æ—Ç—Ä–∏–º—É—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è S = g<sup>ab</sup> mod p</p>
                
                <h4>3. –ï–ª—ñ–ø—Ç–∏—á–Ω—ñ –∫—Ä–∏–≤—ñ –≤ —Å—É—á–∞—Å–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞—Ö</h4>
                <div class="info-box">
                    <p><strong>–°—É—á–∞—Å–Ω—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:</strong> –£ —Å—É—á–∞—Å–Ω–∏—Ö –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞—Ö –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –Ω–µ –º–æ–¥—É–ª—å–Ω—É –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫—É –∑—ñ —Å—Ç–µ–ø–µ–Ω—è–º–∏, –∞ –µ–ª—ñ–ø—Ç–∏—á–Ω—ñ –∫—Ä–∏–≤—ñ (ECDH - Elliptic Curve Diffie-Hellman).</p>
                </div>
                <p>–ï–ª—ñ–ø—Ç–∏—á–Ω—ñ –∫—Ä–∏–≤—ñ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ç–æ–π —Å–∞–º–∏–π —Ä—ñ–≤–µ–Ω—å –±–µ–∑–ø–µ–∫–∏ –∑ –Ω–∞–±–∞–≥–∞—Ç–æ –º–µ–Ω—à–∏–º–∏ —Ä–æ–∑–º—ñ—Ä–∞–º–∏ –∫–ª—é—á—ñ–≤:</p>
                <ul>
                    <li>–ë–µ–∑–ø–µ–∫–∞ RSA –∑ 2048-–±—ñ—Ç–Ω–∏–º –∫–ª—é—á–µ–º ‚âà –ë–µ–∑–ø–µ–∫–∞ ECC –∑ 224-–±—ñ—Ç–Ω–∏–º –∫–ª—é—á–µ–º</li>
                    <li>–ú–µ–Ω—à—ñ —Ä–æ–∑–º—ñ—Ä–∏ –∫–ª—é—á—ñ–≤ –æ–∑–Ω–∞—á–∞—é—Ç—å –º–µ–Ω—à–µ –æ–±—á–∏—Å–ª–µ–Ω—å —Ç–∞ –º–µ–Ω—à—É –ø—Ä–æ–ø—É—Å–∫–Ω—É –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å</li>
                    <li>–ï–ª—ñ–ø—Ç–∏—á–Ω—ñ –∫—Ä–∏–≤—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ —Å—É—á–∞—Å–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞—Ö —è–∫ TLS 1.3, Signal —Ç–æ—â–æ</li>
                </ul>
                
                <h4>4. –ß–æ–º—É —Ü–µ –±–µ–∑–ø–µ—á–Ω–æ?</h4>
                <p>–ë–µ–∑–ø–µ–∫—É –ø—Ä–æ—Ç–æ–∫–æ–ª—É –∑–∞–±–µ–∑–ø–µ—á—É—î —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –∑–∞–¥–∞—á—ñ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º—É–≤–∞–Ω–Ω—è. –ù–∞–≤—ñ—Ç—å –∑–Ω–∞—é—á–∏ A, B, g —Ç–∞ p, –≤–∞–∂–∫–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ a –∞–±–æ b, –∞ –æ—Ç–∂–µ, —ñ —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç S.</p>
                
                <h4>5. –ê–∫—Ç–∏–≤–Ω–∞ –∞—Ç–∞–∫–∞ "–ª—é–¥–∏–Ω–∞ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ" (Man-in-the-Middle)</h4>
                <div class="warning-box">
                    <p><strong>–£—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞:</strong> –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ RSA, –ø—Ä–æ—Ç–æ–∫–æ–ª –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞ –Ω–µ –∑–∞–±–µ–∑–ø–µ—á—É—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Å—Ç–æ—Ä—ñ–Ω, —â–æ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ –≤—Ä–∞–∑–ª–∏–≤–∏–º –¥–æ –∞—Ç–∞–∫–∏ "–ª—é–¥–∏–Ω–∞ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ".</p>
                </div>
                <p>–£ —Ü—ñ–π –∞—Ç–∞—Ü—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ú–µ–ª–æ—Ä—ñ –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –º—ñ–∂ –ê–ª—ñ—Å–æ—é —Ç–∞ –ë–æ–±–æ–º:</p>
                <ol>
                    <li>–ú–µ–ª–æ—Ä—ñ –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î A –≤—ñ–¥ –ê–ª—ñ—Å–∏ —ñ –Ω–∞–¥—Å–∏–ª–∞—î –ë–æ–±—É —Å–≤–æ—î M<sub>A</sub></li>
                    <li>–ú–µ–ª–æ—Ä—ñ –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î B –≤—ñ–¥ –ë–æ–±–∞ —ñ –Ω–∞–¥—Å–∏–ª–∞—î –ê–ª—ñ—Å—ñ —Å–≤–æ—î M<sub>B</sub></li>
                    <li>–ê–ª—ñ—Å–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î —Å–ø—ñ–ª—å–Ω–∏–π –∫–ª—é—á –∑ –ú–µ–ª–æ—Ä—ñ: S<sub>AM</sub> = M<sub>B</sub><sup>a</sup> mod p</li>
                    <li>–ë–æ–± –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î —Å–ø—ñ–ª—å–Ω–∏–π –∫–ª—é—á –∑ –ú–µ–ª–æ—Ä—ñ: S<sub>BM</sub> = M<sub>A</sub><sup>b</sup> mod p</li>
                    <li>–ú–µ–ª–æ—Ä—ñ –∑–Ω–∞—î –æ–±–∏–¥–≤–∞ –∫–ª—é—á—ñ —ñ –º–æ–∂–µ —á–∏—Ç–∞—Ç–∏, –º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Ç–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</li>
                </ol>
                <p>–î–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ —Ü—ñ—î—ó –∞—Ç–∞–∫–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ —Ü–∏—Ñ—Ä–æ–≤—ñ –ø—ñ–¥–ø–∏—Å–∏ –∞–±–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏.</p>
                
                <h4>6. –ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏ —Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</h4>
                <p><strong>–ü–µ—Ä–µ–≤–∞–≥–∏:</strong></p>
                <ul>
                    <li>–í–∏—Å–æ–∫–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è/–¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</li>
                    <li>–ú–µ–Ω—à—ñ –≤–∏–º–æ–≥–∏ –¥–æ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤</li>
                    <li>–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó</li>
                </ul>
                <p><strong>–ù–µ–¥–æ–ª—ñ–∫–∏:</strong></p>
                <ul>
                    <li>–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–ø–µ—á–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è –∫–ª—é—á—ñ–≤</li>
                    <li>–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–ª—é—á–∞–º–∏ –≤ –≤–µ–ª–∏–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö</li>
                    <li>–ù–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –∑–º—ñ–Ω–∏ –∫–ª—é—á—ñ–≤ –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—ó</li>
                </ul>
                
                <h4>7. –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö</h4>
                <p>–ü—Ä–æ—Ç–æ–∫–æ–ª –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –±–∞–≥–∞—Ç—å–æ—Ö —Å—É—á–∞—Å–Ω–∏—Ö –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞—Ö:</p>
                <ul>
                    <li>TLS/SSL –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤–µ–±-–∑'—î–¥–Ω–∞–Ω—å</li>
                    <li>IPSec –¥–ª—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏—Ö –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö –º–µ—Ä–µ–∂ (VPN)</li>
                    <li>SSH –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É</li>
                    <li>–ë–∞–≥–∞—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ –æ–±–º—ñ–Ω—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ (Signal, OTR)</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // –ü–æ—Ç–æ—á–Ω–∏–π –∫—Ä–æ–∫
        let currentStep = 1;
        const maxSteps = 2;

        // –ü–æ—Ç–æ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
        let currentP = 23;
        let currentG = 5;
        let currentA = 6;
        let currentB = 15;
        let currentPublicA = 8;
        let currentPublicB = 19;
        let currentSharedSecret = 2;

        // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –ø–æ –∫—Ä–æ–∫–∞—Ö
        function nextStep() {
            if (currentStep < maxSteps) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep++;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateButtons();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep--;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateButtons();
            }
        }

        function updateButtons() {
            document.getElementById('prev-btn').disabled = currentStep === 1;
            document.getElementById('next-btn').textContent = 
                currentStep === maxSteps ? '–ó–∞–≤–µ—Ä—à–∏—Ç–∏' : '–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Üí';
        }

        // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å
        function calculatePublicValues() {
            const p = parseInt(document.getElementById('input-p').value);
            const g = parseInt(document.getElementById('input-g').value);
            
            if (isPrime(p)) {
                currentP = p;
                currentG = g;
                
                // –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤—ñ —Å–µ–∫—Ä–µ—Ç–Ω—ñ —á–∏—Å–ª–∞ (–∞–ª–µ –Ω–µ–≤–µ–ª–∏–∫—ñ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç–∏)
                currentA = Math.floor(Math.random() * 10) + 5;
                currentB = Math.floor(Math.random() * 10) + 10;
                
                // –û–±—á–∏—Å–ª—é—î–º–æ –ø—É–±–ª—ñ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
                currentPublicA = modExp(currentG, currentA, currentP);
                currentPublicB = modExp(currentG, currentB, currentP);
                
                // –û–±—á–∏—Å–ª—é—î–º–æ —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç
                currentSharedSecret = modExp(currentPublicB, currentA, currentP);
                
                updateDisplay();
                document.getElementById('public-alice-result').innerHTML = '‚úÖ –ü—É–±–ª—ñ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –æ–±—á–∏—Å–ª–µ–Ω—ñ!';
                document.getElementById('public-alice-answer').style.display = 'none';
            } else {
                document.getElementById('public-alice-result').innerHTML = '‚ùå p –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ –ø—Ä–æ—Å—Ç–∏–º —á–∏—Å–ª–æ–º!';
            }
        }

        function checkPublicAlice() {
            const userA = parseInt(document.getElementById('input-public-alice').value);
            const correctA = modExp(currentG, currentA, currentP);
            
            if (userA === correctA) {
                document.getElementById('public-alice-result').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! A = ' + correctA;
                document.getElementById('public-alice-answer').style.display = 'none';
            } else {
                document.getElementById('public-alice-result').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';
                document.getElementById('public-alice-answer').style.display = 'block';
                document.getElementById('correct-public-alice').textContent = correctA;
            }
        }

        function checkSharedSecret() {
            const userS = parseInt(document.getElementById('input-shared-secret').value);
            const correctS = modExp(currentPublicB, currentA, currentP);
            
            if (userS === correctS) {
                document.getElementById('shared-secret-result').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! S = ' + correctS;
                document.getElementById('shared-secret-answer').style.display = 'none';
            } else {
                document.getElementById('shared-secret-result').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';
                document.getElementById('shared-secret-answer').style.display = 'block';
                document.getElementById('correct-shared-secret').textContent = correctS;
            }
        }

        // –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
        function isPrime(num) {
            if (num <= 1) return false;
            if (num <= 3) return true;
            if (num % 2 === 0 || num % 3 === 0) return false;
            for (let i = 5; i * i <= num; i += 6) {
                if (num % i === 0 || num % (i + 2) === 0) return false;
            }
            return true;
        }

        function modExp(base, exponent, modulus) {
            if (modulus === 1) return 0;
            let result = 1;
            base = base % modulus;
            while (exponent > 0) {
                if (exponent % 2 === 1) {
                    result = (result * base) % modulus;
                }
                exponent = Math.floor(exponent / 2);
                base = (base * base) % modulus;
            }
            return result;
        }

        function updateDisplay() {
            document.getElementById('p-value').textContent = currentP;
            document.getElementById('g-value').textContent = currentG;
            document.getElementById('a-value').textContent = currentA;
            document.getElementById('b-value').textContent = currentB;
            document.getElementById('public-alice').textContent = currentPublicA;
            document.getElementById('public-bob').textContent = currentPublicB;
            document.getElementById('shared-key').textContent = currentSharedSecret;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è
            document.getElementById('task-g').textContent = currentG;
            document.getElementById('task-a').textContent = currentA;
            document.getElementById('task-p').textContent = currentP;
            document.getElementById('task-b-value').textContent = currentPublicB;
            document.getElementById('task-a2').textContent = currentA;
            document.getElementById('task-p2').textContent = currentP;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –∫–ª—é—á—ñ –Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
            document.getElementById('alice-secret-value').textContent = currentA;
            document.getElementById('alice-public-value').textContent = currentPublicA;
            document.getElementById('bob-secret-value').textContent = currentB;
            document.getElementById('bob-public-value').textContent = currentPublicB;
            document.getElementById('display-a').textContent = currentPublicA;
            document.getElementById('display-b').textContent = currentPublicB;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∏–∫–ª–∞–¥–∏ –æ–±—á–∏—Å–ª–µ–Ω—å
            document.getElementById('alice-calculation').innerHTML = 
                `${currentPublicB}<sup>${currentA}</sup> mod ${currentP} = ${currentSharedSecret}`;
            document.getElementById('bob-calculation').innerHTML = 
                `${currentPublicA}<sup>${currentB}</sup> mod ${currentP} = ${currentSharedSecret}`;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –∫–æ–ª—å–æ—Ä—ñ–≤ –¥–ª—è –∞–Ω–∞–ª–æ–≥—ñ—ó
        function generateNewColors() {
            const baseColor = generateColor();
            const aliceSecretColor = generateColor();
            const bobSecretColor = generateColor();
            
            // –û–±—á–∏—Å–ª—é—î–º–æ –ø—Ä–æ–º—ñ–∂–Ω—ñ –∫–æ–ª—å–æ—Ä–∏ (—Å—É–º—ñ—à—ñ)
            const alicePublicColor = mixColors(baseColor, aliceSecretColor);
            const bobPublicColor = mixColors(baseColor, bobSecretColor);
            
            // –û–±—á–∏—Å–ª—é—î–º–æ —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç (—Ñ—ñ–Ω–∞–ª—å–Ω–∏–π –∫–æ–ª—ñ—Ä)
            const sharedColor = mixColors(alicePublicColor, bobSecretColor);
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é
            updateColorDisplay('base-color', baseColor);
            updateColorDisplay('alice-secret-color', aliceSecretColor);
            updateColorDisplay('bob-secret-color', bobSecretColor);
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –±–∞–Ω–∫–∏ —Ñ–∞—Ä–±–∏
            updatePaintCan('alice-base', baseColor, 60);
            updatePaintCan('alice-secret', aliceSecretColor, 40);
            updatePaintCan('alice-public', alicePublicColor, 70);
            updatePaintCan('bob-base', baseColor, 60);
            updatePaintCan('bob-secret', bobSecretColor, 40);
            updatePaintCan('bob-public', bobPublicColor, 70);
            updatePaintCan('alice-received', bobPublicColor, 70);
            updatePaintCan('alice-secret2', aliceSecretColor, 40);
            updatePaintCan('alice-shared', sharedColor, 100);
            updatePaintCan('bob-received', alicePublicColor, 70);
            updatePaintCan('bob-secret2', bobSecretColor, 40);
            updatePaintCan('bob-shared', sharedColor, 100);
        }

        function generateColor() {
            return {
                r: Math.floor(Math.random() * 206) + 50,
                g: Math.floor(Math.random() * 206) + 50,
                b: Math.floor(Math.random() * 206) + 50
            };
        }

        function mixColors(color1, color2) {
            // –ü—Ä–æ—Å—Ç–µ –∑–º—ñ—à—É–≤–∞–Ω–Ω—è –∫–æ–ª—å–æ—Ä—ñ–≤ (—Å–µ—Ä–µ–¥–Ω—î –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ)
            return {
                r: Math.floor((color1.r + color2.r) / 2),
                g: Math.floor((color1.g + color2.g) / 2),
                b: Math.floor((color1.b + color2.b) / 2)
            };
        }

        function updateColorDisplay(elementId, color) {
            const element = document.getElementById(elementId);
            element.style.backgroundColor = `rgb(${color.r}, ${color.g}, ${color.b})`;
        }

        function updatePaintCan(elementId, color, height) {
            const element = document.getElementById(elementId);
            element.style.backgroundColor = `rgb(${color.r}, ${color.g}, ${color.b})`;
            element.style.height = `${height}%`;
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            updateButtons();
            updateDisplay();
            generateNewColors();
        });
    </script>
</body>
</html>