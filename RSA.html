<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–ª–≥–æ—Ä–∏—Ç–º RSA</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .step {
            display: none;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin-bottom: 15px;
            background-color: #f8f9fa;
        }
        .step.active {
            display: block;
        }
        .step-number {
            display: inline-block;
            background-color: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
        }
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .visualization {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            padding: 15px;
            background-color: #ecf0f1;
            border-radius: 8px;
        }
        .person {
            text-align: center;
            font-size: 40px;
        }
        .person-name {
            margin-top: 10px;
            font-weight: bold;
        }
        .person-keys {
            margin-top: 10px;
            font-size: 14px;
            background-color: #fff;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .message-box {
            background-color: #fff;
            border: 2px dashed #3498db;
            padding: 15px;
            border-radius: 8px;
            min-width: 200px;
            text-align: center;
        }
        .formula {
            font-family: 'Courier New', monospace;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 3px solid #3498db;
            font-style: italic;
        }
        .key-display {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
        }
        .key {
            background-color: #e8f4fc;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #3498db;
            text-align: center;
            min-width: 150px;
        }
        .calculation {
            background-color: #fff;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #ddd;
        }
        .tab-container {
            display: flex;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background-color: #ecf0f1;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tab.active {
            background-color: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .emoji {
            font-size: 24px;
            margin-right: 10px;
        }
        .info-box {
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        .warning-box {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }
        .details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .spoiler {
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 15px 0;
        }
        .spoiler summary {
            padding: 10px 15px;
            background-color: #e9ecef;
            cursor: pointer;
            font-weight: bold;
        }
        .spoiler-content {
            padding: 15px;
            border-top: 1px solid #ccc;
        }
        .hash-box {
            background-color: #fff;
            border: 2px solid #e74c3c;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
        .analogy {
            background-color: #fff;
            border: 2px solid #9b59b6;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .analogy-title {
            color: #9b59b6;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .lock-visual {
            font-size: 30px;
            text-align: center;
            margin: 10px 0;
        }
        .input-group {
            margin: 10px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100px;
        }
        .interactive-task {
            background-color: #e8f6ff;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        .task-button {
            background-color: #2ecc71;
            margin-top: 10px;
        }
        .task-button:hover {
            background-color: #27ae60;
        }
        .result {
            font-weight: bold;
            color: #2c3e50;
            margin-top: 10px;
        }
        .answer-spoiler {
            margin-top: 10px;
        }
        .correct-answer {
            color: #27ae60;
            font-weight: bold;
        }
        .euclid-explanation {
            background-color: #fff;
            border: 2px solid #e67e22;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .euclid-title {
            color: #e67e22;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>–ê–ª–≥–æ—Ä–∏—Ç–º RSA</h1>
    <p>–¶–µ–π —Å–∏–º—É–ª—è—Ç–æ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É RSA –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø—ñ–¥–ø–∏—Å—É.</p>

    <div class="analogy">
        <div class="analogy-title">üîê –ê–Ω–∞–ª–æ–≥—ñ—è –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</div>
        
        <h4>–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (–ë–æ–± –æ—Ç—Ä–∏–º—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è):</h4>
        <div class="lock-visual">üë¶ ‚Üí  üîì(–ø—É–±–ª—ñ—á–Ω–∏–π) ‚Üí üëß</div> 
		<div class="lock-visual"> üëß ‚Üí üìßüîí ‚Üí üë¶ üîë(–ø—Ä–∏–≤–∞—Ç–Ω–∏–π) ‚Üíüìß üë¶üóÅ</div>
        <ul>
            <li><strong>–ë–æ–± —Ä–æ–∑–¥–∞—î –≤—Å—ñ–º –ó–ê–ú–ö–ò</strong> (public key) - –∫–æ–∂–µ–Ω –º–æ–∂–µ –∑–∞–∫—Ä–∏—Ç–∏, –ø—Ä–æ—Å—Ç–æ –∑–∞–∫–ª–∞—Ü–Ω—É—Ç–∏ —â–æ—Å—å –Ω–∞ –∑–∞–º–æ–∫ </li>
            <li><strong>–¢—ñ–ª—å–∫–∏ –ë–æ–± –º–∞—î –ö–õ–Æ–ß</strong> (private key) - —Ç—ñ–ª—å–∫–∏ –≤—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏</li>
            <li>–ê–ª—ñ—Å–∞ –∑–∞–º–∏–∫–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞–º–∫–æ–º –ë–æ–±–∞ —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –π–æ–º—É</li>
            <li>–¢—ñ–ª—å–∫–∏ –ë–æ–± –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ü–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Å–≤–æ—ó–º –∫–ª—é—á–µ–º</li>
			<li>–ú–∞—é—á–∏ –∑–∞–º–æ–∫, –Ω–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–≥–æ—Ç–æ–≤–∏—Ç–∏ –∫–ª—é—á</li>
        </ul>
        
        <h4>–¶–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å (–ê–ª—ñ—Å–∞ –ø—ñ–¥–ø–∏—Å—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è):</h4>
        <div class="lock-visual">üëß üîè(–ø—Ä–∏–≤–∞—Ç–Ω–∏–π) ‚Üí üîë(–ø—É–±–ª—ñ—á–Ω–∏–π)üë¶</div>
		<div class="lock-visual">üëß‚úç ‚Üí üìßüîÄüîè ‚Üí üë¶üîë ‚Üí üîÄüîìüëå </div>
        <ul>
            <li><strong>–ê–ª—ñ—Å–∞ —Ä–æ–∑–¥–∞—î –≤—Å—ñ–º –ö–õ–Æ–ß–Ü</strong> (public key) - –∫–æ–∂–µ–Ω –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏</li>
            <li><strong>–¢—ñ–ª—å–∫–∏ –ê–ª—ñ—Å–∞ –º–∞—î –ó–ê–ú–û–ö</strong> (private key) - —Ç—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –º–æ–∂–µ –∑–∞–∫—Ä–∏—Ç–∏</li>
            <li>–ê–ª—ñ—Å–∞ –∑–∞–º–∏–∫–∞—î –•–ï–® –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å—É–º—É –∫–æ–¥—ñ–≤ –±—É–∫–≤) —Å–≤–æ—ó–º –∑–∞–º–∫–æ–º —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î</li>
            <li>–ë–æ–± –≤—ñ–¥–∫—Ä–∏–≤–∞—î –•–ï–® –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–∏–º –∫–ª—é—á–µ–º –ê–ª—ñ—Å–∏ —ñ –ø–µ—Ä–µ–∫–æ–Ω—É—î—Ç—å—Å—è, —â–æ –≤–æ–Ω–æ –≤—ñ–¥ –Ω–µ—ó (—ñ –Ω–µ –±—É–ª–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–µ), –±–æ —Ç—ñ–ª—å–∫–∏ –≤ –Ω–µ—ó —î —Ç–∞–∫–∏–π –∑–∞–º–æ–∫</li>
			<li>–ú–∞—é—á–∏ –∫–ª—é—á, –Ω–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–≥–æ—Ç–æ–≤–∏—Ç–∏ –∑–∞–º–æ–∫</li>
        </ul>
    </div>

    <div class="tab-container">
        <div class="tab active" onclick="switchTab('encryption')">üîê –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</div>
        <div class="tab" onclick="switchTab('signature')">üìù –¶–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å</div>
    </div>

    <!-- –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è -->
    <div id="encryption" class="tab-content active">
        <div class="container">
            <h2>üîê –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</h2>
            <p>–ê–ª—ñ—Å–∞ —Ö–æ—á–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ë–æ–±—É —Å–µ–∫—Ä–µ—Ç–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –í–æ–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ë–æ–±–∞ –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.</p>
            
            <div class="visualization">
                <div class="person">
                    <div>üëß</div>
                    <div class="person-name">–ê–ª—ñ—Å–∞</div>
                    <div class="person-keys">
                        <div>üîì –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ë–æ–±–∞:</div>
                        <div>(e, n) = (<span id="alice-public-e">3</span>, <span id="alice-public-n">33</span>)</div>
                    </div>
                </div>
                <div class="message-box" id="encryption-message">
                    <div>‚úâÔ∏è</div>
                    <div id="original-message">–ü—Ä–∏–≤—ñ—Ç, –ë–æ–±–µ!</div>
                </div>
                <div class="person">
                    <div>üë¶</div>
                    <div class="person-name">–ë–æ–±</div>
                    <div class="person-keys">
                        <div>üîí –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:</div>
                        <div>(e, n) = (<span id="bob-public-e">3</span>, <span id="bob-public-n">33</span>)</div>
                        <div>üîë –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á:</div>
                        <div>(d, n) = (<span id="bob-private-d">7</span>, <span id="bob-private-n">33</span>)</div>
                    </div>
                </div>
            </div>

            <div class="step active" id="step1-enc">
                <h3><span class="step-number">1</span> –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤</h3>
                <p>–ë–æ–± –≥–µ–Ω–µ—Ä—É—î –ø–∞—Ä—É –∫–ª—é—á—ñ–≤: –ø—É–±–ª—ñ—á–Ω–∏–π (public) —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π (private).</p>
                
                <div class="input-group">
                    <label>–í–≤–µ–¥—ñ—Ç—å –ø—Ä–æ—Å—Ç—ñ —á–∏—Å–ª–∞ p —Ç–∞ q (–º–∞–ª—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 3 —ñ 11):</label>
                    <input type="number" id="input-p" placeholder="p" value="3" min="2" max="97">
                    <input type="number" id="input-q" placeholder="q" value="11" min="2" max="97">
                    <button onclick="calculateKeys()" class="task-button">–û–±—á–∏—Å–ª–∏—Ç–∏ –∫–ª—é—á—ñ</button>
                </div>
                
                <div class="info-box">
                    <p><strong>–ö—Ä–æ–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á—ñ–≤:</strong></p>
                    <ol>
                        <li>–í–∏–±–∏—Ä–∞—î–º–æ –¥–≤–∞ –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–ª–∞: p = <span id="p-value">3</span>, q = <span id="q-value">11</span></li>
                        <li>–û–±—á–∏—Å–ª—é—î–º–æ <span class="formula">n = p √ó q = <span id="n-value">33</span></span></li>
                        <li>–û–±—á–∏—Å–ª—é—î–º–æ <span class="formula">œÜ(n) = (p-1) √ó (q-1) = <span id="phi-value">20</span></span></li>
                        <li>–í–∏–±–∏—Ä–∞—î–º–æ e —Ç–∞–∫–µ, —â–æ 1 < e < œÜ(n) —ñ –ù–°–î(e, œÜ(n)) = 1: e = <span id="e-value">3</span></li>
                        <li>–û–±—á–∏—Å–ª—é—î–º–æ d —Ç–∞–∫–µ, —â–æ <span class="formula">d √ó e ‚â° 1 mod œÜ(n)</span>: d = <span id="d-value">7</span></li>
                    </ol>
                </div>
                
                <div class="interactive-task">
                    <p><strong>–°–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ:</strong> –ó–Ω–∞–π–¥—ñ—Ç—å d –¥–ª—è e=<span id="task-e">3</span>, œÜ(n)=<span id="task-phi">20</span></p>
                    <p><em>–ü—ñ–¥–∫–∞–∑–∫–∞: d √ó <span id="hint-e">3</span> –ø–æ–≤–∏–Ω–Ω–æ –¥–∞–≤–∞—Ç–∏ –æ—Å—Ç–∞—á—É 1 –ø—Ä–∏ –¥—ñ–ª–µ–Ω–Ω—ñ –Ω–∞ <span id="hint-phi">20</span></em></p>
                    <div class="input-group">
                        <input type="number" id="input-d" placeholder="d">
                        <button onclick="checkD()" class="task-button">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ d</button>
                    </div>
                    <div id="d-result" class="result"></div>
                    <div class="answer-spoiler" id="d-answer" style="display: none;">
                        <details>
                            <summary>–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>
                            <p class="correct-answer">d = <span id="correct-d">7</span></p>
                            <p>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: <span class="formula"><span id="check-e">3</span> √ó <span id="check-d">7</span> = <span id="check-product">21</span> ‚â° 1 mod <span id="check-phi">20</span></span></p>
                            <p><em>–ü—Ä–∏–º—ñ—Ç–∫–∞: –¢–∞–∫–æ–∂ –ø—ñ–¥—Ö–æ–¥—è—Ç—å d=27, d=47, d=67 —Ç–æ—â–æ</em></p>
                        </details>
                    </div>
                </div>
                
                <div class="key-display">
                    <div class="key">
                        <h4>  üîì  –ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ë–æ–±–∞</h4>
                        <p>(e, n) = (<span id="public-e">3</span>, <span id="public-n">33</span>)</p>
                    </div>
                    <div class="key">
                        <h4>üîë –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á –ë–æ–±–∞</h4>
                        <p>(d, n) = (<span id="private-d">7</span>, <span id="private-n">33</span>)</p>
                    </div>
                </div>
                
                <p>–ë–æ–± –ø—É–±–ª—ñ–∫—É—î —Å–≤—ñ–π –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á, —â–æ–± –ê–ª—ñ—Å–∞ –º–æ–≥–ª–∞ –∑–∞—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.</p>
            </div>

            <div class="step" id="step2-enc">
                <h3><span class="step-number">2</span> –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ —á–∏—Å–ª–∞</h3>
                <p>–ê–ª—ñ—Å–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î —Å–≤–æ—î —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ —á–∏—Å–ª–æ–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è.</p>
                
                <div class="calculation">
                    <p><strong>–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:</strong> "–ü—Ä–∏–≤—ñ—Ç, –ë–æ–±–µ!"</p>
                    <p>–ö–æ–∂–Ω–∞ –ª—ñ—Ç–µ—Ä–∞ –∑–∞–º—ñ–Ω—é—î—Ç—å—Å—è –Ω–∞ —ó—ó –ø–æ–∑–∏—Ü—ñ—é –≤ –∞–ª—Ñ–∞–≤—ñ—Ç—ñ:</p>
                    <p>–ü(17) —Ä(18) –∏(10) –≤(3) —ñ(9) —Ç(20) ,(0) –ë(2) –æ(16) –±(2) –µ(6) !(0)</p>
                    <p>–ß–∏—Å–ª–æ–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è: <strong id="numeric-message">17 18 10 3 9 20 0 2 16 2 6 0</strong></p>
                </div>
            </div>

            <div class="step" id="step3-enc">
                <h3><span class="step-number">3</span> –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</h3>
                <p>–ê–ª—ñ—Å–∞ —à–∏—Ñ—Ä—É—î –∫–æ–∂–Ω–µ —á–∏—Å–ª–æ m –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é: <span class="formula">c = m<sup>e</sup> mod n</span></p>
                
                <div class="interactive-task">
                    <p><strong>–°–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ:</strong> –ó–∞—à–∏—Ñ—Ä—É–π—Ç–µ —á–∏—Å–ª–æ 17 –∑ e=<span id="encrypt-e">3</span>, n=<span id="encrypt-n">33</span></p>
                    <div class="input-group">
                        <input type="number" id="input-encrypt" placeholder="–†–µ–∑—É–ª—å—Ç–∞—Ç">
                        <button onclick="checkEncryption()" class="task-button">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
                    </div>
                    <div id="encrypt-result" class="result"></div>
                    <div class="answer-spoiler" id="encrypt-answer" style="display: none;">
                        <details>
                            <summary>–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>
                            <p class="correct-answer">17<sup><span id="correct-encrypt-e">3</span></sup> mod <span id="correct-encrypt-n">33</span> = <span id="correct-encrypt">29</span></p>
                            <p>–û–±—á–∏—Å–ª–µ–Ω–Ω—è: 17<sup><span id="calc-encrypt-e">3</span></sup> = <span id="calc-encrypt-power">4913</span>, <span id="calc-encrypt-power">4913</span> √∑ <span id="calc-encrypt-n">33</span> = <span id="calc-encrypt-div">148</span> –∑–∞–ª–∏—à–æ–∫ <span id="calc-encrypt-mod">29</span></p>
                        </details>
                    </div>
                </div>
                
                <div class="calculation">
                    <p>–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ë–æ–±–∞ (e=<span id="calc-e">3</span>, n=<span id="calc-n">33</span>):</p>
                    <p><span class="formula" id="encryption-example1">17<sup>3</sup> mod 33 = 4913 mod 33 = 29</span></p>
                    <p><span class="formula" id="encryption-example2">18<sup>3</sup> mod 33 = 5832 mod 33 = 24</span></p>
                    <p><span class="formula" id="encryption-example3">10<sup>3</sup> mod 33 = 1000 mod 33 = 10</span></p>
                    <p>...</p>
                    <p>–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: <strong id="encrypted-message">29 24 10 27 3 14 0 8 4 8 18 0</strong></p>
                </div>
                
                <div class="visualization">
                    <div class="person">
                        <div>üëß</div>
                        <div class="person-name">–ê–ª—ñ—Å–∞</div>
                        <div class="person-keys">
                            <div> üîí –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ë–æ–±–∞:</div>
                            <div>(e, n) = (<span id="alice-public-e2">3</span>, <span id="alice-public-n2">33</span>)</div>
                        </div>
                    </div>
                    <div class="message-box">
                        <div>üîí</div>
                        <div id="encrypted-visual">29 24 10 27 3 14 0 8 4 8 18 0</div>
                    </div>
                    <div class="person">
                        <div>üë¶</div>
                        <div class="person-name">–ë–æ–±</div>
                        <div class="person-keys">
                            <div>üîí –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:</div>
                            <div>(e, n) = (<span id="bob-public-e2">3</span>, <span id="bob-public-n2">33</span>)</div>
                            <div> üîë –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á:</div>
                            <div>(d, n) = (<span id="bob-private-d2">7</span>, <span id="bob-private-n2">33</span>)</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="step" id="step4-enc">
                <h3><span class="step-number">4</span> –î–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</h3>
                <p>–ë–æ–± –æ—Ç—Ä–∏–º—É—î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —ñ –¥–µ—à–∏—Ñ—Ä—É—î –π–æ–≥–æ –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é: <span class="formula">m = c<sup>d</sup> mod n</span></p>
                
                <div class="interactive-task">
                    <p><strong>–°–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ:</strong> –†–æ–∑—à–∏—Ñ—Ä—É–π—Ç–µ —á–∏—Å–ª–æ 29 –∑ d=<span id="decrypt-d">7</span>, n=<span id="decrypt-n">33</span></p>
                    <div class="input-group">
                        <input type="number" id="input-decrypt" placeholder="–†–µ–∑—É–ª—å—Ç–∞—Ç">
                        <button onclick="checkDecryption()" class="task-button">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
                    </div>
                    <div id="decrypt-result" class="result"></div>
                    <div class="answer-spoiler" id="decrypt-answer" style="display: none;">
                        <details>
                            <summary>–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>
                            <p class="correct-answer">29<sup><span id="correct-decrypt-d">7</span></sup> mod <span id="correct-decrypt-n">33</span> = <span id="correct-decrypt">17</span></p>
                            <p>–û–±—á–∏—Å–ª–µ–Ω–Ω—è: 29<sup><span id="calc-decrypt-d">7</span></sup> = <span id="calc-decrypt-power">17249876309</span>, <span id="calc-decrypt-power">17249876309</span> √∑ <span id="calc-decrypt-n">33</span> = <span id="calc-decrypt-div">522723524</span> –∑–∞–ª–∏—à–æ–∫ <span id="calc-decrypt-mod">17</span></p>
                        </details>
                    </div>
                </div>
                
                <div class="calculation">
                    <p>–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–≤—ñ–π –ø—Ä–∏–≤–∞—Ç–Ω–∏–π  –∫–ª—é—á (d=<span id="calc-d">7</span>, n=<span id="calc-n2">33</span>):</p>
                    <p><span class="formula" id="decryption-example1">29<sup>7</sup> mod 33 = 17249876309 mod 33 = 17</span></p>
                    <p><span class="formula" id="decryption-example2">24<sup>7</sup> mod 33 = 4586471424 mod 33 = 18</span></p>
                    <p><span class="formula" id="decryption-example3">10<sup>7</sup> mod 33 = 10000000 mod 33 = 10</span></p>
                    <p>...</p>
                    <p>–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: <strong id="decrypted-numeric">17 18 10 3 9 20 0 2 16 2 6 0</strong></p>
                    <p>–ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –Ω–∞–∑–∞–¥ —É —Ç–µ–∫—Å—Ç: <strong id="decrypted-text">–ü—Ä–∏–≤—ñ—Ç, –ë–æ–±–µ!</strong></p>
                </div>
                
                <div class="visualization">
                    <div class="person">
                        <div>üëß</div>
                        <div class="person-name">–ê–ª—ñ—Å–∞</div>
                        <div class="person-keys">
                            <div>üîí –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ë–æ–±–∞:</div>
                            <div>(e, n) = (<span id="alice-public-e3">3</span>, <span id="alice-public-n3">33</span>)</div>
                        </div>
                    </div>
                    <div class="message-box">
                        <div>‚úâÔ∏è</div>
                        <div id="decrypted-visual">–ü—Ä–∏–≤—ñ—Ç, –ë–æ–±–µ!</div>
                    </div>
                    <div class="person">
                        <div>üë¶</div>
                        <div class="person-name">–ë–æ–±</div>
                        <div class="person-keys">
                            <div>üîí –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:</div>
                            <div>(e, n) = (<span id="bob-public-e3">3</span>, <span id="bob-public-n3">33</span>)</div>
                            <div>üîë –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á:</div>
                            <div>(d, n) = (<span id="bob-private-d3">7</span>, <span id="bob-private-n3">33</span>)</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button id="prev-btn-enc" onclick="prevStep('enc')" disabled>‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫—Ä–æ–∫</button>
                <button id="next-btn-enc" onclick="nextStep('enc')">–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- –¶–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å -->
    <div id="signature" class="tab-content">
        <div class="container">
            <h2>üìù –¶–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å</h2>
            <p>–ê–ª—ñ—Å–∞ —Ö–æ—á–µ –ø—ñ–¥–ø–∏—Å–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —â–æ–± –ë–æ–± –º—ñ–≥ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –≤–æ–Ω–æ –¥—ñ–π—Å–Ω–æ –≤—ñ–¥ –Ω–µ—ó.</p>
            
            <div class="visualization">
                <div class="person">
                    <div>üëß</div>
                    <div class="person-name">–ê–ª—ñ—Å–∞</div>
                    <div class="person-keys">
                        <div>üîë –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:</div>
                        <div>(e, n) = (<span id="alice-sig-public-e">3</span>, <span id="alice-sig-public-n">55</span>)</div>
                        <div>üîè –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á:</div>
                        <div>(d, n) = (<span id="alice-sig-private-d">27</span>, <span id="alice-sig-private-n">55</span>)</div>
                    </div>
                </div>
                <div class="message-box" id="signature-message">
                    <div>‚úâÔ∏è</div>
                    <div id="signed-original">–í–∞–∂–ª–∏–≤—ñ –¥–∞–Ω—ñ</div>
                </div>
                <div class="person">
                    <div>üë¶</div>
                    <div class="person-name">–ë–æ–±</div>
                    <div class="person-keys">
                        <div>üîë –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ê–ª—ñ—Å–∏:</div>
                        <div>(e, n) = (<span id="bob-sig-public-e">3</span>, <span id="bob-sig-public-n">55</span>)</div>
                    </div>
                </div>
            </div>

            <div class="step active" id="step1-sig">
                <h3><span class="step-number">1</span> –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤</h3>
                <p>–ê–ª—ñ—Å–∞ –≥–µ–Ω–µ—Ä—É—î –ø–∞—Ä—É –∫–ª—é—á—ñ–≤: –ø—É–±–ª—ñ—á–Ω–∏–π (public) —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π  (private).</p>
                
                <div class="input-group">
                    <label>–í–≤–µ–¥—ñ—Ç—å –ø—Ä–æ—Å—Ç—ñ —á–∏—Å–ª–∞ p —Ç–∞ q (–º–∞–ª—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 5 —ñ 11):</label>
                    <input type="number" id="input-p-sig" placeholder="p" value="5" min="2" max="97">
                    <input type="number" id="input-q-sig" placeholder="q" value="11" min="2" max="97">
                    <button onclick="calculateKeysSig()" class="task-button">–û–±—á–∏—Å–ª–∏—Ç–∏ –∫–ª—é—á—ñ</button>
                </div>
                
                <div class="info-box">
                    <p><strong>–ö—Ä–æ–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á—ñ–≤:</strong></p>
                    <ol>
                        <li>–í–∏–±–∏—Ä–∞—î–º–æ –¥–≤–∞ –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–ª–∞: p = <span id="p-sig">5</span>, q = <span id="q-sig">11</span></li>
                        <li>–û–±—á–∏—Å–ª—é—î–º–æ <span class="formula">n = p √ó q = <span id="n-sig">55</span></span></li>
                        <li>–û–±—á–∏—Å–ª—é—î–º–æ <span class="formula">œÜ(n) = (p-1) √ó (q-1) = <span id="phi-sig">40</span></span></li>
                        <li>–í–∏–±–∏—Ä–∞—î–º–æ e —Ç–∞–∫–µ, —â–æ 1 < e < œÜ(n) —ñ –ù–°–î(e, œÜ(n)) = 1: e = <span id="e-sig">3</span></li>
                        <li>–û–±—á–∏—Å–ª—é—î–º–æ d —Ç–∞–∫–µ, —â–æ <span class="formula">d √ó e ‚â° 1 mod œÜ(n)</span>: d = <span id="d-sig">27</span></li>
                    </ol>
                </div>
                
                <div class="interactive-task">
                    <p><strong>–°–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ:</strong> –ó–Ω–∞–π–¥—ñ—Ç—å d –¥–ª—è e=<span id="task-e-sig">3</span>, œÜ(n)=<span id="task-phi-sig">40</span></p>
                    <p><em>–ü—ñ–¥–∫–∞–∑–∫–∞: d √ó <span id="hint-e-sig">3</span> –ø–æ–≤–∏–Ω–Ω–æ –¥–∞–≤–∞—Ç–∏ –æ—Å—Ç–∞—á—É 1 –ø—Ä–∏ –¥—ñ–ª–µ–Ω–Ω—ñ –Ω–∞ <span id="hint-phi-sig">40</span></em></p>
                    <div class="input-group">
                        <input type="number" id="input-d-sig" placeholder="d">
                        <button onclick="checkDSig()" class="task-button">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ d</button>
                    </div>
                    <div id="d-result-sig" class="result"></div>
                    <div class="answer-spoiler" id="d-answer-sig" style="display: none;">
                        <details>
                            <summary>–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>
                            <p class="correct-answer">d = <span id="correct-d-sig">27</span></p>
                            <p>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: <span class="formula"><span id="check-e-sig">3</span> √ó <span id="check-d-sig">27</span> = <span id="check-product-sig">81</span> ‚â° 1 mod <span id="check-phi-sig">40</span></span></p>
                            <p><em>–ü—Ä–∏–º—ñ—Ç–∫–∞: –¢–∞–∫–æ–∂ –ø—ñ–¥—Ö–æ–¥—è—Ç—å d=67, d=107, d=147 —Ç–æ—â–æ</em></p>
                        </details>
                    </div>
                </div>
                
                <div class="key-display">
                    <div class="key">
                        <h4>üîë –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ê–ª—ñ—Å–∏</h4>
                        <p>(e, n) = (<span id="public-e-sig">3</span>, <span id="public-n-sig">55</span>)</p>
                    </div>
                    <div class="key">
                        <h4>üîí –ø—Ä–∏–≤–∞—Ç–Ω–∏–π  –∫–ª—é—á –ê–ª—ñ—Å–∏</h4>
                        <p>(d, n) = (<span id="private-d-sig">27</span>, <span id="private-n-sig">55</span>)</p>
                    </div>
                </div>
                
                <p>–ê–ª—ñ—Å–∞ –ø—É–±–ª—ñ–∫—É—î —Å–≤—ñ–π –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á, —â–æ–± –ë–æ–± –º—ñ–≥ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ó—ó –ø—ñ–¥–ø–∏—Å.</p>
            </div>

            <div class="step" id="step2-sig">
                <h3><span class="step-number">2</span> –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ö–µ—à—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</h3>
                <p>–ê–ª—ñ—Å–∞ –æ–±—á–∏—Å–ª—é—î —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–Ω—è —Å–≤–æ–≥–æ –ø–æ–≤—ñ–¥om–ª–µ–Ω–Ω—è. –•–µ—à-—Ñ—É–Ω–∫—Ü—ñ—è –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥—å-—è–∫–æ—ó –¥–æ–≤–∂–∏–Ω–∏ —É —Ñ—ñ–∫—Å–æ–≤–∞–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –±—ñ—Ç—ñ–≤.</p>
                
                <div class="warning-box">
                    <p><strong>–£–≤–∞–≥–∞!</strong> –£ —Ä–µ–∞–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Å–∫–ª–∞–¥–Ω—ñ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ —Ö–µ—à-—Ñ—É–Ω–∫—Ü—ñ—ó (SHA-256, SHA-3 —Ç–æ—â–æ). –î–ª—è —Å–ø—Ä–æ—â–µ–Ω–Ω—è –≤ —Ü—å–æ–º—É —Å–∏–º—É–ª—è—Ç–æ—Ä—ñ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø—Ä–æ—Å—Ç—É —Ñ—É–Ω–∫—Ü—ñ—é.</p>
                </div>
                
                <div class="calculation">
                    <p><strong>–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:</strong> "–í–∞–∂–ª–∏–≤—ñ –¥–∞–Ω—ñ"</p>
                    <p>–ö–æ–∂–Ω–∞ –ª—ñ—Ç–µ—Ä–∞ –∑–∞–º—ñ–Ω—é—î—Ç—å—Å—è –Ω–∞ —ó—ó –ø–æ–∑–∏—Ü—ñ—é –≤ –∞–ª—Ñ–∞–≤—ñ—Ç—ñ:</p>
                    <p>–í(3) –∞(1) –∂(8) –ª(13) –∏(10) –≤(3) —ñ(9) –¥(5) –∞(1) –Ω(15) —ñ(9)</p>
                    <p>–ß–∏—Å–ª–æ–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è: <strong>3 1 8 13 10 3 9 5 1 15 9</strong></p>
                    <p>–ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –ø—Ä–æ—Å—Ç—É —Ö–µ—à-—Ñ—É–Ω–∫—Ü—ñ—é: —Å—É–º–∞ –≤—Å—ñ—Ö —á–∏—Å–µ–ª mod 20</p>
                    <p>3+1+8+13+10+3+9+5+1+15+9 = 77</p>
                    <p><span class="formula">77 mod 20 = 17</span></p>
                </div>
                
                <div class="hash-box">
                    <strong>–•–µ—à –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: 17</strong>
                </div>
                
                <p>–•–µ—à-—Ñ—É–Ω–∫—Ü—ñ—è –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ –Ω–∞–≤—ñ—Ç—å –Ω–µ–∑–Ω–∞—á–Ω–∞ –∑–º—ñ–Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –∑–º—ñ–Ω–∏ —Ö–µ—à—É, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏—è–≤–∏—Ç–∏ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.</p>
            </div>

            <div class="step" id="step3-sig">
                <h3><span class="step-number">3</span> –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å—É</h3>
                <p>–ê–ª—ñ—Å–∞ —Å—Ç–≤–æ—Ä—é—î —Ü–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å –¥–ª—è —Ö–µ—à—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è h –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é: <span class="formula">s = h<sup>d</sup> mod n</span></p>
                
                <div class="interactive-task">
                    <p><strong>–°–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ:</strong> –ü—ñ–¥–ø–∏—à—ñ—Ç—å —Ö–µ—à 17 –∑ d=<span id="sign-d">27</span>, n=<span id="sign-n">55</span></p>
                    <div class="input-group">
                        <input type="number" id="input-sign" placeholder="–ü—ñ–¥–ø–∏—Å">
                        <button onclick="checkSignature()" class="task-button">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
                    </div>
                    <div id="sign-result" class="result"></div>
                    <div class="answer-spoiler" id="sign-answer" style="display: none;">
                        <details>
                            <summary>–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>
                            <p class="correct-answer">17<sup><span id="correct-sign-d">27</span></sup> mod <span id="correct-sign-n">55</span> = <span id="correct-sign">8</span></p>
                            <p>–û–±—á–∏—Å–ª–µ–Ω–Ω—è: 17<sup><span id="calc-sign-d">27</span></sup> mod 55 –º–æ–∂–Ω–∞ –æ–±—á–∏—Å–ª–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–æ–¥—É–ª—å–Ω–æ—ó –µ–∫—Å–ø–æ–Ω–µ–Ω—Ç–∏</p>
                        </details>
                    </div>
                </div>
                
                <div class="calculation">
                    <p>–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–≤—ñ–π –ø—Ä–∏–≤–∞—Ç–Ω–∏–π  –∫–ª—é—á (d=<span id="calc-d-sig">27</span>, n=<span id="calc-n-sig">55</span>):</p>
                    <p><span class="formula" id="signature-example">17<sup>27</sup> mod 55 = 8</span></p>
                    <p>–¶–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å: <strong id="signature-value">8</strong></p>
                </div>
                
                <div class="visualization">
                    <div class="person">
                        <div>üëß</div>
                        <div class="person-name">–ê–ª—ñ—Å–∞</div>
                        <div class="person-keys">
                            <div>üîë –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:</div>
                            <div>(e, n) = (<span id="alice-sig-public-e2">3</span>, <span id="alice-sig-public-n2">55</span>)</div>
                            <div>üîí –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á:</div>
                            <div>(d, n) = (<span id="alice-sig-private-d2">27</span>, <span id="alice-sig-private-n2">55</span>)</div>
                        </div>
                    </div>
                    <div class="message-box">
                        <div>üìù üîÄüîè</div>
                        <div>–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è + –ü—ñ–¥–ø–∏—Å–∞–Ω–∏–π –•–µ—à</div>
                        <div id="signed-message">–í–∞–∂–ª–∏–≤—ñ –¥–∞–Ω—ñ</div>
                        <div id="signature-visual">–ü—ñ–¥–ø–∏—Å: 8</div>
                    </div>
                    <div class="person">
                        <div>üë¶</div>
                        <div class="person-name">–ë–æ–±</div>
                        <div class="person-keys">
                            <div>üîë –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ê–ª—ñ—Å–∏:</div>
                            <div>(e, n) = (<span id="bob-sig-public-e2">3</span>, <span id="bob-sig-public-n2">55</span>)</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="step" id="step4-sig">
                <h3><span class="step-number">4</span> –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–ø–∏—Å—É</h3>
                <p>–ë–æ–± –æ—Ç—Ä–∏–º—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –ø—ñ–¥–ø–∏—Å–æ–º —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –π–æ–≥–æ:</p>
                <ol>
                    <li>–û–±—á–∏—Å–ª—é—î —Ö–µ—à –æ—Ç—Ä–∏–º–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</li>
                    <li>–†–æ–∑—à–∏—Ñ—Ä–æ–≤—É—î –ø—ñ–¥–ø–∏—Å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ –∫–ª—é—á–∞ –ê–ª—ñ—Å–∏</li>
                    <li>–ü–æ—Ä—ñ–≤–Ω—é—î –æ—Ç—Ä–∏–º–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –æ–±—á–∏—Å–ª–µ–Ω–∏–º —Ö–µ—à–µ–º</li>
                </ol>
                
                <div class="interactive-task">
                    <p><strong>–°–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ:</strong> –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–¥–ø–∏—Å 8 –∑ e=<span id="verify-e">3</span>, n=<span id="verify-n">55</span></p>
                    <div class="input-group">
                        <input type="number" id="input-verify" placeholder="–•–µ—à">
                        <button onclick="checkVerification()" class="task-button">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
                    </div>
                    <div id="verify-result" class="result"></div>
                    <div class="answer-spoiler" id="verify-answer" style="display: none;">
                        <details>
                            <summary>–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</summary>
                            <p class="correct-answer">8<sup><span id="correct-verify-e">3</span></sup> mod <span id="correct-verify-n">55</span> = <span id="correct-verify">17</span></p>
                            <p>–û–±—á–∏—Å–ª–µ–Ω–Ω—è: 8<sup><span id="calc-verify-e">3</span></sup> = <span id="calc-verify-power">512</span>, <span id="calc-verify-power">512</span> √∑ <span id="calc-verify-n">55</span> = <span id="calc-verify-div">9</span> –∑–∞–ª–∏—à–æ–∫ <span id="calc-verify-mod">17</span></p>
                        </details>
                    </div>
                </div>
                
                <div class="calculation">
                    <p><strong>1. –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ö–µ—à—É –æ—Ç—Ä–∏–º–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:</strong></p>
                    <p>"–í–∞–∂–ª–∏–≤—ñ –¥–∞–Ω—ñ" ‚Üí —Ö–µ—à = <strong>17</strong></p>
                    
                    <p><strong>2. –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø—ñ–¥–ø–∏—Å—É –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é: <span class="formula">h = s<sup>e</sup> mod n</span></strong></p>
                    <p>–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ê–ª—ñ—Å–∏ (e=<span id="calc-e-sig">3</span>, n=<span id="calc-n-sig2">55</span>):</p>
                    <p><span class="formula" id="verification-example">8<sup>3</sup> mod 55 = 512 mod 55 = 17</span></p>
                    
                    <p><strong>3. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è:</strong></p>
                    <p>–û–±—á–∏—Å–ª–µ–Ω–∏–π —Ö–µ—à: 17</p>
                    <p>–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –ø—ñ–¥–ø–∏—Å: <span id="decrypted-signature">17</span></p>
                </div>
                
                <div class="visualization">
                    <div class="person">
                        <div>üëß</div>
                        <div class="person-name">–ê–ª—ñ—Å–∞</div>
                        <div class="person-keys">
                            <div>üîë –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:</div>
                            <div>(e, n) = (<span id="alice-sig-public-e3">3</span>, <span id="alice-sig-public-n3">55</span>)</div>
                            <div>üîí –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á:</div>
                            <div>(d, n) = (<span id="alice-sig-private-d3">27</span>, <span id="alice-sig-private-n3">55</span>)</div>
                        </div>
                    </div>
                    <div class="message-box">
                        <div>‚úÖ üîëüîì üîÄ</div>
                        <div>–ö–ª—é—á –ø—ñ–¥—ñ–π—à–æ–≤ - –ü—ñ–¥–ø–∏—Å –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ!  </div>
                        <div id="verified-message">–•–µ—à —Å–ø—ñ–≤–ø–∞–¥–∞—î - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ –±—É–ª–æ –∑–º—ñ–Ω–µ–Ω–æ</div>
                    </div>
                    <div class="person">
                        <div>üë¶</div>
                        <div class="person-name">–ë–æ–±</div>
                        <div class="person-keys">
                            <div>üîë –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –ê–ª—ñ—Å–∏:</div>
                            <div>(e, n) = (<span id="bob-sig-public-e3">3</span>, <span id="bob-sig-public-n3">55</span>)</div>
                        </div>
                    </div>
                </div>
                
                <p class="info-box">‚úÖ –ü—ñ–¥–ø–∏—Å –≤—ñ—Ä–Ω–∏–π! –ë–æ–± –º–æ–∂–µ –±—É—Ç–∏ –≤–ø–µ–≤–Ω–µ–Ω–∏–π, —â–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥—ñ–π—Å–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞–ª–∞ –ê–ª—ñ—Å–∞ —Ç–∞ –Ω–µ –±—É–ª–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ.</p>
            </div>

            <div class="controls">
                <button id="prev-btn-sig" onclick="prevStep('sig')" disabled>‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫—Ä–æ–∫</button>
                <button id="next-btn-sig" onclick="nextStep('sig')">–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- –î–µ—Ç–∞–ª—å–Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –¥–æ–≤—ñ–¥–∫–∞ -->
    <div class="container">
        <div class="spoiler">
            <summary>üìö –î–µ—Ç–∞–ª—å–Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –¥–æ–≤—ñ–¥–∫–∞</summary>
            <div class="spoiler-content">
                <h3>–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –æ—Å–Ω–æ–≤–∏ RSA</h3>
                
                <h4>1. –©–æ —Ç–∞–∫–µ –ù–°–î(e, œÜ(n)) = 1?</h4>
                <p>–ù–°–î - –ù–∞–π–±—ñ–ª—å—à–∏–π –°–ø—ñ–ª—å–Ω–∏–π –î—ñ–ª—å–Ω–∏–∫. –£–º–æ–≤–∞ <span class="formula">–ù–°–î(e, œÜ(n)) = 1</span> –æ–∑–Ω–∞—á–∞—î, —â–æ —á–∏—Å–ª–∞ e —Ç–∞ œÜ(n) —î –≤–∑–∞—î–º–Ω–æ –ø—Ä–æ—Å—Ç–∏–º–∏, —Ç–æ–±—Ç–æ –Ω–µ –º–∞—é—Ç—å —Å–ø—ñ–ª—å–Ω–∏—Ö –¥—ñ–ª—å–Ω–∏–∫—ñ–≤, –∫—Ä—ñ–º 1.</p>
                <p>–¶—è —É–º–æ–≤–∞ –≤–∞–∂–ª–∏–≤–∞, –æ—Å–∫—ñ–ª—å–∫–∏ –≥–∞—Ä–∞–Ω—Ç—É—î —ñ—Å–Ω—É–≤–∞–Ω–Ω—è –æ–±–µ—Ä–Ω–µ–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ e modulo œÜ(n), —è–∫–∏–π –º–∏ –ø–æ–∑–Ω–∞—á–∞—î–º–æ —è–∫ d.</p>
                
                <div class="euclid-explanation">
                    <div class="euclid-title">2. –ê–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª—ñ–¥–∞ –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –ù–°–î</div>
                    <p><strong>–ê–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª—ñ–¥–∞ –ø—Ä–∞—Ü—é—î —Ç–∞–∫:</strong></p>
                    <ol>
                        <li>–ë–µ—Ä–µ–º–æ –¥–≤–∞ —á–∏—Å–ª–∞, –¥–ª—è —è–∫–∏—Ö —Ö–æ—á–µ–º–æ –∑–Ω–∞–π—Ç–∏ –ù–°–î</li>
                        <li>–î—ñ–ª–∏–º–æ –±—ñ–ª—å—à–µ —á–∏—Å–ª–æ –Ω–∞ –º–µ–Ω—à–µ —ñ –∑–∞–ø–∞–º'—è—Ç–æ–≤—É—î–º–æ –æ—Å—Ç–∞—á—É</li>
                        <li>–Ø–∫—â–æ –æ—Å—Ç–∞—á–∞ –¥–æ—Ä—ñ–≤–Ω—é—î 0, —Ç–æ –ù–°–î - —Ü–µ –º–µ–Ω—à–µ —á–∏—Å–ª–æ</li>
                        <li>–Ø–∫—â–æ –æ—Å—Ç–∞—á–∞ –Ω–µ –¥–æ—Ä—ñ–≤–Ω—é—î 0, —Ç–æ –ø–æ–≤—Ç–æ—Ä—é—î–º–æ –ø—Ä–æ—Ü–µ—Å, –±–µ—Ä—É—á–∏ –º–µ–Ω—à–µ —á–∏—Å–ª–æ —ñ –æ—Å—Ç–∞—á—É</li>
                        <li>–ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ, –ø–æ–∫–∏ –Ω–µ –æ—Ç—Ä–∏–º–∞—î–º–æ –æ—Å—Ç–∞—á—É 0</li>
                    </ol>
                    
                    <p><strong>–ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è —á–∏—Å–µ–ª 48 —ñ 18:</strong></p>
                    <ol>
                        <li>48 √∑ 18 = 2 (–æ—Å—Ç–∞—á–∞ 12)</li>
                        <li>18 √∑ 12 = 1 (–æ—Å—Ç–∞—á–∞ 6)</li>
                        <li>18 √∑ 6 =  (–æ—Å—Ç–∞—á–∞ 0)</li>
                        <li>–û—Å—Ç–∞—á–∞ 0, —Ç–æ–º—É –ù–°–î = 6</li>
                    </ol>
                </div>

                <div class="euclid-explanation">
    <div class="euclid-title">3. –†–æ–∑—à–∏—Ä–µ–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª—ñ–¥–∞ –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è d</div>
	<p><em>–ê–ª–≥–æ—Ä–∏—Ç–º –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —Ç–∞–∫—ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏, —â–æ e √ó d + œÜ(n) √ó k = 1, –¥–µ k - –¥–µ—è–∫–µ —Ü—ñ–ª–µ —á–∏—Å–ª–æ.</em></p>
    <p><strong>–†–æ–∑—à–∏—Ä–µ–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª—ñ–¥–∞ –ø—Ä–∞—Ü—é—î —Ç–∞–∫:</strong></p>
    <ol>
        <li>–ë–µ—Ä–µ–º–æ –¥–≤–∞ —á–∏—Å–ª–∞: e —Ç–∞ œÜ(n), –¥–ª—è —è–∫–∏—Ö —Ö–æ—á–µ–º–æ –∑–Ω–∞–π—Ç–∏ d</li>
        <li>–î—ñ–ª–∏–º–æ –±—ñ–ª—å—à–µ —á–∏—Å–ª–æ –Ω–∞ –º–µ–Ω—à–µ —ñ –∑–∞–ø–∞–º'—è—Ç–æ–≤—É—î–º–æ —á–∞—Å—Ç–∫—É —Ç–∞ –æ—Å—Ç–∞—á—É</li>
        <li>–ó–∞–ø–∞–º'—è—Ç–æ–≤—É—î–º–æ, —è–∫ –æ—Å—Ç–∞—á–∞ –≤–∏—Ä–∞–∂–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–æ—á–∞—Ç–∫–æ–≤—ñ —á–∏—Å–ª–∞ e —Ç–∞ œÜ(n)</li>
        <li>–ü–æ–≤—Ç–æ—Ä—é—î–º–æ –ø—Ä–æ—Ü–µ—Å, –±–µ—Ä—É—á–∏ –º–µ–Ω—à–µ —á–∏—Å–ª–æ —ñ –æ—Å—Ç–∞—á—É</li>
        <li>–ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ, –ø–æ–∫–∏ –Ω–µ –æ—Ç—Ä–∏–º–∞—î–º–æ –æ—Å—Ç–∞—á—É 1.</li>
        <li>–í–∏—Ä–∞–∂–∞—î–º–æ —Ü—é –æ–¥–∏–Ω–∏—Ü—é —á–µ—Ä–µ–∑ –≤—Å—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –æ—Å—Ç–∞—á—ñ, –≥—Ä—É–ø—É—î–º–æ –≤—Å—ñ –¥–æ–¥–∞–Ω–∫–∏ –∑ –º–Ω–æ–∂–Ω–∏–∫–æ–º –µ </li>
        <li>–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –ø–µ—Ä–µ–¥ e –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∫—Ä–æ–∫—É –¥–∞—î –Ω–∞–º —à—É–∫–∞–Ω–µ d (—è–∫—â–æ –≤–∏–π—à–ª–æ –≤—ñ–¥'—î–º–Ω–µ, –¥–æ–¥–∞—î–º–æ œÜ)</li>
    </ol>
    
    <p><strong>–ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è e=5, œÜ(n)=108 (p=19, q=7):</strong></p>
    <ol>
        <li>108 –¥—ñ–ª–∏–º–æ –Ω–∞ 5: 
            <ul>
			    <li>    108 : 5 = 21 (–æ—Å—Ç–∞—á–∞ 3)</li>
                <li>–ê–±–æ 108 = 21 √ó 5 + 3 (–æ—Å—Ç–∞—á–∞ 3)</li>
                <li>–í–∏—Ä–∞–∂–∞—î–º–æ –æ—Å—Ç–∞—á—É 3 = 108 - 5 √ó 21</li>
            </ul>
        </li>
        <li>–ë–µ—Ä–µ–º–æ –º–µ–Ω—à–µ —á–∏—Å–ª–æ –∑ –ø–∞—Ä–∏ e=5, œÜ(n)=108, —É –Ω–∞—Å —Ü–µ –∑–∞–≤–∂–¥–∏ –µ, –¥—ñ–ª–∏–º–æ –Ω–∞ –æ—Å—Ç–∞—á—É 3:
            <ul>
                <li>    5 : 3 = 1 (–æ—Å—Ç–∞—á–∞ 2)</li>
                <li>–ê–±–æ 5 = 3 √ó 1 + 2 (–æ—Å—Ç–∞—á–∞ 2)</li>
                <li>–í–∏—Ä–∞–∂–∞—î–º–æ –æ—Å—Ç–∞—á—É 2 = 5 - 3 √ó 1</li>
            </ul>
        </li>
		  <li>–ë–µ—Ä–µ–º–æ –µ, –¥—ñ–ª–∏–º–æ –Ω–∞ –æ—Å—Ç–∞—á—É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫—Ä–æ–∫—É 2:
            <ul>
                <li>    5 : 2 = 2 (–æ—Å—Ç–∞—á–∞ 1)</li>
                <li>–ê–±–æ 5 = 2 √ó 2 + 1(–æ—Å—Ç–∞—á–∞ 1!!!)</li>
                <li>–í–∏—Ä–∞–∂–∞—î–º–æ –æ—Å—Ç–∞—á—É 1 = 5 - 2 √ó 2</li>
            </ul>
        </li>
        <li>–ü—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ –≤–∏—Ä–∞–∑–∏ –¥–ª—è –æ—Å—Ç–∞—á –∑ —É—Å—ñ—Ö –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∫—Ä–æ–∫—ñ–≤:
            <ul>
                <li>1 = 5 - 2 √ó (5 - 3√ó1) = 5 - 2(5 - (108 - 5 √ó 21)√ó1)</li>
                <li>–ì—Ä—É–ø—É—î–º–æ —É—Å—ñ –¥–æ–¥–∞–Ω–∫–∏ –∑ –º–Ω–æ–∂–Ω–∏–∫–æ–º –µ=5:</li>
				<li>1 = <strong>5</strong> - 2 √ó <strong>5</strong> - 2 √ó <strong>5</strong> √ó 21   + 2 √ó 108 = <strong>5</strong>(1 - 2 - 42) + 2 √ó 108 </li>
            </ul>
        </li>
        <li> –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –±—ñ–ª—è –µ=5 –≤ –¥—É–∂–∫–∞—Ö 1-2-42=-43 —ñ —î —à—É–∫–∞–Ω–µ —á–∏—Å–ª–æ d, –∞–ª–µ –≤–æ–Ω–æ –≤—ñ–¥'—î–º–Ω–µ, —Ç–æ–¥—ñ –¥–æ–¥–∞—î–º–æ œÜ=108:  d=-43+108=65 </li>
        <li> e=5 i d=65 "–º—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω–æ –æ–±–µ—Ä–Ω–µ–Ω—ñ" –∑–∞ –º–æ–¥—É–ª–µ–º œÜ=108, —Ç–æ–±—Ç–æ e√ód ‚â° 1 mod œÜ  –∞–±–æ e√ód = 1 + k√óœÜ, –¥–µ k  —Ü—ñ–ª–µ</li>
    </ol>
    <p>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: 65 √ó 5 = 325, 325=1+3√ó108,  65 √ó 5 ‚â° 1 mod 108 ‚úì</p>
    
    
</div>
				
				
                
                <h4>4. –Ø–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –º—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω–æ –æ–±–µ—Ä–Ω–µ–Ω–µ —á–∏—Å–ª–æ d?</h4>
                <p>–î–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è d —Ç–∞–∫–æ–≥–æ, —â–æ <span class="formula">d √ó e ‚â° 1 mod œÜ(n)</span>, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª—ñ–¥–∞.</p>
                <p><strong>–ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è e=3, œÜ(n)=20:</strong></p>
                <ol>
                    <li>–®—É–∫–∞—î–º–æ —Ç–∞–∫–µ d, —â–æ <span class="formula">3 √ó d ‚â° 1 mod 20</span></li>
                    <li>–ü–µ—Ä–µ–±–∏—Ä–∞—î–º–æ —á–∏—Å–ª–∞: 3√ó1=3, 3√ó2=6, 3√ó3=9, ..., 3√ó7=21</li>
                    <li><span class="formula">21 mod 20 = 1</span> - –∑–Ω–∞–π—à–ª–∏!</li>
                    <li>–û—Ç–∂–µ, d = 7</li>
                </ol>
                <p>–£ —Ä–µ–∞–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —á–∏—Å–µ–ª –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª—ñ–¥–∞, —è–∫–∏–π –∑–Ω–∞—Ö–æ–¥–∏—Ç—å d –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.</p>
                
                <h4>5. –ß–æ–º—É RSA –ø—Ä–∞—Ü—é—î?</h4>
                <p>–ê–ª–≥–æ—Ä–∏—Ç–º RSA –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —Ç–µ–æ—Ä–µ–º—ñ –ï–π–ª–µ—Ä–∞, —è–∫–∞ —Å—Ç–≤–µ—Ä–¥–∂—É—î, —â–æ –¥–ª—è –±—É–¥—å-—è–∫–∏—Ö –≤–∑–∞—î–º–Ω–æ –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–µ–ª m —Ç–∞ n:</p>
                <p class="formula">m<sup>œÜ(n)</sup> ‚â° 1 (mod n)</p>
                <p>–î–ª—è RSA, –¥–µ n = p√óq (–¥–æ–±—É—Ç–æ–∫ –¥–≤–æ—Ö –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–µ–ª), œÜ(n) = (p-1)(q-1).</p>
                <p>–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è: <span class="formula">c = m<sup>e</sup> mod n</span></p>
                <p>–î–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è: <span class="formula">m = c<sup>d</sup> mod n = (m<sup>e</sup>)<sup>d</sup> mod n = m<sup>e√ód</sup> mod n</span></p>
                <p>–û—Å–∫—ñ–ª—å–∫–∏ <span class="formula">e√ód ‚â° 1 mod œÜ(n)</span>, —Ç–æ <span class="formula">e√ód = 1 + k√óœÜ(n)</span> –¥–ª—è –¥–µ—è–∫–æ–≥–æ k, —Ç–æ–º—É:</p>
                <p class="formula">m<sup>e√ód</sup> = m<sup>1 + k√óœÜ(n)</sup> = m √ó (m<sup>œÜ(n)</sup>)<sup>k</sup> ‚â° m √ó 1<sup>k</sup> ‚â° m (mod n)</p>
                <p>–¶–µ –¥–æ–≤–æ–¥–∏—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—É RSA.</p>
            </div>
        </div>
    </div>

    <script>
        // –ü–æ—Ç–æ—á–Ω–∏–π –∫—Ä–æ–∫ –¥–ª—è –∫–æ–∂–Ω–æ—ó –≤–∫–ª–∞–¥–∫–∏
        let currentStepEnc = 1;
        let currentStepSig = 1;
        const maxStepsEnc = 4;
        const maxStepsSig = 4;

        // –ü–æ—Ç–æ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
        let currentP = 3;
        let currentQ = 11;
        let currentN = 33;
        let currentPhi = 20;
        let currentE = 3;
        let currentD = 7;

        // –ü–æ—Ç–æ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –ø—ñ–¥–ø–∏—Å—É
        let currentPSig = 5;
        let currentQSig = 11;
        let currentNSig = 55;
        let currentPhiSig = 40;
        let currentESig = 3;
        let currentDSig = 27;

        // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –ø–æ –∫—Ä–æ–∫–∞—Ö
        function nextStep(type) {
            if (type === 'enc') {
                if (currentStepEnc < maxStepsEnc) {
                    document.getElementById(`step${currentStepEnc}-enc`).classList.remove('active');
                    currentStepEnc++;
                    document.getElementById(`step${currentStepEnc}-enc`).classList.add('active');
                    updateButtons('enc');
                }
            } else {
                if (currentStepSig < maxStepsSig) {
                    document.getElementById(`step${currentStepSig}-sig`).classList.remove('active');
                    currentStepSig++;
                    document.getElementById(`step${currentStepSig}-sig`).classList.add('active');
                    updateButtons('sig');
                }
            }
        }

        function prevStep(type) {
            if (type === 'enc') {
                if (currentStepEnc > 1) {
                    document.getElementById(`step${currentStepEnc}-enc`).classList.remove('active');
                    currentStepEnc--;
                    document.getElementById(`step${currentStepEnc}-enc`).classList.add('active');
                    updateButtons('enc');
                }
            } else {
                if (currentStepSig > 1) {
                    document.getElementById(`step${currentStepSig}-sig`).classList.remove('active');
                    currentStepSig--;
                    document.getElementById(`step${currentStepSig}-sig`).classList.add('active');
                    updateButtons('sig');
                }
            }
        }

        function updateButtons(type) {
            if (type === 'enc') {
                document.getElementById('prev-btn-enc').disabled = currentStepEnc === 1;
                document.getElementById('next-btn-enc').textContent = 
                    currentStepEnc === maxStepsEnc ? '–ó–∞–≤–µ—Ä—à–∏—Ç–∏' : '–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Üí';
            } else {
                document.getElementById('prev-btn-sig').disabled = currentStepSig === 1;
                document.getElementById('next-btn-sig').textContent = 
                    currentStepSig === maxStepsSig ? '–ó–∞–≤–µ—Ä—à–∏—Ç–∏' : '–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Üí';
            }
        }

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –≤—Å—ñ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –æ–±—Ä–∞–Ω—É –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName).classList.add('active');
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –∞–∫—Ç–∏–≤–Ω—É –≤–∫–ª–∞–¥–∫—É –≤ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // –°–∫–∏–¥–∞—î–º–æ –∫—Ä–æ–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—ñ –≤–∫–ª–∞–¥–æ–∫
            if (tabName === 'encryption') {
                resetSteps('enc');
            } else {
                resetSteps('sig');
            }
        }

        function resetSteps(type) {
            if (type === 'enc') {
                // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –≤—Å—ñ –∫—Ä–æ–∫–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
                for (let i = 1; i <= maxStepsEnc; i++) {
                    document.getElementById(`step${i}-enc`).classList.remove('active');
                }
                // –ü–æ–∫–∞–∑—É—î–º–æ –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫
                document.getElementById('step1-enc').classList.add('active');
                currentStepEnc = 1;
                updateButtons('enc');
            } else {
                // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –≤—Å—ñ –∫—Ä–æ–∫–∏ –ø—ñ–¥–ø–∏—Å—É
                for (let i = 1; i <= maxStepsSig; i++) {
                    document.getElementById(`step${i}-sig`).classList.remove('active');
                }
                // –ü–æ–∫–∞–∑—É—î–º–æ –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫
                document.getElementById('step1-sig').classList.add('active');
                currentStepSig = 1;
                updateButtons('sig');
            }
        }

        // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å
        function calculateKeys() {
            const p = parseInt(document.getElementById('input-p').value);
            const q = parseInt(document.getElementById('input-q').value);
            
            if (isPrime(p) && isPrime(q)) {
                currentP = p;
                currentQ = q;
                currentN = p * q;
                currentPhi = (p-1) * (q-1);
                currentE = findE(currentPhi);
                currentD = findD(currentE, currentPhi);
                
                updateKeyDisplay();
                updateEncryptionExample();
                document.getElementById('d-result').innerHTML = '‚úÖ –ö–ª—é—á—ñ —É—Å–ø—ñ—à–Ω–æ –æ–±—á–∏—Å–ª–µ–Ω—ñ!';
                document.getElementById('d-answer').style.display = 'none';
            } else {
                document.getElementById('d-result').innerHTML = '‚ùå p —Ç–∞ q –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –ø—Ä–æ—Å—Ç–∏–º–∏ —á–∏—Å–ª–∞–º–∏!';
            }
        }

        function calculateKeysSig() {
            const p = parseInt(document.getElementById('input-p-sig').value);
            const q = parseInt(document.getElementById('input-q-sig').value);
            
            if (isPrime(p) && isPrime(q)) {
                currentPSig = p;
                currentQSig = q;
                currentNSig = p * q;
                currentPhiSig = (p-1) * (q-1);
                currentESig = findE(currentPhiSig);
                currentDSig = findD(currentESig, currentPhiSig);
                
                updateKeyDisplaySig();
                updateSignatureExample();
                document.getElementById('d-result-sig').innerHTML = '‚úÖ –ö–ª—é—á—ñ —É—Å–ø—ñ—à–Ω–æ –æ–±—á–∏—Å–ª–µ–Ω—ñ!';
                document.getElementById('d-answer-sig').style.display = 'none';
            } else {
                document.getElementById('d-result-sig').innerHTML = '‚ùå p —Ç–∞ q –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –ø—Ä–æ—Å—Ç–∏–º–∏ —á–∏—Å–ª–∞–º–∏!';
            }
        }

        function checkD() {
            const userD = parseInt(document.getElementById('input-d').value);
            const isValid = (userD * currentE) % currentPhi === 1;
            
            if (isValid) {
                document.getElementById('d-result').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! d = ' + userD;
                document.getElementById('d-answer').style.display = 'none';
            } else {
                document.getElementById('d-result').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';
                document.getElementById('d-answer').style.display = 'block';
                document.getElementById('correct-d').textContent = currentD;
                document.getElementById('check-e').textContent = currentE;
                document.getElementById('check-d').textContent = currentD;
                document.getElementById('check-product').textContent = currentE * currentD;
                document.getElementById('check-phi').textContent = currentPhi;
            }
        }

        function checkDSig() {
            const userD = parseInt(document.getElementById('input-d-sig').value);
            const isValid = (userD * currentESig) % currentPhiSig === 1;
            
            if (isValid) {
                document.getElementById('d-result-sig').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! d = ' + userD;
                document.getElementById('d-answer-sig').style.display = 'none';
            } else {
                document.getElementById('d-result-sig').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';
                document.getElementById('d-answer-sig').style.display = 'block';
                document.getElementById('correct-d-sig').textContent = currentDSig;
                document.getElementById('check-e-sig').textContent = currentESig;
                document.getElementById('check-d-sig').textContent = currentDSig;
                document.getElementById('check-product-sig').textContent = currentESig * currentDSig;
                document.getElementById('check-phi-sig').textContent = currentPhiSig;
            }
        }

        function checkEncryption() {
            const userResult = parseInt(document.getElementById('input-encrypt').value);
            const correctResult = modExp(17, currentE, currentN);
            if (userResult === correctResult) {
                document.getElementById('encrypt-result').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! 17<sup>' + currentE + '</sup> mod ' + currentN + ' = ' + correctResult;
                document.getElementById('encrypt-answer').style.display = 'none';
            } else {
                document.getElementById('encrypt-result').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';
                document.getElementById('encrypt-answer').style.display = 'block';
                document.getElementById('correct-encrypt').textContent = correctResult;
                document.getElementById('correct-encrypt-e').textContent = currentE;
                document.getElementById('correct-encrypt-n').textContent = currentN;
                document.getElementById('calc-encrypt-e').textContent = currentE;
                document.getElementById('calc-encrypt-power').textContent = Math.pow(17, currentE);
                document.getElementById('calc-encrypt-n').textContent = currentN;
                document.getElementById('calc-encrypt-div').textContent = Math.floor(Math.pow(17, currentE) / currentN);
                document.getElementById('calc-encrypt-mod').textContent = correctResult;
            }
        }

        function checkDecryption() {
            const userResult = parseInt(document.getElementById('input-decrypt').value);
            const correctResult = modExp(29, currentD, currentN);
            if (userResult === correctResult) {
                document.getElementById('decrypt-result').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! 29<sup>' + currentD + '</sup> mod ' + currentN + ' = ' + correctResult;
                document.getElementById('decrypt-answer').style.display = 'none';
            } else {
                document.getElementById('decrypt-result').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';
                document.getElementById('decrypt-answer').style.display = 'block';
                document.getElementById('correct-decrypt').textContent = correctResult;
                document.getElementById('correct-decrypt-d').textContent = currentD;
                document.getElementById('correct-decrypt-n').textContent = currentN;
                document.getElementById('calc-decrypt-d').textContent = currentD;
                document.getElementById('calc-decrypt-power').textContent = Math.pow(29, currentD);
                document.getElementById('calc-decrypt-n').textContent = currentN;
                document.getElementById('calc-decrypt-div').textContent = Math.floor(Math.pow(29, currentD) / currentN);
                document.getElementById('calc-decrypt-mod').textContent = correctResult;
            }
        }

        function checkSignature() {
            const userResult = parseInt(document.getElementById('input-sign').value);
            const correctResult = modExp(17, currentDSig, currentNSig);
            if (userResult === correctResult) {
                document.getElementById('sign-result').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! 17<sup>' + currentDSig + '</sup> mod ' + currentNSig + ' = ' + correctResult;
                document.getElementById('sign-answer').style.display = 'none';
            } else {
                document.getElementById('sign-result').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';
                document.getElementById('sign-answer').style.display = 'block';
                document.getElementById('correct-sign').textContent = correctResult;
                document.getElementById('correct-sign-d').textContent = currentDSig;
                document.getElementById('correct-sign-n').textContent = currentNSig;
                document.getElementById('calc-sign-d').textContent = currentDSig;
            }
        }

        function checkVerification() {
            const userResult = parseInt(document.getElementById('input-verify').value);
            const correctResult = modExp(8, currentESig, currentNSig);
            if (userResult === correctResult) {
                document.getElementById('verify-result').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! 8<sup>' + currentESig + '</sup> mod ' + currentNSig + ' = ' + correctResult;
                document.getElementById('verify-answer').style.display = 'none';
            } else {
                document.getElementById('verify-result').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';
                document.getElementById('verify-answer').style.display = 'block';
                document.getElementById('correct-verify').textContent = correctResult;
                document.getElementById('correct-verify-e').textContent = currentESig;
                document.getElementById('correct-verify-n').textContent = currentNSig;
                document.getElementById('calc-verify-e').textContent = currentESig;
                document.getElementById('calc-verify-power').textContent = Math.pow(8, currentESig);
                document.getElementById('calc-verify-n').textContent = currentNSig;
                document.getElementById('calc-verify-div').textContent = Math.floor(Math.pow(8, currentESig) / currentNSig);
                document.getElementById('calc-verify-mod').textContent = correctResult;
            }
        }

        // –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
        function isPrime(num) {
            if (num <= 1) return false;
            if (num <= 3) return true;
            if (num % 2 === 0 || num % 3 === 0) return false;
            for (let i = 5; i * i <= num; i += 6) {
                if (num % i === 0 || num % (i + 2) === 0) return false;
            }
            return true;
        }

        function gcd(a, b) {
            while (b !== 0) {
                const temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }

        function findE(phi) {
            // –®—É–∫–∞—î–º–æ e –≤–∑–∞—î–º–Ω–æ –ø—Ä–æ—Å—Ç–µ –∑ phi
            for (let e = 2; e < phi; e++) {
                if (gcd(e, phi) === 1) {
                    return e;
                }
            }
            return 3; // fallback
        }

        function findD(e, phi) {
            // –ó–Ω–∞—Ö–æ–¥–∏–º–æ d —è–∫ –æ–±–µ—Ä–Ω–µ–Ω–µ –¥–æ e mod phi
            for (let d = 1; d < phi; d++) {
                if ((e * d) % phi === 1) {
                    return d;
                }
            }
            return 1; // fallback
        }

        function modExp(base, exponent, modulus) {
            if (modulus === 1) return 0;
            let result = 1;
            base = base % modulus;
            while (exponent > 0) {
                if (exponent % 2 === 1) {
                    result = (result * base) % modulus;
                }
                exponent = Math.floor(exponent / 2);
                base = (base * base) % modulus;
            }
            return result;
        }

        function updateKeyDisplay() {
            document.getElementById('p-value').textContent = currentP;
            document.getElementById('q-value').textContent = currentQ;
            document.getElementById('n-value').textContent = currentN;
            document.getElementById('phi-value').textContent = currentPhi;
            document.getElementById('e-value').textContent = currentE;
            document.getElementById('d-value').textContent = currentD;
            document.getElementById('public-e').textContent = currentE;
            document.getElementById('public-n').textContent = currentN;
            document.getElementById('private-d').textContent = currentD;
            document.getElementById('private-n').textContent = currentN;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è
            document.getElementById('task-e').textContent = currentE;
            document.getElementById('task-phi').textContent = currentPhi;
            document.getElementById('hint-e').textContent = currentE;
            document.getElementById('hint-phi').textContent = currentPhi;
            document.getElementById('encrypt-e').textContent = currentE;
            document.getElementById('encrypt-n').textContent = currentN;
            document.getElementById('decrypt-d').textContent = currentD;
            document.getElementById('decrypt-n').textContent = currentN;
            document.getElementById('calc-e').textContent = currentE;
            document.getElementById('calc-n').textContent = currentN;
            document.getElementById('calc-d').textContent = currentD;
            document.getElementById('calc-n2').textContent = currentN;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –∫–ª—é—á—ñ –Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
            document.getElementById('alice-public-e').textContent = currentE;
            document.getElementById('alice-public-n').textContent = currentN;
            document.getElementById('alice-public-e2').textContent = currentE;
            document.getElementById('alice-public-n2').textContent = currentN;
            document.getElementById('alice-public-e3').textContent = currentE;
            document.getElementById('alice-public-n3').textContent = currentN;
            
            document.getElementById('bob-public-e').textContent = currentE;
            document.getElementById('bob-public-n').textContent = currentN;
            document.getElementById('bob-private-d').textContent = currentD;
            document.getElementById('bob-private-n').textContent = currentN;
            document.getElementById('bob-public-e2').textContent = currentE;
            document.getElementById('bob-public-n2').textContent = currentN;
            document.getElementById('bob-private-d2').textContent = currentD;
            document.getElementById('bob-private-n2').textContent = currentN;
            document.getElementById('bob-public-e3').textContent = currentE;
            document.getElementById('bob-public-n3').textContent = currentN;
            document.getElementById('bob-private-d3').textContent = currentD;
            document.getElementById('bob-private-n3').textContent = currentN;
        }

        function updateKeyDisplaySig() {
            document.getElementById('p-sig').textContent = currentPSig;
            document.getElementById('q-sig').textContent = currentQSig;
            document.getElementById('n-sig').textContent = currentNSig;
            document.getElementById('phi-sig').textContent = currentPhiSig;
            document.getElementById('e-sig').textContent = currentESig;
            document.getElementById('d-sig').textContent = currentDSig;
            document.getElementById('public-e-sig').textContent = currentESig;
            document.getElementById('public-n-sig').textContent = currentNSig;
            document.getElementById('private-d-sig').textContent = currentDSig;
            document.getElementById('private-n-sig').textContent = currentNSig;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è
            document.getElementById('task-e-sig').textContent = currentESig;
            document.getElementById('task-phi-sig').textContent = currentPhiSig;
            document.getElementById('hint-e-sig').textContent = currentESig;
            document.getElementById('hint-phi-sig').textContent = currentPhiSig;
            document.getElementById('sign-d').textContent = currentDSig;
            document.getElementById('sign-n').textContent = currentNSig;
            document.getElementById('verify-e').textContent = currentESig;
            document.getElementById('verify-n').textContent = currentNSig;
            document.getElementById('calc-d-sig').textContent = currentDSig;
            document.getElementById('calc-n-sig').textContent = currentNSig;
            document.getElementById('calc-e-sig').textContent = currentESig;
            document.getElementById('calc-n-sig2').textContent = currentNSig;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –∫–ª—é—á—ñ –Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
            document.getElementById('alice-sig-public-e').textContent = currentESig;
            document.getElementById('alice-sig-public-n').textContent = currentNSig;
            document.getElementById('alice-sig-private-d').textContent = currentDSig;
            document.getElementById('alice-sig-private-n').textContent = currentNSig;
            document.getElementById('alice-sig-public-e2').textContent = currentESig;
            document.getElementById('alice-sig-public-n2').textContent = currentNSig;
            document.getElementById('alice-sig-private-d2').textContent = currentDSig;
            document.getElementById('alice-sig-private-n2').textContent = currentNSig;
            document.getElementById('alice-sig-public-e3').textContent = currentESig;
            document.getElementById('alice-sig-public-n3').textContent = currentNSig;
            document.getElementById('alice-sig-private-d3').textContent = currentDSig;
            document.getElementById('alice-sig-private-n3').textContent = currentNSig;
            
            document.getElementById('bob-sig-public-e').textContent = currentESig;
            document.getElementById('bob-sig-public-n').textContent = currentNSig;
            document.getElementById('bob-sig-public-e2').textContent = currentESig;
            document.getElementById('bob-sig-public-n2').textContent = currentNSig;
            document.getElementById('bob-sig-public-e3').textContent = currentESig;
            document.getElementById('bob-sig-public-n3').textContent = currentNSig;
        }

        // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–∫–ª–∞–¥—ñ–≤
        function updateEncryptionExample() {
            // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∏–∫–ª–∞–¥ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ—Ç–æ—á–Ω–∏—Ö –∫–ª—é—á—ñ–≤
            const originalNumbers = [17, 18, 10, 3, 9, 20, 0, 2, 16, 2, 6, 0];
            let encryptedNumbers = [];
            let decryptedNumbers = [];
            
            // –®–∏—Ñ—Ä—É—î–º–æ –∫–æ–∂–Ω–µ —á–∏—Å–ª–æ
            for (let i = 0; i < originalNumbers.length; i++) {
                const encrypted = modExp(originalNumbers[i], currentE, currentN);
                encryptedNumbers.push(encrypted);
            }
            
            // –î–µ—à–∏—Ñ—Ä—É—î–º–æ –∫–æ–∂–Ω–µ —á–∏—Å–ª–æ
            for (let i = 0; i < encryptedNumbers.length; i++) {
                const decrypted = modExp(encryptedNumbers[i], currentD, currentN);
                decryptedNumbers.push(decrypted);
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
            document.getElementById('encrypted-message').textContent = encryptedNumbers.join(' ');
            document.getElementById('encrypted-visual').textContent = encryptedNumbers.join(' ');
            document.getElementById('decrypted-numeric').textContent = decryptedNumbers.join(' ');
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∏–∫–ª–∞–¥–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–ª—è –ø–µ—Ä—à–∏—Ö —Ç—Ä—å–æ—Ö —á–∏—Å–µ–ª
            const example1 = originalNumbers[0];
            const example2 = originalNumbers[1];
            const example3 = originalNumbers[2];
            
            const encrypted1 = encryptedNumbers[0];
            const encrypted2 = encryptedNumbers[1];
            const encrypted3 = encryptedNumbers[2];
            
            // –û–±—á–∏—Å–ª—é—î–º–æ –ø—Ä–æ–º—ñ–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –ø–æ–∫–∞–∑—É
            const power1 = Math.pow(example1, currentE);
            const power2 = Math.pow(example2, currentE);
            const power3 = Math.pow(example3, currentE);
            
            // –û–Ω–æ–≤–ª—é—î–º–æ HTML –¥–ª—è –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
            document.getElementById('encryption-example1').innerHTML = 
                `${example1}<sup>${currentE}</sup> mod ${currentN} = ${power1} mod ${currentN} = ${encrypted1}`;
            document.getElementById('encryption-example2').innerHTML = 
                `${example2}<sup>${currentE}</sup> mod ${currentN} = ${power2} mod ${currentN} = ${encrypted2}`;
            document.getElementById('encryption-example3').innerHTML = 
                `${example3}<sup>${currentE}</sup> mod ${currentN} = ${power3} mod ${currentN} = ${encrypted3}`;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∏–∫–ª–∞–¥–∏ –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–ª—è –ø–µ—Ä—à–∏—Ö —Ç—Ä—å–æ—Ö –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—Ö —á–∏—Å–µ–ª
            const decrypted1 = decryptedNumbers[0];
            const decrypted2 = decryptedNumbers[1];
            const decrypted3 = decryptedNumbers[2];
            
            const powerD1 = Math.pow(encrypted1, currentD);
            const powerD2 = Math.pow(encrypted2, currentD);
            const powerD3 = Math.pow(encrypted3, currentD);
            
            document.getElementById('decryption-example1').innerHTML = 
                `${encrypted1}<sup>${currentD}</sup> mod ${currentN} = ${powerD1} mod ${currentN} = ${decrypted1}`;
            document.getElementById('decryption-example2').innerHTML = 
                `${encrypted2}<sup>${currentD}</sup> mod ${currentN} = ${powerD2} mod ${currentN} = ${decrypted2}`;
            document.getElementById('decryption-example3').innerHTML = 
                `${encrypted3}<sup>${currentD}</sup> mod ${currentN} = ${powerD3} mod ${currentN} = ${decrypted3}`;
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–æ–π—à–ª–æ —É—Å–ø—ñ—à–Ω–æ
            const isSuccess = JSON.stringify(originalNumbers) === JSON.stringify(decryptedNumbers);
            if (isSuccess) {
                document.getElementById('decrypted-text').textContent = "–ü—Ä–∏–≤—ñ—Ç, –ë–æ–±–µ!";
                document.getElementById('decrypted-visual').textContent = "–ü—Ä–∏–≤—ñ—Ç, –ë–æ–±–µ!";
            } else {
                document.getElementById('decrypted-text').textContent = "–ü–æ–º–∏–ª–∫–∞ –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!";
                document.getElementById('decrypted-visual').textContent = "–ü–æ–º–∏–ª–∫–∞ –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!";
            }
        }

        function updateSignatureExample() {
            // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∏–∫–ª–∞–¥ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø—ñ–¥–ø–∏—Å—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ—Ç–æ—á–Ω–∏—Ö –∫–ª—é—á—ñ–≤
            const messageNumbers = [3, 1, 8, 13, 10, 3, 9, 5, 1, 15, 9];
            const hash = messageNumbers.reduce((sum, num) => sum + num, 0) % 20;
            
            // –û–±—á–∏—Å–ª—é—î–º–æ –ø—ñ–¥–ø–∏—Å
            const signature = modExp(hash, currentDSig, currentNSig);
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ø—ñ–¥–ø–∏—Å
            const verifiedHash = modExp(signature, currentESig, currentNSig);
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
            document.getElementById('signature-value').textContent = signature;
            document.getElementById('signature-visual').textContent = '–ü—ñ–¥–ø–∏—Å: ' + signature;
            document.getElementById('decrypted-signature').textContent = verifiedHash;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∏–∫–ª–∞–¥ –ø—ñ–¥–ø–∏—Å—É
            document.getElementById('signature-example').innerHTML = 
                `${hash}<sup>${currentDSig}</sup> mod ${currentNSig} = ${signature}`;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∏–∫–ª–∞–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
            const verificationPower = Math.pow(signature, currentESig);
            document.getElementById('verification-example').innerHTML = 
                `${signature}<sup>${currentESig}</sup> mod ${currentNSig} = ${verificationPower} mod ${currentNSig} = ${verifiedHash}`;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            const infoBox = document.querySelector('#step4-sig .info-box');
            if (hash === verifiedHash) {
                infoBox.innerHTML = '‚úÖ –ü—ñ–¥–ø–∏—Å –≤—ñ—Ä–Ω–∏–π! –ë–æ–± –º–æ–∂–µ –±—É—Ç–∏ –≤–ø–µ–≤–Ω–µ–Ω–∏–π, —â–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥—ñ–π—Å–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞–ª–∞ –ê–ª—ñ—Å–∞ —Ç–∞ –Ω–µ –±—É–ª–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ.';
            } else {
                infoBox.innerHTML = '‚ùå –ü—ñ–¥–ø–∏—Å –Ω–µ –≤—ñ—Ä–Ω–∏–π! –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–ª–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ –∞–±–æ –∫–ª—é—á—ñ –Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ.';
            }
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            updateButtons('enc');
            updateButtons('sig');
            updateKeyDisplay();
            updateKeyDisplaySig();
            updateEncryptionExample();
            updateSignatureExample();
        });
    </script>
</body>
</html>