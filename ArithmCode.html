<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–°–∏–º—É–ª—è—Ç–æ—Ä –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–æ–≥–æ –ö–æ–¥—É–≤–∞–Ω–Ω—è </title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 20px;
            background: #f9f9f9;
        }
        h1, h2, h3 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }
        h1 { font-size: 1.8em; }
        h2 { font-size: 1.5em; }
        h3 { font-size: 1.2em; }
        section {
            margin-bottom: 40px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        input[type="text"], input[type="number"] {
            width: 300px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }

        /* --- –°—Ç–∏–ª—ñ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó --- */
        .bar {
            position: relative;
            height: 50px;
            width: 100%;
            background: #f0f0f0;
            border: 1px solid #000;
            margin-top: 1px;
            display: flex;
        }
        .segment {
            position: relative;
            height: 100%;
            color: #000;
            text-align: center;
            line-height: 50px;
            font-weight: bold;
            box-sizing: border-box;
            border-right: 1px solid #aaa;
        }
        .segment:last-child { border-right: none; }
        /* –ü–æ–≤–µ—Ä–Ω—É—Ç–æ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è */
        .segment.chosen {
            border: 3px solid #000;
            box-shadow: 0 0 10px rgba(0,0,0,0.5) inset;
        }

        .tick-container {
            position: relative;
            width: 100%;
            height: 40px;
        }
        .tick {
            position: absolute;
            bottom: 20px;
            border-left: 2px solid #000;
            height: 10px;
        }
        .number {
            position: absolute;
            bottom: 0px;
            font-size: 12px;
            transform: translateX(-50%);
            background: #f9f9f9;
            padding: 0 2px;
        }

        /* --- Flex-layout –¥–ª—è –∫—Ä–æ–∫—ñ–≤ --- */
        .step-container {
            display: flex;
            gap: 20px;
            margin-top: 2px; 
            border-top: 1px dashed #ccc;
            padding-top: 2px;
        }
        .step-container:first-of-type {
            margin-top: 1px;
            border-top: none;
            padding-top: 0;
        }

        .zoom-lines {
            width: 100%;
            height: 40px;
            display: block;
            margin: 0;
            padding: 0;
        }
        .zoom-lines line {
            stroke: #888;
            stroke-width: 2;
            stroke-dasharray: 4 2;
        }

        .fp-visual { flex: 2; } /* –õ—ñ–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ */
        
        .int-visual {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', Courier, monospace;
        }
        .int-visual h4 {
            margin-top: 0;
            border-bottom: 1px solid #999;
        }
        .int-visual code {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
        }
        .int-visual .bit-output {
            color: #d9534f;
            font-weight: bold;
        }
        .int-visual .stream { word-break: break-all; }
        
        details.int-spoiler {
            flex: 1;
            border: 1px solid #ccc;
            border-radius: 4px;
            background: #f9f9f9;
            margin-top: 0;
            height: fit-content;
        }
        details.int-spoiler > summary {
            font-weight: bold;
            padding: 10px;
            cursor: pointer;
            background: #f0f0f0;
            border-radius: 4px;
        }
        details.int-spoiler[open] > summary {
             border-bottom: 1px solid #ccc;
             border-radius: 4px 4px 0 0;
        }
        details.int-spoiler > .int-visual {
            margin-top: 0;
            border: none;
            border-top: 1px solid #ccc; 
            border-radius: 0 0 4px 4px;
            background: #fdfdfd;
        }

        #summary-section { margin-top: 20px; }
        .summary-table { width: 100%; border-collapse: collapse; }
        .summary-table th, .summary-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .summary-table th { background-color: #f2f2f2; }
        .summary-table tr:nth-child(even) { background-color: #f9f9f9; }
        .summary-table .arithmetic-row { font-weight: bold; background-color: #e6f7ff; }

        .explanation {
            margin: 10px 0;
            font-size: 1.1em;
            background: #e6f7ff;
            padding: 10px;
            border-radius: 5px;
            border-left: 5px solid #007bff;
        }
        
        #theory-section {
            background: #f5f5f5;
        }
        #theory-section details {
            border: 1px solid #ccc;
            border-radius: 8px;
            background: #fff;
        }
        #theory-section summary {
            font-size: 1.5em;
            font-weight: bold;
            padding: 15px;
            cursor: pointer;
        }
        #theory-section .content {
            padding: 0 20px 20px 20px;
            line-height: 1.7;
            font-size: 1.1em;
        }
        #theory-section .content h4 {
            color: #0056b3;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }
        #theory-section .content code {
            background: #e0e0e0;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
        }
    </style>
</head>
<body>
    <h3> –°–∏–º—É–ª—è—Ç–æ—Ä –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–æ–≥–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è </h3>
    <p>–¶–µ–π —Å–∏–º—É–ª—è—Ç–æ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î 8-–±—ñ—Ç–Ω–∏–π —Ü—ñ–ª–æ—á–∏—Å–µ–ª—å–Ω–∏–π –∫–æ–¥–µ—Ä [0, 255] —Ç–∞ <strong>–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ</strong> –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–æ–≥–æ –≤–∞–º–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.</p>

    <section id="input-section">
        <h2>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ú–æ–¥–µ–ª—ñ</h2>
        <label for="message">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (–¥–æ 20 —Å–∏–º–≤–æ–ª—ñ–≤, –Ω–∞–ø—Ä., a banana):</label>
        <input type="text" id="message" value="a banana" style="width: 400px;" maxlength="20"><br><br>
        <button onclick="runEncoding()">–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ö–æ–¥—É–≤–∞–Ω–Ω—è</button>
        <p><small>–ü—Ä–∏–º—ñ—Ç–∫–∞: –ú–æ–¥–µ–ª—å –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π –±—É–¥–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—Ç–æ—Ç–∏ —Å–∏–º–≤–æ–ª—ñ–≤ —É —Ü—å–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ.</small></p>
    </section>

    <section id="encoding-section">
        <h2>–°–∏–º—É–ª—è—Ç–æ—Ä –ö–æ–¥—É–≤–∞–Ω–Ω—è (–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π –†–µ–∂–∏–º)</h2>
        <div id="encoding-steps"></div>
        <div id="summary-section"></div>
    </section>

    <section id="decoding-section">
        <h2>–°–∏–º—É–ª—è—Ç–æ—Ä –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è</h2>
        <p>–î–µ–∫–æ–¥–µ—Ä –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç—É —Å–∞–º—É –º–æ–¥–µ–ª—å, —â–æ –±—É–ª–∞ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –∫–æ–¥—É–≤–∞–Ω–Ω—ñ.</p>
        <label for="code">–ö–æ–¥ –¥–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è (–º—ñ–∂ 0 —ñ 1):</label>
        <input type="text" id="code" value="0.528"><br><br>
        <label for="decode-length">–î–æ–≤–∂–∏–Ω–∞ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è (–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–∏–º–≤–æ–ª—ñ–≤):</label>
        <input type="number" id="decode-length" value="8"><br><br>
        <button onclick="runDecoding()">–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è</button>
        <div id="decoding-steps"></div>
    </section>

    <section id="theory-section">
        <details>
            <summary>–¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –æ—Å–Ω–æ–≤–∏ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</summary>
            <div class="content">
                <p>–ï—Ñ–µ–∫—Ç–∏–≤–Ω–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ –ø–æ—à—É–∫—É —Ç–∞ —É—Å—É–Ω–µ–Ω–Ω—ñ –Ω–∞–¥–ª–∏—à–∫–æ–≤–æ—Å—Ç—ñ. –ú–µ—Ç–æ–¥–∏ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –ø–æ–¥—ñ–ª—è—é—Ç—å—Å—è –Ω–∞ –¥–µ–∫—ñ–ª—å–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π, —ñ —Ü–µ–π —Å–∏–º—É–ª—è—Ç–æ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –æ–¥–∏–Ω –∑ –Ω–∞–π–ø–æ—Ç—É–∂–Ω—ñ—à–∏—Ö ‚Äî –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è.</p>

                <h4>–ï–Ω—Ç—Ä–æ–ø—ñ—è –®–µ–Ω–Ω–æ–Ω–∞ </h4>
                <p>–í–≤–µ–¥–µ–Ω–∞ –ö–ª–æ–¥–æ–º –®–µ–Ω–Ω–æ–Ω–æ–º, –µ–Ω—Ç—Ä–æ–ø—ñ—è ‚Äî —Ü–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π <strong>–º—ñ–Ω—ñ–º—É–º</strong> —Å–µ—Ä–µ–¥–Ω—å–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –±—ñ—Ç, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –¥–ª—è –∫–æ–¥—É–≤–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª—É –∑ –ø–µ–≤–Ω–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞. –í–æ–Ω–∞ –≤–∏–º—ñ—Ä—é—î "–Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å" –∞–±–æ "–∫—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó".</p>
                
                $$H(X) = -\sum_{i=1}^{n} p(x_i) \log_2 p(x_i)$$
                <ul>
                    <li>–Ø–∫—â–æ —É –≤–∞—Å —î "—á–µ—Å–Ω–∞" –º–æ–Ω–µ—Ç–∞ p–æ—Ä–µ–ª)=0.5, p(—Ä–µ—à–∫–∞)=0.5), –µ–Ω—Ç—Ä–æ–ø—ñ—è = <strong>1.0 –±—ñ—Ç</strong>. –ú–∏ –Ω–µ –º–æ–∂–µ–º–æ —Å—Ç–∏—Å–Ω—É—Ç–∏ —ó—ó.</li>
                    <li>–Ø–∫—â–æ —É –≤–∞—Å "–Ω–µ—á–µ—Å–Ω–∞" –º–æ–Ω–µ—Ç–∞ (p(–æ—Ä–µ–ª)=0.99, p(—Ä–µ—à–∫–∞)=0.01), –µ–Ω—Ç—Ä–æ–ø—ñ—è  <strong>0.08 –±—ñ—Ç</strong>. –¶–µ –¥–∂–µ—Ä–µ–ª–æ –¥—É–∂–µ –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–µ, —ñ –π–æ–≥–æ –º–æ–∂–Ω–∞ —Å–∏–ª—å–Ω–æ —Å—Ç–∏—Å–Ω—É—Ç–∏.</li>
                </ul>
                <p>–£ —Ç–∞–±–ª–∏—Ü—ñ "–§—ñ–Ω–∞–ª—å–Ω–µ –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è" —Ü–µ–π —Å–∏–º—É–ª—è—Ç–æ—Ä —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î –µ–Ω—Ç—Ä–æ–ø—ñ—é –≤–∞—à–æ—ó –º–æ–¥–µ–ª—ñ. –¶–µ ‚Äî –º–µ—Ç–∞, –¥–æ —è–∫–æ—ó –ø—Ä–∞–≥–Ω–µ —ñ–¥–µ–∞–ª—å–Ω–∏–π –∫–æ–¥–µ—Ä.</p>

                <h4>2. –ö–æ–¥–∏ –∑ –ü—Ä–µ—Ñ—ñ–∫—Å–Ω–æ—é –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—é (–•–∞—Ñ—Ñ–º–∞–Ω, –®–µ–Ω–Ω–æ–Ω-–§–∞–Ω–æ)</h4>
                <p>–¶—ñ –º–µ—Ç–æ–¥–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ç—ñ, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ ZIP) —Å—Ç–≤–æ—Ä—é—é—Ç—å —Å–ª–æ–≤–Ω–∏–∫, –¥–µ –∫–æ–∂–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É –Ω–∞–¥–∞—î—Ç—å—Å—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –¥–≤—ñ–π–∫–æ–≤–∏–π –∫–æ–¥ (–Ω–∞–ø—Ä., <code>'a'=0</code>, <code>'b'=10</code>, <code>'c'=110</code>). –ì–æ–ª–æ–≤–Ω–µ –ø—Ä–∞–≤–∏–ª–æ ‚Äî –∂–æ–¥–µ–Ω –∫–æ–¥ –Ω–µ —î –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º —ñ–Ω—à–æ–≥–æ.</p>
                <ul>
                    <li><strong>–ö–æ–¥ –®–µ–Ω–Ω–æ–Ω–∞-–§–∞–Ω–æ:</strong> –†–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º, —â–æ –¥—ñ–ª–∏—Ç—å –Ω–∞–±—ñ—Ä —Å–∏–º–≤–æ–ª—ñ–≤ –Ω–∞ –¥–≤—ñ –≥—Ä—É–ø–∏ –∑ –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ä—ñ–≤–Ω–∏–º–∏ —Å—É–º–∞—Ä–Ω–∏–º–∏ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—è–º–∏. –ù–µ –∑–∞–≤–∂–¥–∏ –¥–∞—î –æ–ø—Ç–∏–º–∞–ª—å–Ω—ñ –∫–æ–¥–∏.</li>
                    <li><strong>–ö–æ–¥ –•–∞—Ñ—Ñ–º–∞–Ω–∞:</strong> –ë—É–¥—É—î –±—ñ–Ω–∞—Ä–Ω–µ –¥–µ—Ä–µ–≤–æ –∑–Ω–∏–∑—É –≤–≥–æ—Ä—É. <em>–ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ</em> –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π (–Ω–∞–π–∫–æ—Ä–æ—Ç—à–∏–π) –ø—Ä–µ—Ñ—ñ–∫—Å–Ω–∏–π –∫–æ–¥ –¥–ª—è –∑–∞–¥–∞–Ω–∏—Ö –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π.</li>
                </ul>
                <p><strong>–ì–æ–ª–æ–≤–Ω–µ –æ–±–º–µ–∂–µ–Ω–Ω—è:</strong> –¶—ñ –º–µ—Ç–æ–¥–∏ –∑–º—É—à–µ–Ω—ñ –ø—Ä–∏–∑–Ω–∞—á–∞—Ç–∏ *—Ü—ñ–ª—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –±—ñ—Ç* –∫–æ–∂–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É. –Ø–∫—â–æ —Å–∏–º–≤–æ–ª –º–∞—î –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å 90% (p=0.9), –π–æ–≥–æ —ñ–¥–µ–∞–ª—å–Ω–∞ "–≤–∞—Ä—Ç—ñ—Å—Ç—å" ‚Äî x 0.15 –±—ñ—Ç. –ê–ª–µ –•–∞—Ñ—Ñ–º–∞–Ω –∑–º—É—à–µ–Ω–∏–π –¥–∞—Ç–∏ –π–æ–º—É —â–æ–Ω–∞–π–º–µ–Ω—à–µ <strong>1 –±—ñ—Ç</strong>. –¶–µ ‚Äî –≥–æ–ª–æ–≤–Ω–µ –¥–∂–µ—Ä–µ–ª–æ –Ω–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —É –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—ñ –∑ –µ–Ω—Ç—Ä–æ–ø—ñ—î—é.</p>
                
                <h4>3. –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ –ö–æ–¥—É–≤–∞–Ω–Ω—è</h4>
                <p>–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è –ø—Ä–∞—Ü—é—î–Ω—Ü–∏–ø–æ–≤–æ —ñ–Ω–∞–∫—à–µ. –í–æ–Ω–æ <strong>–Ω–µ –∫–æ–¥—É—î —Å–∏–º–≤–æ–ª–∏ –æ–∫—Ä–µ–º–æ</strong>.</p>
                <p>–í–æ–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –≤—Å–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫ —î–¥–∏–Ω–µ —á–∏—Å–ª–æ (–¥—Ä—ñ–±) –≤ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ [0, 1). –ö–æ–∂–µ–Ω –Ω–æ–≤–∏–π —Å–∏–º–≤–æ–ª –∑–≤—É–∂—É—î —Ü–µ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–ø–æ—Ä—Ü—ñ–π–Ω–æ –¥–æ —Å–≤–æ—î—ó –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ. –ß–∏–º —ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å, —Ç–∏–º –±—ñ–ª—å—à–∏–π —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –≤–æ–Ω–∞ –∑–∞–π–º–∞—î.</p>
                <p><strong>–ö–ª—é—á–æ–≤–∞ –ø–µ—Ä–µ–≤–∞–≥–∞:</strong> –í–æ–Ω–æ –º–æ–∂–µ "—Ä–æ–∑–ø–æ–¥—ñ–ª—è—Ç–∏" –±—ñ—Ç–∏. –°–∏–º–≤–æ–ª –∑ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é 90% (p=0.9) –Ω–µ "–∫–æ—à—Ç—É—î" 1 –ø–æ–≤–Ω–∏–π –±—ñ—Ç. –í—ñ–Ω –ø—Ä–æ—Å—Ç–æ –∑–≤—É–∂—É—î —ñ–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞ 10%, —â–æ "–∫–æ—à—Ç—É—î" –ø—Ä–∏–±–ª–∏–∑–Ω–æ 0.15 –±—ñ—Ç —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó. –¶–µ–π –∫–æ–¥–µ—Ä –Ω–µ –æ–±–º–µ–∂–µ–Ω–∏–π —Ü—ñ–ª–∏–º–∏ –±—ñ—Ç–∞–º–∏ –Ω–∞ —Å–∏–º–≤–æ–ª —ñ —Ç–æ–º—É –º–æ–∂–µ –Ω–∞–±–ª–∏–∑–∏—Ç–∏—Å—è –¥–æ –µ–Ω—Ç—Ä–æ–ø—ñ–π–Ω–æ–≥–æ –ª—ñ–º—ñ—Ç—É –®–µ–Ω–Ω–æ–Ω–∞ –º–∞–π–∂–µ –≤–ø—Ä–∏—Ç—É–ª.</p>
                <p>–°–∞–º–µ —Ü–µ –≤–∏ –π –±–∞—á–∏—Ç–µ —É —Å–∏–º—É–ª—è—Ç–æ—Ä—ñ: —Ü—ñ–ª–æ—á–∏—Å–µ–ª—å–Ω–∏–π (Integer) –∫–æ–¥–µ—Ä —ñ–º—ñ—Ç—É—î —Ü–µ–π –ø—Ä–æ—Ü–µ—Å "–∑—É–º—É" –Ω–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ [0, 255] —ñ –≥–µ–Ω–µ—Ä—É—î –±—ñ—Ç–∏ –≤ –ø—Ä–æ—Ü–µ—Å—ñ (—Ä–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è).</p>
 <p>–¢—É—Ç ‚Äî —Ç—Ä–∏ –∫–ª—é—á–æ–≤—ñ –µ—Ç–∞–ø–∏: –ø—Ä–∏–Ω—Ü–∏–ø, —Ä–µ–Ω–æ—Ä–º—É–≤–∞–Ω–Ω—è —ñ —Ä–æ–±–æ—Ç–∞ –∑ ¬´–ø—ñ–¥–≤—ñ—à–µ–Ω–∏–º–∏¬ª –±—ñ—Ç–∞–º–∏ (E3)..</p>

  <h3>1) –ü—Ä–∏–Ω—Ü–∏–ø</h3>
  <div class="card">
    <p>–Ü–Ω—Ç–µ—Ä–≤–∞–ª <code>[0,1)</code> –¥—ñ–ª–∏—Ç—å—Å—è –º—ñ–∂ —Å–∏–º–≤–æ–ª–∞–º–∏ –ø—Ä–æ–ø–æ—Ä—Ü—ñ–π–Ω–æ —ó—Ö–Ω—ñ–º –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—è–º. –ö–æ–∂–Ω–∏–π —Å–∏–º–≤–æ–ª –∑–≤—É–∂—É—î –ø–æ—Ç–æ—á–Ω–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ –ø—ñ–¥—ñ–Ω—Ç–µ—Ä–≤–∞–ª—É ‚Äî –π —Ç–∞–∫ –ø–æ —á–µ—Ä–∑—ñ –¥–ª—è –≤—Å—ñ—î—ó –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ. –ó–∞–∫—ñ–Ω—á–∏–≤—à–∏, –±–µ—Ä–µ–º–æ –±—É–¥—å-—è–∫–µ —á–∏—Å–ª–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É ‚Äî –≤–æ–Ω–æ –π —î –∫–æ–¥–æ–º –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ.</p>
    <p class="note"> —á–∞—Å—Ç—ñ —Å–∏–º–≤–æ–ª–∏ –¥–∞—é—Ç—å —à–∏—Ä—à—ñ –ø—ñ–¥—ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ ‚Üí –ø—Ä–∏ —ó—Ö –ø–æ—è–≤—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –∑–≤—É–∂—É—î—Ç—å—Å—è —Å–ª–∞–±—à–µ ‚Üí –º–µ–Ω—à–µ –±—ñ—Ç—ñ–≤ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.</p>
  </div>

  <h3>2) –†–µ–Ω–æ—Ä–º—É–≤–∞–Ω–Ω—è (—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å)</h3>
  <div class="grid">
    <div class="card">
      <p>–Ü–Ω—Ç–µ—Ä–≤–∞–ª –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å —è–∫ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω—ñ –¥—Ä–æ–±–∏ ‚Äî —Ç—Ä–∏–º–∞—é—Ç—å —É —Ü—ñ–ª–∏—Ö —á–∏—Å–ª–∞—Ö —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó —Ä–æ–∑—Ä—è–¥–Ω–æ—Å—Ç—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 16/32/64 –±—ñ—Ç–∏). –©–æ–± –Ω–µ –≤—Ç—Ä–∞—á–∞—Ç–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å —ñ –ø–æ—Å—Ç—É–ø–æ–≤–æ –≤–∏–≤–æ–¥–∏—Ç–∏ –±—ñ—Ç–æ–≤—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å, —Ä–æ–±–ª—è—Ç—å —Ä–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é:</p>
      <ul>
        <li>–Ø–∫—â–æ <code>high &lt; 0.5</code> ‚Üí –æ–±–∏–¥–≤—ñ –º–µ–∂—ñ –≤ –Ω–∏–∂–Ω—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ ‚Üí –≤–∏–≤–æ–¥–∏–º–æ <code>0</code> —ñ –∑—Å—É–≤–∞—î–º–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –≤–ª—ñ–≤–æ (<<1).</li>
        <li>–Ø–∫—â–æ <code>low &gt;= 0.5</code> ‚Üí –æ–±–∏–¥–≤—ñ –≤ –≤–µ—Ä—Ö–Ω—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ ‚Üí –≤–∏–≤–æ–¥–∏–º–æ <code>1</code> —ñ —Ç–µ–∂ –∑—Å—É–≤–∞—î–º–æ.</li>
      </ul>
      <p>–ó—Å—É–≤ (–º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è) –¥–æ–∑–≤–æ–ª—è—î –∑–Ω–æ–≤—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—Å—é —Ä–æ–∑—Ä—è–¥–Ω—ñ—Å—Ç—å –¥–ª—è –ø–æ–¥–∞–ª—å—à–∏—Ö –∫—Ä–æ–∫—ñ–≤.</p>
    </div>
    <div class="card">
      <div class="diagram">[–¥—ñ–∞–≥—Ä–∞–º–∞: –Ω–∏–∂–Ω—è | —Å–µ—Ä–µ–¥–Ω—è | –≤–µ—Ä—Ö–Ω—è –ø–æ–ª–æ–≤–∏–Ω–∞]</div>
      <table>
        <thead><tr><th>–°–∏—Ç—É–∞—Ü—ñ—è</th><th>–î—ñ—è</th></tr></thead>
        <tbody>
          <tr><td><code>high &lt; 0.5</code></td><td>–í–∏–≤–µ—Å—Ç–∏ <code>0</code>, –∑—Å—É–Ω—É—Ç–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª</td></tr>
          <tr><td><code>low &gt;= 0.5</code></td><td>–í–∏–≤–µ—Å—Ç–∏ <code>1</code>, –∑—Å—É–Ω—É—Ç–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª</td></tr>
          <tr><td>–Ü–Ω–∞–∫—à–µ</td><td>–ß–µ–∫–∞—Ç–∏ (–º–æ–∂–ª–∏–≤–∞ E3 —Å–∏—Ç—É–∞—Ü—ñ—è ‚Äî <em>–ø—ñ–¥–≤—ñ—Å / underflow ("pending bits")</em>)</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>3) "–ü—ñ–¥–≤—ñ—à–µ–Ω—ñ" –±—ñ—Ç–∏ (E3, –ø–æ–¥—ñ–π ‚Äî "–ø—ñ–¥–≤—ñ—Å", –∞–Ω–≥–ª. <em>underflow</em> –∞–±–æ <em>pending bits</em>)</h3>
  <div class="card">
    <p>–Ø–∫—â–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –ø–µ—Ä–µ—Ç–∏–Ω–∞—î —Å–µ—Ä–µ–¥–∏–Ω—É (–º—ñ—Å—Ç–∏—Ç—å 0.5), –∞–ª–µ –Ω–µ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤ –æ–¥–Ω—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ, —Ç–æ —Å—Ç–∞—Ä—à–∏–π –±—ñ—Ç –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–∏–π ‚Üí –∫–æ–¥–µ—Ä –Ω–µ –≤–∏–≤–æ–¥–∏—Ç—å –±—ñ—Ç, –∞ —Ä–∞—Ö—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–¥–≤—ñ—Å—ñ–≤ (k). –¢–µ—Ä–º—ñ–Ω–æ–ª–æ–≥—ñ—è: –≤ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–º—É –ø–æ—Ç–æ—Ü—ñ —è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é —Å–ª–æ–≤–æ <strong>¬´–ø—ñ–¥–≤—ñ—Å¬ª</strong>; –∞–Ω–≥–ª—ñ–π—Å—å–∫–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–∫ ‚Äî <em>underflow</em> –∞–±–æ <em>pending bits</em>.</p>
    <p>–ü—Ä–∞–≤–∏–ª–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è:</p>
    <ol>
      <li>–ó–∞–ø–∏—Å—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø—ñ–¥–≤—ñ—Å—ñ–≤ (k).</li>
      <li>–ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ <code>low</code> —ñ <code>high</code> –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏.</li>
      <li>–ö–æ–ª–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞—Ä–µ—à—Ç—ñ –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ –Ω–∏–∂–Ω—é –∞–±–æ –≤–µ—Ä—Ö–Ω—é –ø–æ–ª–æ–≤–∏–Ω—É, –≤–∏–≤–æ–¥–∏–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –±—ñ—Ç (<code>0</code> –∞–±–æ <code>1</code>), –∞ –ø–æ—Ç—ñ–º <code>k</code> –±—ñ—Ç—ñ–≤ ‚Äî —ñ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–∏—Ö.</li>
    </ol>

    <h3>–ß–æ–º—É —Å–∞–º–µ —ñ–Ω–≤–µ—Ä—Å—ñ—è?</h3>
    <p>–ö–æ—Ä–æ—Ç–∫–æ: –ø—ñ–¥ —á–∞—Å –ø—ñ–¥–≤—ñ—Å—É –º–∏ –º–Ω–æ–∂–∏–ª–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞ 2 (—Ä–µ–Ω–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞–ª–∏), –∞–ª–µ —Å—Ç–∞—Ä—à–∏–π –±—ñ—Ç –ø—Ä–∏ —Ü—å–æ–º—É –±—É–≤ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–∏–π. –ö–æ–ª–∏ —Å—Ç–∞–ª–æ —è—Å–Ω–æ, —É —è–∫—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –≤–∏—è–≤–∏–≤—Å—è –æ—Å—Ç–∞—Ç–æ—á–Ω–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª, —Ü–µ–π –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π –±—ñ—Ç –ø–æ–∫–∞–∑—É—î –Ω–∞–ø—Ä—è–º, —É —è–∫–æ–º—É —Ä–∞–Ω—ñ—à–µ ¬´–ø–µ—Ä–µ–±—É–≤–∞–ª–∏¬ª –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ –±—ñ—Ç–∏ ‚Äî –∞ –≤–æ–Ω–∏ –≤–∏—è–≤–ª—è—é—Ç—å—Å—è –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–∏–º–∏ –¥–æ —Ü—å–æ–≥–æ –Ω–∞–ø—Ä—è–º–∫—É. –û—Ç–∂–µ, —ó—Ö –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –±—ñ—Ç—ñ–≤, —è–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä–µ–∞–ª—å–Ω–æ–º—É –ø–æ–ª–æ–∂–µ–Ω–Ω—é —á–∏—Å–ª–∞ –≤ –ø–æ—á–∞—Ç–∫–æ–≤–æ–º—É —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ.</p>

    <h4>–Ü–ª—é—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥</h4>
    <p>–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —Å—Ç–∞–ª–æ—Å—è <code>k = 2</code> –ø—ñ–¥–≤—ñ—Å—ñ–≤ (–¥–≤—ñ—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –ø–µ—Ä–µ—Ç–∏–Ω–∞–≤ 0.5), –∞ –ø–æ—Ç—ñ–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª –≤–∏–π—à–æ–≤ —É <strong>–Ω–∏–∂–Ω—é</strong> –ø–æ–ª–æ–≤–∏–Ω—É. –¢–æ–¥—ñ:</p>
    <pre>–≤–∏–≤–æ–¥–∏–º–æ: 0
–∞ –ø–æ—Ç—ñ–º: 1 1  (–¥–≤–∞ —ñ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω—ñ –ø—ñ–¥–≤—ñ—Å–∏)
—Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0 1 1</pre>
    <p>–Ø–∫—â–æ –± —ñ–Ω—Ç–µ—Ä–≤–∞–ª –≤–∏–π—à–æ–≤ —É –≤–µ—Ä—Ö–Ω—é –ø–æ–ª–æ–≤–∏–Ω—É, –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –±—ñ—Ç –±—É–≤ –±–∏ <code>1</code>, –∞ –ø—ñ–¥–≤—ñ—Å–∏ –¥–∞–ª–∏ –± <code>0 0</code> ‚Äî —Ç–æ–±—Ç–æ <code>1 0 0</code>.</p>

    <p class="note">–¶–µ —Ç—Ä—é–∫, —è–∫–∏–π –∑–∞–±–µ–∑–ø–µ—á—É—î –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ñ—Å—Ç—å –±—ñ—Ç–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫—É —ñ –∫–æ—Ä–µ–∫—Ç–Ω—ñ—Å—Ç—å –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è ‚Äî –±–µ–∑ –Ω—å–æ–≥–æ –¥–µ–∫–æ–¥–µ—Ä –Ω–µ –∑–º—ñ–≥ –±–∏ –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –±—ñ—Ç—ñ–≤ —É —Ç–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞ –¥–µ—è–∫–∏–π —á–∞—Å –∑–∞—Å—Ç—Ä—è–≥–∞—î –Ω–∞–≤–∫–æ–ª–æ 0.5.</p>
  </div>

  <h2>–î–æ–¥–∞—Ç–∫–æ–≤–∞ –≤–∞–∂–ª–∏–≤–∞ —Ä–µ–º–∞—Ä–∫–∞ ‚Äî –ø—Ä–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –±—ñ—Ç—ñ–≤ —É —Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ–π —Ç–æ—á–Ω–æ—Å—Ç—ñ</h2>
  <div class="card">
    <p>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –±—ñ—Ç—ñ–≤, —è–∫—É —Ç—Ä–µ–±–∞ –≤–∏–¥—ñ–ª–∏—Ç–∏ –¥–ª—è —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É –≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –∑—ñ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—é —Ç–æ—á–Ω—ñ—Å—Ç—é (–Ω–∞–ø—Ä., 32 –±—ñ—Ç–∏), <strong>–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –∞–ª—Ñ–∞–≤—ñ—Ç—É —ñ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π</strong>.</p>
    <p>–ß–æ–º—É: —à–∏—Ä–∏–Ω–∞ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É ‚âà –¥–æ–±—É—Ç–æ–∫ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π —Å–∏–º–≤–æ–ª—ñ–≤ —É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ. –Ø–∫—â–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –¥—É–∂–µ –º–∞–ª—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–µ–ª–∏–∫–µ –∞–ª—Ñ–∞–≤—ñ—Ç –∑ –±–∞–≥–∞—Ç—å–º–∞ —Ä—ñ–¥–∫—ñ—Å–Ω–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏), —Ç–æ –¥–æ–±—É—Ç–æ–∫ –º–æ–∂–µ –±—É—Ç–∏ –¥—É–∂–µ –º–∞–ª–∏–º ‚Äî —Ç–æ–±—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –±—ñ–ª—å—à–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å <code>B</code>, —â–æ–± —è–≤–Ω–æ —Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏ —Å—É—Å—ñ–¥–Ω—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏.</p>
    <p>–ü—Ä–∞–∫—Ç–∏—á–Ω–µ –ø—Ä–∞–≤–∏–ª–æ: –≤–∏–±–∏—Ä–∞—é—Ç—å —Ä–æ–∑—Ä—è–¥–Ω—ñ—Å—Ç—å —Ç–∞–∫, —â–æ–± –Ω–∞–π–±—ñ–ª—å—à –≤—ñ—Ä–æ–≥—ñ–¥–Ω—ñ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –Ω–µ –ø—Ä–∏–∑–≤–æ–¥–∏–ª–∏ –¥–æ —á–∞—Å—Ç–∏—Ö –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω—å —Ç–æ—á–Ω–æ—Å—Ç—ñ; –∞–±–æ –ø—Ä–∞—Ü—é—é—Ç—å —ñ–∑ –∞–¥–∞–ø—Ç–∏–≤–Ω–∏–º–∏ –º–æ–¥–µ–ª—å–Ω–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏ (—Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è –∞–ª—Ñ–∞–≤—ñ—Ç—É, —Å–∫–µ–π–ª–∏ —á–∞—Å—Ç–æ—Ç, escape-–∫–æ–¥–∏ —Ç–æ—â–æ).</p>
  </div>

            </div>
        </details>
    </section>

    <script>
        const colors = ['#ffa500', '#90ee90', '#da70d6', '#00bcd4', '#ff6b6b', '#f06292', '#ba68c8'];

        const PRECISION = 8n;
        const MAX_VALUE = (1n << PRECISION) - 1n; // 255n
        const HALF = (1n << (PRECISION - 1n));      // 128n
        const QUARTER = (1n << (PRECISION - 2n));   // 64n
        const THREE_QUARTER = 3n * QUARTER;       // 192n

        let lastModel = null;

        function log2(val) {
            return Math.log(val) / Math.LN2;
        }

        function getPrecision(range) {
            if (range < 1e-15 || range === 0) return 16;
            const orderOfMag = Math.floor(Math.log10(Math.abs(range)));
            const precision = Math.max(6, Math.abs(orderOfMag) + 3);
            return precision;
        }


        function buildModel(message) {
            const messageArray = message.split('');
            const counts = {};
            
            for (const sym of messageArray) {
                counts[sym] = (counts[sym] || 0) + 1;
            }

            const symbols = Object.keys(counts).sort();
            const total = messageArray.length;
            const probs = symbols.map(sym => counts[sym] / total);

            const cumul = [0];
            for (let p of probs) {
                cumul.push(cumul[cumul.length - 1] + p);
            }
            
            return { symbols, probs, cumul, counts, total };
        }

        function createZoomedBar(currentLow, currentHigh, symbols, cumul, chosenIdx, precision = 6) {
            const barContainer = document.createElement('div');
            
            const barDiv = document.createElement('div');
            barDiv.className = 'bar';
            
            const tickContainer = document.createElement('div');
            tickContainer.className = 'tick-container';

            const range = currentHigh - currentLow;

            addTick(tickContainer, 0, currentLow.toFixed(precision));

            for (let i = 0; i < symbols.length; i++) {
                const segWidth = (cumul[i+1] - cumul[i]) * 100;
                const seg = document.createElement('div');
                seg.className = 'segment';
                seg.style.width = segWidth + '%';
                seg.style.backgroundColor = colors[i % colors.length];
                seg.innerText = symbols[i];

                if (i === chosenIdx) {
                    seg.classList.add('chosen');
                }
                barDiv.appendChild(seg);

                const segHighVal = currentLow + range * cumul[i+1];
                addTick(tickContainer, (cumul[i+1]) * 100, segHighVal.toFixed(precision));
            }
            
            barContainer.appendChild(barDiv);
            barContainer.appendChild(tickContainer);
            return barContainer;
        }

        function createZoomLines(startPercent, endPercent) {
            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, "svg");
            svg.setAttribute('class', 'zoom-lines');
            svg.setAttribute('viewBox', '0 0 100 40');
            svg.setAttribute('preserveAspectRatio', 'none');

            const line1 = document.createElementNS(svgNS, "line");
            line1.setAttribute('x1', startPercent * 100);
            line1.setAttribute('y1', 0);
            line1.setAttribute('x2', 0);
            line1.setAttribute('y2', 40);
            svg.appendChild(line1);

            const line2 = document.createElementNS(svgNS, "line");
            line2.setAttribute('x1', endPercent * 100);
            line2.setAttribute('y1', 0);
            line2.setAttribute('x2', 100);
            line2.setAttribute('y2', 40);
            svg.appendChild(line2);
            
            return svg;
        }

        function addTick(container, percentLeft, label) {
            const tick = document.createElement('div');
            tick.className = 'tick';
            tick.style.left = percentLeft + '%';
            
            const num = document.createElement('div');
            num.className = 'number';
            num.style.left = percentLeft + '%';
            num.innerText = label;

            container.appendChild(tick);
            container.appendChild(num);
        }

        async function runEncoding() {
            const messageStr = document.getElementById('message').value;
            if (messageStr.length === 0) {
                alert("–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º.");
                return;
            }
            
            const message = messageStr.split('');
            const model = buildModel(messageStr);
            lastModel = model;
            const { symbols, probs, cumul, counts, total } = model;

            const stepsDiv = document.getElementById('encoding-steps');
            stepsDiv.innerHTML = '<h2>–ü–æ–∫—Ä–æ–∫–æ–≤–µ –ö–æ–¥—É–≤–∞–Ω–Ω—è</h2>';
            document.getElementById('summary-section').innerHTML = '';

            let fpLow = 0.0;
            let fpHigh = 1.0;
            let intLow = 0n;
            let intHigh = MAX_VALUE;
            let pendingBits = 0n;
            let outputStream = "";
            let stepNum = 0;
            let currentPrecision = 3; // –ü–æ—á–∞—Ç–∫–æ–≤–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –¥–ª—è [0, 1]

            // –ö—Ä–æ–∫ 0
            const step0Container = document.createElement('div');
            step0Container.className = 'step-container';

            const fp0Div = document.createElement('div');
            fp0Div.className = 'fp-visual';
            
            let modelExpl = `<b>–ö—Ä–æ–∫ 0: –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω —Ç–∞ –ú–æ–¥–µ–ª—å</b><br>–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: "${messageStr}" (–î–æ–≤–∂–∏–Ω–∞: ${total}).<br>–†–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å:<br><ul>`;
            for (let i = 0; i < symbols.length; i++) {
                modelExpl += `<li>–°–∏–º–≤–æ–ª <b>'${symbols[i]}'</b>: ${counts[symbols[i]]}/${total} (–ô–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å: ${probs[i].toFixed(4)})</li>`;
            }
            modelExpl += `</ul>`;
            const expl0 = document.createElement('p');
            expl0.className = 'explanation';
            expl0.innerHTML = modelExpl;
            fp0Div.appendChild(expl0);

            // *** –ó–ú–Ü–ù–ï–ù–û: –õ–æ–≥—ñ–∫–∞ "–ü–æ–≥–ª—è–¥—É –Ω–∞–ø–µ—Ä–µ–¥" ***
            // –ö—Ä–æ–∫ 0 –º–∞–ª—é—î Bar_0, –∞–ª–µ –í–ò–î–Ü–õ–Ø–Ñ –ø–µ—Ä—à–∏–π —Å–∏–º–≤–æ–ª (message[0])
            const idx_0 = symbols.indexOf(message[0]);
            fp0Div.appendChild(createZoomedBar(fpLow, fpHigh, symbols, cumul, idx_0, currentPrecision));
            step0Container.appendChild(fp0Div);
            
            const details0 = document.createElement('details');
            details0.className = 'int-spoiler';
            const summary0 = document.createElement('summary');
            summary0.innerText = '–ü–æ–∫–∞–∑–∞—Ç–∏ —Å—Ç–∞–Ω INT –ö–æ–¥–µ—Ä–∞ (–ö—Ä–æ–∫ 0)';
            details0.appendChild(summary0);
            const int0Div = document.createElement('div');
            int0Div.className = 'int-visual';
            int0Div.innerHTML = `<h4>–°—Ç–∞–Ω INT –ö–æ–¥–µ—Ä–∞</h4>
                                 <code>low: ${intLow.toString(10)}</code>
                                 <code>high: ${intHigh.toString(10)}</code>
                                 <code>pending: ${pendingBits}</code><hr>
                                 <code>–í–∏—Ö—ñ–¥–Ω–∏–π –ø–æ—Ç—ñ–∫: (–Ω–µ–º–∞—î)</code>`;
            details0.appendChild(int0Div);
            step0Container.appendChild(details0);
            stepsDiv.appendChild(step0Container);


            for (let i = 0; i < message.length; i++) {
                stepNum++;
                const sym = message[i];
                const idx = symbols.indexOf(sym);
                
                const fpRange = fpHigh - fpLow;
                const fpNewLow = fpLow + fpRange * cumul[idx];
                const fpNewHigh = fpLow + fpRange * cumul[idx+1];
                const newPrecision = getPrecision(fpNewHigh - fpNewLow);
                
                // --- INT –õ–æ–≥—ñ–∫–∞ ---
                let intExpl = `<b>INT:</b> –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥—ñ–∞–ø–∞–∑–æ–Ω—É –¥–ª—è '${sym}':<br>`;
                const intRange = intHigh - intLow + 1n;
                const symCumLow = BigInt(Math.round(cumul[idx] * Number(intRange)));
                const symCumHigh = BigInt(Math.round(cumul[idx+1] * Number(intRange)));
                const intNewLow = intLow + symCumLow;
                const intNewHigh = intLow + symCumHigh - 1n;
                intExpl += `<code>  range = ${intHigh} - ${intLow} + 1 = ${intRange}</code>
                            <code>  new_low = ${intLow} + round(${cumul[idx].toFixed(4)} * ${intRange}) = ${intNewLow.toString(10)}</code>
                            <code>  new_high = ${intLow} + round(${cumul[idx+1].toFixed(4)} * ${intRange}) - 1 = ${intNewHigh.toString(10)}</code>`;
                
                intLow = intNewLow;
                intHigh = intNewHigh;
                let bitsOutputThisStep = "";
                intExpl += `<br><b>INT: –ü–µ—Ä–µ–Ω–æ—Ä–º—É–≤–∞–Ω–Ω—è (Renormalization):</b><br>`;
                while (true) {
                    if (intHigh < HALF) {
                        bitsOutputThisStep += '0';
                        for (let j = 0n; j < pendingBits; j++) bitsOutputThisStep += '1';
                        pendingBits = 0n;
                        intExpl += `<code>  [L,H] < ${HALF} (–Ω–∏–∂–Ω—è –ø–æ–ª.). –í–∏–≤—ñ–¥ '0'${pendingBits > 0 ? '(+ ' + pendingBits + ' "1")' : ''}.</code>`;
                        intLow = intLow * 2n;
                        intHigh = intHigh * 2n + 1n;
                    } 
                    else if (intLow >= HALF) {
                        bitsOutputThisStep += '1';
                        for (let j = 0n; j < pendingBits; j++) bitsOutputThisStep += '0';
                        pendingBits = 0n;
                        intExpl += `<code>  [L,H] >= ${HALF} (–≤–µ—Ä—Ö–Ω—è –ø–æ–ª.). –í–∏–≤—ñ–¥ '1'${pendingBits > 0 ? '(+ ' + pendingBits + ' "0")' : ''}.</code>`;
                        intLow = (intLow - HALF) * 2n;
                        intHigh = (intHigh - HALF) * 2n + 1n;
                    } 
                    else if (intLow >= QUARTER && intHigh < THREE_QUARTER) {
                        pendingBits++;
                        intExpl += `<code>  [L,H] –≤ –∑–æ–Ω—ñ [${QUARTER}, ${THREE_QUARTER}). pending_bits = ${pendingBits}.</code>`;
                        intLow = (intLow - QUARTER) * 2n;
                        intHigh = (intHigh - QUARTER) * 2n + 1n;
                    } 
                    else {
                        intExpl += `<code>  –Ü–Ω—Ç–µ—Ä–≤–∞–ª —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π. –í–∏—Ö—ñ–¥.</code>`;
                        break;
                    }
                    intExpl += `<code>    -> new [L,H]: [${intLow.toString(10)}, ${intHigh.toString(10)}]</code>`;
                }
                outputStream += bitsOutputThisStep;
                // --- –ö—ñ–Ω–µ—Ü—å INT –õ–æ–≥—ñ–∫–∏ ---

                const stepContainer = document.createElement('div');
                stepContainer.className = 'step-container';

                const fpDiv = document.createElement('div');
                fpDiv.className = 'fp-visual';
                
                // *** –ó–ú–Ü–ù–ï–ù–û: –õ–æ–≥—ñ–∫–∞ "–ü–æ–≥–ª—è–¥—É –Ω–∞–ø–µ—Ä–µ–¥" ***
                // –í–∏–∑–Ω–∞—á–∞—î–º–æ, —è–∫–∏–π —Å–∏–º–≤–æ–ª –±—É–¥–µ –ù–ê–°–¢–£–ü–ù–ò–ú, —â–æ–± –≤–∏–¥—ñ–ª–∏—Ç–∏ –π–æ–≥–æ
                const next_idx = (i + 1 < message.length) ? symbols.indexOf(message[i+1]) : -1;
                
                // 1. –ú–∞–ª—é—î–º–æ –ª—ñ–Ω—ñ—ó –∑—É–º—É (–≤–æ–Ω–∏ –π–¥—É—Ç—å –≤—ñ–¥ 'idx' - *–ø–æ—Ç–æ—á–Ω–æ–≥–æ* —Å–∏–º–≤–æ–ª—É)
                fpDiv.appendChild(createZoomLines(cumul[idx], cumul[idx+1]));
                
                // 2. –ú–∞–ª—é—î–º–æ –ù–û–í–ò–ô –±–∞—Ä (—Ä–µ–∑—É–ª—å—Ç–∞—Ç 'idx'), –∞–ª–µ –í–ò–î–Ü–õ–Ø–Ñ–ú–û 'next_idx'
                fpDiv.appendChild(createZoomedBar(fpNewLow, fpNewHigh, symbols, cumul, next_idx, newPrecision));
                
                stepContainer.appendChild(fpDiv);
                
                const detailsN = document.createElement('details');
                detailsN.className = 'int-spoiler';
                const summaryN = document.createElement('summary');
                summaryN.innerHTML = `–ö—Ä–æ–∫ ${stepNum}: –ö–æ–¥—É–≤–∞–Ω–Ω—è '<b>${sym}</b>' (INT-—Å—Ç–∞–Ω)`;
                detailsN.appendChild(summaryN);
                const intDiv = document.createElement('div');
                intDiv.className = 'int-visual';
                intDiv.innerHTML = `<h4>–°—Ç–∞–Ω INT –ö–æ–¥–µ—Ä–∞</h4>
                                    ${intExpl}
                                    <hr>
                                    <code>low: ${intLow.toString(10)}</code>
                                    <code>high: ${intHigh.toString(10)}</code>
                                    <code>pending: ${pendingBits}</code>
                                    <hr>
                                    <div class="stream">
                                        <code>–ë—ñ—Ç–∏ –Ω–∞ —Ü—å–æ–º—É –∫—Ä–æ—Ü—ñ: <span class="bit-output">${bitsOutputThisStep || '(–Ω–µ–º–∞—î)'}</span></code>
                                        <code>–í–µ—Å—å –ø–æ—Ç—ñ–∫: ${outputStream}</code>
                                    </div>`;
                detailsN.appendChild(intDiv);
                stepContainer.appendChild(detailsN);

                stepsDiv.appendChild(stepContainer); 

                fpLow = fpNewLow;
                fpHigh = fpNewHigh;
                currentPrecision = newPrecision; // –û–Ω–æ–≤–ª—é—î–º–æ —Ç–æ—á–Ω—ñ—Å—Ç—å –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫—Ä–æ–∫—É
            }

            // --- 5. –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è (Flush) - –°–•–û–í–ê–ù–û –ü–Ü–î –°–ü–û–ô–õ–ï–† ---
            const finalDiv = document.createElement('div');
            const detailsFlush = document.createElement('details');
            detailsFlush.className = 'step-container'; // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç–æ–π —Å–∞–º–∏–π —Å—Ç–∏–ª—å
            detailsFlush.style.borderTop = '1px dashed #ccc';
            detailsFlush.style.paddingTop = '20px';

            const summaryFlush = document.createElement('summary');
            summaryFlush.innerHTML = `<h3 style="display:inline-block; border:none; padding:0; margin: 0;">–ö—Ä–æ–∫ ${stepNum+1}: –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è (Flush) (–¢–µ—Ö–Ω—ñ—á–Ω–∏–π –∫—Ä–æ–∫)</h3>`;
            detailsFlush.appendChild(summaryFlush);
            
            pendingBits++;
            let flushBits = "";
            if (intLow < QUARTER) {
                flushBits += '0';
                for (let i = 0n; i < pendingBits; i++) flushBits += '1';
            } else {
                flushBits += '1';
                for (let i = 0n; i < pendingBits; i++) flushBits += '0';
            }
            outputStream += flushBits;

            const intFlushDiv = document.createElement('div');
            intFlushDiv.className = 'int-visual';
            intFlushDiv.style.marginTop = '10px';
            intFlushDiv.innerHTML = `<h4>–§—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ—Ç–æ–∫—É</h4>
                                     <p>–ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –¶–µ–π –∫—Ä–æ–∫ –≤–∏–≤–æ–¥–∏—Ç—å –∑–∞–ª–∏—à–∫–æ–≤—ñ –±—ñ—Ç–∏ (<code>pending_bits</code>) —Ç–∞ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π –±—ñ—Ç, —â–æ–± –≥–∞—Ä–∞–Ω—Ç—É–≤–∞—Ç–∏, —â–æ –¥–µ–∫–æ–¥–µ—Ä –æ—Ç—Ä–∏–º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –∫–æ–¥, —â–æ –ª–µ–∂–∏—Ç—å —É —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ [${intLow.toString(10)}, ${intHigh.toString(10)}].</p>
                                     <code>–§—ñ–Ω–∞–ª—å–Ω—ñ –±—ñ—Ç–∏: <span class="bit-output">${flushBits}</span></code>
                                     <code><b>–§—ñ–Ω–∞–ª—å–Ω–∏–π –±—ñ—Ç–æ–≤–∏–π –ø–æ—Ç—ñ–∫: ${outputStream}</b></code>
                                     <code><b>–î–æ–≤–∂–∏–Ω–∞: ${outputStream.length} –±—ñ—Ç</b></code>`;
            detailsFlush.appendChild(intFlushDiv);
            finalDiv.appendChild(detailsFlush);
            stepsDiv.appendChild(finalDiv);

            updateSummary(message, outputStream, model);
        }

        function updateSummary(message, outputStream, inputs) {
            const { symbols, probs } = inputs;
            const msgLength = message.length;
            if (msgLength === 0) return;

            let entropy = 0;
            for (let i=0; i < symbols.length; i++) {
                if (probs[i] > 0) {
                    entropy -= probs[i] * log2(probs[i]);
                }
            }
            
            const theoreticalLength = entropy * msgLength;
            const fixedBitsPerSym = Math.ceil(log2(symbols.length));
            const fixedLength = fixedBitsPerSym * msgLength;
            const arithLength = outputStream.length;

            const summaryDiv = document.getElementById('summary-section');
            summaryDiv.innerHTML = `
                <h2>üìä –§—ñ–Ω–∞–ª—å–Ω–µ –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ (–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: "${message.join('')}")</h2>
                <p>–¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ —ñ–¥–µ–∞–ª—å–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–æ–¥—É–≤–∞–Ω–Ω—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ (–±–ª–∏–∑—å–∫–∞ –¥–æ 100%).</p>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>–ú–µ—Ç–æ–¥ –ö–æ–¥—É–≤–∞–Ω–Ω—è</th>
                            <th>–í—Å—å–æ–≥–æ –ë—ñ—Ç</th>
                            <th>–°–µ—Ä–µ–¥–Ω—î –ë—ñ—Ç/–°–∏–º–≤–æ–ª</th>
                            <th>–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å (–≤—ñ–¥–Ω–æ—Å–Ω–æ –µ–Ω—Ç—Ä–æ–ø—ñ—ó)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>–§—ñ–∫—Å–æ–≤–∞–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞</strong> </td>
                            <td>${fixedLength}</td>
                            <td>${fixedBitsPerSym.toFixed(2)}</td>
                            <td>${(theoreticalLength / fixedLength * 100).toFixed(2)}%</td>
                        </tr>
                        <tr>
                            <td><strong>–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –ª—ñ–º—ñ—Ç (–ï–Ω—Ç—Ä–æ–ø—ñ—è H)</strong></td>
                            <td>${theoreticalLength.toFixed(4)}</td>
                            <td>${entropy.toFixed(4)}</td>
                            <td>100%</td>
                        </tr>
                        <tr class="arithmetic-row">
                            <td><strong>–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ –ö–æ–¥—É–≤–∞–Ω–Ω—è (–†–µ–∑—É–ª—å—Ç–∞—Ç)</strong></td>
                            <td><strong>${arithLength}</strong></td>
                            <td><strong>${(arithLength / msgLength).toFixed(4)}</strong></td>
                            <td><strong>${(theoreticalLength / arithLength * 100).toFixed(2)}%</strong></td>
                        </tr>
                    </tbody>
                </table>
            `;
        }


        function runDecoding() {
            if (!lastModel) {
                alert("–ü–æ–º–∏–ª–∫–∞: –ú–æ–¥–µ–ª—å –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. –ë—É–¥—å –ª–∞—Å–∫–∞, —Å–ø–æ—á–∞—Ç–∫—É –∑–∞–ø—É—Å—Ç—ñ—Ç—å '–ö–æ–¥—É–≤–∞–Ω–Ω—è', —â–æ–± –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –º–æ–¥–µ–ª—å.");
                return;
            }

            const { symbols, cumul } = lastModel;
            let code = parseFloat(document.getElementById('code').value);
            const maxLength = parseInt(document.getElementById('decode-length').value);
            
            if (isNaN(code) || code < 0 || code >= 1) {
                alert('–ö–æ–¥ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ —á–∏—Å–ª–æ–º –º—ñ–∂ 0 —ñ 1.');
                return;
            }
            if (isNaN(maxLength) || maxLength <= 0) {
                alert('–î–æ–≤–∂–∏–Ω–∞ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –¥–æ–¥–∞—Ç–Ω–∏–º —á–∏—Å–ª–æ–º.');
                return;
            }
            
            const stepsDiv = document.getElementById('decoding-steps');
            stepsDiv.innerHTML = '<h2>–ü–æ–∫—Ä–æ–∫–æ–≤–µ –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è</h2>';

            let decodedSymbols = [];
            let low = 0.0;
            let high = 1.0;
            let stepNum = 0;

            const initialExpl = document.createElement('p');
            initialExpl.className = 'explanation';
            initialExpl.innerText = `–ü–æ—á–∞—Ç–æ–∫ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –∑ –∫–æ–¥–æ–º ${code}. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –º–æ–¥–µ–ª—å, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –∫–æ–¥—É–≤–∞–Ω–Ω—ñ. –ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–µ–∫–æ–¥—É–≤–∞—Ç–∏ ${maxLength} —Å–∏–º–≤–æ–ª—ñ–≤.`;
            stepsDiv.appendChild(initialExpl);
            
            // *** –ó–ú–Ü–ù–ï–ù–û: –õ–æ–≥—ñ–∫–∞ "–ü–æ–≥–ª—è–¥—É –Ω–∞–ø–µ—Ä–µ–¥" –¥–ª—è –î–µ–∫–æ–¥–µ—Ä–∞ ***
            // –ù–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ –ü–ï–†–®–ò–ô —Å–∏–º–≤–æ–ª, —â–æ–± –≤–∏–¥—ñ–ª–∏—Ç–∏ –π–æ–≥–æ –Ω–∞ –ö—Ä–æ—Ü—ñ 0
            
            let range_0 = high - low;
            let scaledCode_0 = (code - low) / range_0;
            let idx_0 = 0;
            while (idx_0 < cumul.length - 2 && scaledCode_0 >= cumul[idx_0 + 1]) {
                idx_0++;
            }

            // *** –ö—Ä–æ–∫ 0 (–î–µ–∫–æ–¥–µ—Ä) ***
            const step0Heading = document.createElement('h3');
            step0Heading.className = 'step-heading';
            step0Heading.innerText = '–ö—Ä–æ–∫ 0: –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª';
            stepsDiv.appendChild(step0Heading);
            // –ú–∞–ª—é—î–º–æ Bar_0 –∑ –≤–∏–¥—ñ–ª–µ–Ω–∏–º –ü–ï–†–®–ò–ú –∑–Ω–∞–π–¥–µ–Ω–∏–º —Å–∏–º–≤–æ–ª–æ–º (idx_0)
            stepsDiv.appendChild(createZoomedBar(low, high, symbols, cumul, idx_0, 1)); 

            while (decodedSymbols.length < maxLength) {
                stepNum++;
                const range = high - low;
                const scaledCode = (code - low) / range;
                
                let idx = 0;
                while (idx < cumul.length - 2 && scaledCode >= cumul[idx + 1]) {
                    idx++;
                }
                const sym = symbols[idx];
                decodedSymbols.push(sym);

                const newLow = low + range * cumul[idx];
                const newHigh = low + range * cumul[idx + 1];

                const newPrecision = getPrecision(newHigh - newLow);

                const stepHeading = document.createElement('h3');
                stepHeading.className = 'step-heading';
                stepHeading.innerHTML = `–ö—Ä–æ–∫ ${stepNum}: –î–µ–∫–æ–¥–æ–≤–∞–Ω–æ —Å–∏–º–≤–æ–ª <b>'${sym}'</b> (–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: <code>${decodedSymbols.join('')}</code>)`;
                stepsDiv.appendChild(stepHeading);

                // *** –ó–ú–Ü–ù–ï–ù–û: –õ–æ–≥—ñ–∫–∞ "–ü–æ–≥–ª—è–¥—É –Ω–∞–ø–µ—Ä–µ–¥" ***
                // 1. –ú–∞–ª—é—î–º–æ –ª—ñ–Ω—ñ—ó –∑—É–º—É (–≤—ñ–¥ 'idx' - *–ø–æ—Ç–æ—á–Ω–æ–≥–æ* —Å–∏–º–≤–æ–ª—É)
                stepsDiv.appendChild(createZoomLines(cumul[idx], cumul[idx+1]));
                
                // 2. –í–∏–∑–Ω–∞—á–∞—î–º–æ, —è–∫–∏–π —Å–∏–º–≤–æ–ª –±—É–¥–µ –ù–ê–°–¢–£–ü–ù–ò–ú
                let next_idx = -1;
                if (decodedSymbols.length < maxLength) { // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –Ω–µ –æ—Å—Ç–∞–Ω–Ω—ñ–π —Å–∏–º–≤–æ–ª
                    const newRange = newHigh - newLow;
                    const newScaledCode = (code - newLow) / newRange;
                    next_idx = 0;
                    while (next_idx < cumul.length - 2 && newScaledCode >= cumul[next_idx + 1]) {
                        next_idx++;
                    }
                }
                
                // 3. –ú–∞–ª—é—î–º–æ –ù–û–í–ò–ô –±–∞—Ä –∑ –≤–∏–¥—ñ–ª–µ–Ω–∏–º 'next_idx'
                stepsDiv.appendChild(createZoomedBar(newLow, newHigh, symbols, cumul, next_idx, newPrecision));

                low = newLow;
                high = newHigh;
                
                if ((high - low) < 1e-15) {
                    const errorExpl = document.createElement('p');
                    errorExpl.style.color = 'red';
                    errorExpl.innerText = "–í—Ç—Ä–∞—Ç–∞ —Ç–æ—á–Ω–æ—Å—Ç—ñ! –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –∞–≤–∞—Ä—ñ–π–Ω–æ –∑—É–ø–∏–Ω–µ–Ω–æ.";
                    stepsDiv.appendChild(errorExpl);
                    break;
                }
            }

            const finalExpl = document.createElement('p');
            finalExpl.className = 'explanation';
            finalExpl.style.backgroundColor = '#dff0d8';
            finalExpl.style.borderColor = '#3c763d';
            finalExpl.innerText = `–î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –†–µ–∑—É–ª—å—Ç–∞—Ç: ${decodedSymbols.join('')}`;
            stepsDiv.appendChild(finalExpl);
        }

    </script>
</body>
</html>